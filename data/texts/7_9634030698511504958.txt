Improving the Realism of Agent Movement for High Density Crowd Simulation
Nuria Pelechano, Norman I. Badler Center for Human Modeling and Simulation, University of Pennsylvania

Figure 1: From left to right: Waiting and emergent queuing behavior, avoiding fallen agents, natural lane formation, and impatient agents avoiding bottlenecks. Videos can be found at: http://www.seas.upenn.edu/~npelecha/MACES/MACES.htm

1. Introduction
Simulating realistic, large, dense crowds of autonomous agents is still a challenge for the computer graphics community. Typical approaches either look like particle simulations (where agents `vibrate' back and forth) or are conservative in the range of human motion possible (agents aren't allowed to `push' each other). Our HiDAC system (for High Density Autonomous Crowds) focuses on the problem of simulating the local motion and global wayfinding behaviors of crowds moving in a natural manner within dynamically changing virtual environments. HiDAC applies a combination of psychological and geometrical rules layered on top of and extending a social forces model. HiDAC exhibits a wide variety of emergent behaviors from agent line formation to pushing behavior and its consequences, based on the current situation, personalities of the individuals and perceived density of the crowd.
In terms of defining the motion of each agent, there are three main approaches: social forces systems, rule based models and cellular automata models. Much effort has been put into improving the behavioral realism of each of these approaches; none of the current models, however, can realistically animate high density crowds. Social forces models [Hel00] tend to give simulations that look closer to particle animation than human movement. Cellular automata [KNN*03] are very limited in the movement of the agents, and tend to look like a checkerboard when the density is high. Finally, rule based [Rey87] models either do not consider collision detection and repulsion at all or adopt very conservative approaches through the use of waiting rules [ST05], which work fine for low densities in everyday life simulation, but lack realism for high density or panic situations.
Our system focuses on the problem of simulating highdensity crowds of autonomous agents moving in a natural manner in dynamically changing virtual environments. We

present a solution to the problem of realistically simulating local motion under different situations and agent personalities. Agents are given different psychological traits (e.g., impatience, panic) and physiological attributes (e.g., speed) that trigger heterogeneous behaviors based on crowd density and personality.
Each agent is endowed with perception and reaction to static and dynamic objects and agents within the current space. Realistic movement is achieved both in terms of collision avoidance and collision response. Over longer distances tangential forces gently steer the agent around obstacles, while over shorter distances repulsion forces are applied to enable collision response. Pushing behavior is achieved by varying the long/short distance threshold of each individual. Agents in a hurry will not respect others' personal space and will appear to push their way through the crowd. In contrast, more `polite' agents will respect lines and wait for others to move first.
Each agent scans a frontal ellipse-shaped region. Relaxed agents temporarily stop when another agent moves into their path, while impatient agents do not respond to this feedback and tend to `push'. Our model stops impatient agents from appearing to `vibrate' as they try to force their way through dense crowds, as we add temporal braking forces to the social forces model. These forces only apply when repulsion forces from nearby agents fall within a specified range of angles opposing forward motion. This method succeeds in reducing shaking behavior, while still allowing body contact and therefore pushing behavior. Since braking forces do not apply when agents are pushed forwards, this achieves the desired result of people appearing to be pushed through doorways when there is a high-density crowd behind them.
Figure 2 shows a taxonomy for crowd simulation and compares our model (HiDAC: High Density Autonomous Crowds) with the main models in the literature along the dimensions of animation realism and crowd density.

2

Figure 2: Current models framework and our approach for low level motion (HiDAC)
In this work we focus on improving the low-level motion of agents in high-density crowds. Our agents' high-level behavior, which includes navigation in complex virtual environments, learning, communicating and decisionmaking, is described in detail in [PB06]. An introduction on how the high-level behavior can be affected by psychological elements appears in [POS*05].
2. Contributions
In this work we have introduced methods to achieve the following goals:
· Fast perception of environment by using look-ahead rectangles and prioritized obstacles based on distances, angles and directions of movement.
· Eliminate shaking behavior by applying braking forces to the social forces model.
· Natural bi-directional flow and overtaking by having variable length look-ahead rectangles and `right preferences'. Avoidance forces for these behaviors are affected by distance to other agents, angle between directions of movement and density of the crowd.
· Emergent queuing behavior by having influence discs triggering waiting behavior based on agent direction. These combined with weights applied to avoidance forces lead to different queue widths.
· Realistic pushing behavior by applying collision response based on variable `personal space'. Repulsion forces apply when an agent intersects another agent's personal space, therefore agents having smaller pushing thresholds can overlap another agent's personal space and push others away while not being pushed itself.
· Falling agents becoming new obstacles by applying tangential forces for obstacle avoidance but not repulsion. This yields to other agents being able to walk around in low and medium densities, but possibly having to walk over fallen agents when being pushed within high densities.
· Panic propagation by modifying agent behavior based on personality and perception of other agents' level of panic.
· Crowd impatience by dynamically modifying route selection based on environmental changes and agent's knowledge about the internal connectivity of the building.

3. Conclusions
HiDAC can be tuned to simulate different types of crowds, ranging from extreme panic situations (fire evacuation) to high-density crowds under calm conditions (leaving a cinema after a movie). Also we allow for heterogeneous crowds where a number of different behaviors can be exhibited simultaneously.
Unlike cellular automata and rule-based models, our system can realistically simulate an individual trying to force its way through a crowd by pushing others, and unlike social forces models, our agents can exhibit more respectful behavior when desired and take decisions in terms of letting others walk first and waiting in line. These emergent behaviors are driven by the combination of psychological and sociological rules that we layer on top of our extended social forces model.
A fast perception method has also been implemented that allows for realistic obstacle avoidance and emergent bidirectional flow rates, with natural lane formation and overtaking. Impatience has been integrated in the high level module in order to avoid the sheep-like behavior that many crowd simulation models exhibit. We have shown novel extensions to the social forces model by adding braking forces and influence region controls that mitigate agent vibration. Our system uses the best features of both rulebased and social forces systems, while eliminating their disadvantages. The implementation allows real-time simulations for many hundreds of agents. The next steps include improving the agent model visualization and applying the system to real buildings and situations.
References
[Hel00] HELBING D., FARKAS I., VICSEK T.: Simulating dynamical features of escape panic. Nature 407, 2000, pp. 487-490.
[KNN*03] KIRCHNER A., NAMAZI A., NISHINARI K., SCHADSCHNEIDER A.: Role of Conflicts in the Floor Field Cellular Automaton Model for Pedestrian Dynamics. Pedestrians and Evacuation Dynamics. 2nd Int. Conf. E.R.Galea Editor. pp. 51-62. 2003
[PB06] PELECHANO N., BADLER N.: Modeling Crowd Communication and Trained Leaders During Maze-like Building Evacuation. To appear in IEEE Computer Graphics and Applications. 2006.
[POS*05] PELECHANO N., O'BRIEN K., SILVERMAN B., BADLER N.: Crowd simulation incorporating agent psychological models, roles and communication. First Int. Workshop on Crowd Simulation, 2005, pp 21-30.
[Rey87] REYNOLDS C.: Flocks, herds, and schools: A distributed behavior model. Proc. ACM SIGGRAPH, 1987, pp. 25-34.
[ST05] SHAO W., TERZOPOULOS D.: Autonomous pedestrians. Proc. ACM SIGGRAPH / Eurographics Symposium on Computer Animation, pp. 19­28, 2005.

