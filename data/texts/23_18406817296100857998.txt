Proc. Univ. of Houston Lattice Theory Conf..Houston, 1973
The Valuation Ring of a Distributive Lattice
by
Gian-Carlo Rota Massachusetts Institute of Technology
Contents
1. Introduction 2. The Valuation ring 3. Canonical idempotents 4. Representation 5. Homology 6. Propositional Calculus 7. Averaging Operators 8. Quantifiers 9. Logic and probability 10. Acknowledgements
574

1. Introduction Traditionally, the algebraic properties of Boolean
algebras are reduced to those of Boolean rings by a wellknown construction. A Boolean ring, however, has the double disadvantage of having torsion, and of not being applicable to the richer domain of distributive lattices. In this paper we describe another construction, or functor, called the valuation ring, which associates to every distributive lattice L a torsionless ring V(L) generated by idempotents. The lattice L can be recovered by giving a suitable order structure to the valuation ring V(L), and thus the entire theory of distributive lattices is reduced to that of a simple class of rings. For example, the representation theory of distributive lattices is subsumed to that of valuation rings, where standard methods of commutative algebra apply.
The applications and further development of the present techniques lie in at least three directions.
First, the valuation ring turns out to be a very simple way of functorially associating a ring to a simplicial complex; we surmise that simplicial homology will benefit from this association.
575

Second, the theory of pseudo-Boolean functions and programming of Hammer and Rudeanu can be seen to be an informal use of valuation rings; this theory can gain from the rigorous foundation provided by the present ideas.
Third, the notion of quantifier on a Boolean algebra can be transferred to the valuation ring, where it becomes a linear averaging operator; in this way, problems in firstorder logic can be translated into problems about commuting sets of averaging operators on commutative rings. The resulting linearization of logic is probably the most promising outcome of the present investigations.
The method of presentation is deliberately informal and discursive. Some of the proofs are barely sketched; we hope to give a thorough presentation elsewhere.
576

2. The Valuation Ring. The theory of distributive lattices is richer than the better known theory of Boolean algebras; nevertheless it has had an abnormal development, for a variety of reasons of which we shall recall two. First, Stone's representation theorem of 1936 for distributive lattices closely imitated his representation theorem for Boolean algebras, and as a consequence turned out to be too contrived (I have yet to find a person who can state the entire theorem from memory.) Second, a strange prejudice circulated among mathematicians, to the effect that distributive lattices are just Boolean algebra1 s weak sisters.
More recently, the picture seems to have brightened. The definitive representation theorem for distributive lattices has been proved by H. A. Priestley ; it extends at long last to all distributive lattices the duality "distributive lattice - partially ordered sets", first noticed by Birkhoff for finite lattices. Strangely, Nachbin's theory of ordered topological spaces had been available since 1950, but nobody before Priestley had had the idea of taking a totally disconnected ordered topological space as the structure space for distributive lattices.
577

The second prejudice was more difficult to overcome; it

paralleled the criticism of similar prejudices in other

branches of mathematics. To stay on comparatively familiar

ground, consider what happened in combinatorics. Here, it

became clear a short while ago that the notion of set would

have to be supplemented by a more pliable notion, which Knuth

has called multiset. A multiset is simply a set where every

element is assigned a multiplicity, positive negative or

zero. Aside from the fact that multisets are found plenti-

fully in nature, they offer a decisive advantage over sets:

they form a torsionless ring, whère addition and multipli-

cation are defined "elementwise"

(Indeed, multisets are

functions from a set to the integers.) Sets, on the other

hand, have a more rigid algebraic structure: they form a

Boolean algebra, or at best a distributive lattice. But it

turns out that even for the study of Boolean operations on

sets it is preferable to work with the ring of multisets, as

was first noted by Whitney; unfortunately, his suggestion

went unheeded until recently.

It is this idea that I put forth a few years ago in my

paper in the Rado Festschrift (It seems that publishing an

idea in a Festschrift is the quickest way to have it forgotten.)

578

Given a distributive lattice L, can we associate to L a ring V(L) such that, if the lattice L were to be a lattice of sets, then V(L) would "automatically" turn out to be isomorphic to the ring of multisets over the same set?
Such a ring V(L) is easily constructed as follows. To begin with, construct an intermediate ring F(L) consisting of all formal linear combinations of elements of L. Addition is defined formally, and multiplication in two steps: if x and y are elements of L, set x y = x y, then extend by bilinearity.
Now, the main fact about the ring F(L) is that the submodule J generated by elements of the form

x + y- x A y - x v y
is an idealI The verification is easy. For any z e L, we must show that the element

z (x + y - x A y - x v y)

(*)

belongs to J. Expanding this expression we find it equals

z A x + z A y - z a (x A y ) - z A (x v y) .

579

We now use various identities satisfied in distributive lattices. The third term equals

z A (x A y) = (z A x) A (z A y)

using commutative, associative and idempotent laws for the meet operation A . The fourth term is simplified by the distributive law:

z A (x v y) = (z A x) V (z A y) .

(**)

Making all these substitutions, we find that (*) equals

z A x + z A y - (z A x) A (z A y) - (z A x) V (z A y) ,

which clearly belongs to the submodule J, thereby completing the proof that J is an ideal.
Now define the valuation ring of the distributive lattice L to be the quotient ring V(L) = F(L)/J.
Before proceeding any further, note the following amusing aside. To define the valuation ring, all we need is a set L, together with two binary operations A and v t say, such that, (a) the operation A is commutative, associative and idempotent, and (b) the distributive law (**) holds. Nothing else
580

is assumed of the operation v . Are these identities sufficient to define a distributive lattice?
Nov/, the construction of the valuation ring is (like every other "construction") a functor from the category of distributive lattices to the category of rings. Thus, every distributive-lattice concept should have an analog for a certain sub-category of rings. For example, an ideal in the lattice-theoretic sense, namely, a subset I of L closed under joins and such that x v y e I for x e I and y e L, is, when considered as a subset of the valuation ring V(L), an ideal in V(L) in the ring-theoretic sense.
The problem therefore arises of how to recover the lattice L from the valuation ring V(L). Let us consider two special cases. First, suppose that L is the lattice of all subsets of a finite set S. Then the valuation ring V(L) is naturally isomorphic to a ring of multisets on the set S. This non-trivial fact validates our claim that the valuation ring is indeed the algebraic analog of the ring of multisets.
But now take an ordered set P, and let L=L(P) be the lattice of decreasing subsets of P; a subset D of P is decreasing, if x e D and y <_ x imply that y e D (decreasing sets are also called order-ideals, but we prefer the former
581

term, recently introduced by Priestley.) Lattice operations are unions and intersections of sets. Then it can be shown that V(L) is isomorphic as_ a ring to V(B) , where B is the Boolean algebra of subsets of P generated by decreasing sets. If P is a finite set, then B is the Boolean algebra of all subsets of P.
In order to strengthen the structure of the valuation ring V(L) we must impose some order structure. We shall do it in the simplest way. A valuation ring V(L) will be a torsionless commutative ring generated by idempotents, with a distinguished sublattice L of idempotents, such that L generates the ring. In other words, L will be a subset of idempotents closed under products and under the operation x,y+x+y-xy . A morphism of valuation rings <J> : V(L)-*V(L') is a ring homomorphism which maps L into L'. Every valuation ring V(L) is the valuation ring of the set L considered as a distributive lattice, and the two will be identified.
An element
x = £ n(e)e f n ( e ) > 0 eeL --
is called monotonie. Monotonie elements are closed under sums
582

and products, in other words they form a cone or semiring. It is possible to characterize a valuation ring in terms of this semiring C , as follows.
A commutative ring R with identity will be called a valuation ring if it is endowed with a distinguished subset, or cone, C , closed under sums and products, and forming a distributive lattice, such that:
(a) The lattice operations in C are compatible with sums and products, that is f + (g /\ h) = (f + g) A (f + h) similarly with \/, for f,g and h in C , as well as all other identities satisfied in a lattice-ordered commutative ring which can be written without using subtraction;
(b) Every element of C is a (finite) sum of idempotents belonging to C ;
(c) Every element of R is the difference of two elements of C .
This intrinsic characterization suggests the extension of the present theory to rings not generated by idempotents such an extension might give an extension of classical predicate loqic (see below.)
The category of valuation rings is equivalent to the category of distributive lattices. It has a generator, namely, the valuation ring of the two-element lattice ; we
583

shall see that this fact can be used to obtain a representation theorem for valuation rings. Actually, more is true, but neither category theorists nor first-order logicians have yet invented a precise way of saying it, though the appropriate term was introduced long ago by Birkhoff: the two categories (or first-order theories) are cryptomorphic. In other words, to every fact about one there "naturally" corresponds a fact about the other. The algebraic structure of a valuation ring is richer than that of a ring. It turns out that the linear functional
e( E n(e)e) = £ n(e) eeL eeL
is an augmentation of the ring, that is, it is a ring homomorphism. Setting
f v g = e(g)f + e(f)g - fg, f, g e V(L)
defines a second ring operation on V(L); actually, the same definition works for all augmented algebras.
If L has a minimal element z and a maximal element u , then u acts as an identity and z as an integral (Sweedler) in V(L); that is,
fz = c(f)z, f e L.
584

In the v - r i n g , the roles of u and z are reversed. From now on, we shall assume all valuation rings endowed with u and z , and morphisms to preserve u and z .
The operation of complementation in a valuation ring R is defined as
T (f) = e (f) (u + z) - f, f e R ,
so that in particular
T (Z) = U, T (U) = Z, T (X) = U + Z - X
if x is a positive idempotent. Note that the complementation T is idempotent. Indeed
T2(f) = £(t(f)) (u + z) - Tf =
= e (e (f ) (u + z) - f) (u + z) - e(f) (u + z) + f =
= (2 e (f) - e (f ) ) (u + z) - e(f) (u + z) + f = f,
as desired. As a further check that the complement T is indeed a strengthening of the classical lattice-theoretic complement, suppose R = V(L), and let x* be the complement
585

of x in L. Then check that T(X) = X'. Which identities in distributive lattices carry over to valuation rings? The answer is not hard to guess: all those identities where each variable occurs only once, that is, linearly. For example, the de Morgan law
(x V y)' = x' A y'
carries over to the identity
X(f V g) = T (f ) X (g) ,
but the distributive law
x A (y V z) = (x A y) V (x A z)
does not, because the variable x occurs twice, or nonlinearly, on the right side. It does if one of the entries is idempotent, however.
One of the more interesting identities that carry over to the valuation ring is the inclusion-exclusion principle. It was in fact this identity that originally motivated my definition of the valuation ring. Recall that in the
586

valuation ring, for positive idempotents X1,x2'* * *'xn' one shows that
x,1 V x ,,2V . . . VnX =1X, + ... n -1x2, x0 -1 X3, X ^ - ...
- x n _ 1 x n + x i x 2 x 3 + ··· ~ ··· + ··· i x l x 2 * * *Xn For arbitrary elements f ^ , f 2 # . . . , fn one finds
f l V f 2 V . . . V f n = z (-i)n"i+1 s e(f0lf02...fai)f0(i+1) 1=1 a

fa(i+2)

fan

where the inner sum ranges over all shuffles a of the indices 1,2,...,. n. This identity is valid more generally in any augmented algebra.

587

3. Canonical Idempotents
Let S be a subset of the monotonie cone of V(L), then the subring generated by S is of the form V(L'), where L' is a sublattice of L . Furthermore, if S is finite-dimensional, so is V(L').
Now let L be a finite distributive lattice, and let P be the set of join-irreducibles of L , that is, of those elements p e L such that if p = x V y , then either p = x or p = y. Clearly every element of L is the unique irredundant join of join-irreducibles. It is technically preferable not to consider z as a join-irreducible. The joinirreducibles are linearly independent. The Mobius function p(p,q) is the integer-valued function on P such that

y(p,p) = 1
\i (p,q) = 0
Ey(p,q) = 0 p£q<r

if p £ q for p < r.

Now set

e(p) = E y(q,p)q. qeP

It can be shown that the e(p) and z are a set of linearly independent
588

orthogonal idempotents spanning V(L), and that every xeL is a linear combination of the e(p) and z with coefficients 0 or 1; these properties uniquely characterize the e(p). We shall call them the canonical idempotents. If L is a sublattice of L1, then the canonical idempotents of L are sums of those of L', so we may define the canonical idempotents of an arbitrary distributive lattice L as the union of all canonical idempotents of finite sublattices of L. Every linearly independent subset of orthogonal idempotents is then a subset of the set of idempotents of a finite sublattice of L .
The canonical idempotents can be used to derive criteria for the following: when is an f e V(L) actually a member of the lattice L, that ILS f GXplTGS sible by joins and meets of join-irreducibles? In other words, when is a linear combination
f = Z c (p) p pcP
actually expressible by the two lattice operations alone? This question is particularly important for free valuation rings (v. below). We shall answer it in two ways.
Expressing f in terms of the canonical idempotents we have
589

f = £ a (p) e (p) P

for some coefficients a, which can be computed in terms of the

coefficients c .

Now f e L

if and only if

(a) a(p) = 0 or 1 for all p e P,

(b) if a(p) = 1 and q < p, then a(q) = 1.

In other words, the p for which a(p) = 1 form a decreasing set of the set P of join-irreducibles. Since

a(q) = £ c(p)

this condition can be translated into one in terms of the ccoefficients, which gives the following necessary and sufficient condition for f e L: there exists a decreasing subset A (= lower order-ideal: if p e A and q < p then q e A) of join-irreducibles such that

(*) c(q) = £ y(q,p). peA
For a free valuation ring (v. below) this condition has an elegant topological formulation. The problem whose solution

590

we have just outlined can be restated in purely combinatorial terms: when can a linear combination of idempotents be built up by using only product x y and the operation x + y - x y = x V y ? There is at least one case when the Mobius function can be explicitly computed and thus the solution can be restated more explicitly, that is the free valuation ring on an ordered set Q. Let Q be a set of commuting idempotents subject to identities p q = p, which define a partial order p <_ q. The monotonie cone generated by sums and products in Q defines the structure of a valuation ring V(I.) , where L is the distributive lattice freely generated by the ordered set Q. Note that Q is not the set P of join-irreducibles of L; the set P is the set of all distinct products of elements of Q, thus, P is isomorphic to the distributive lattice of increasing sets of Q (order ideals). The Mobius function of P is calculated by the classical inclusion-exclusion principle, and the canonical idempotents are qiven by the formulas

e (lip) = peS

|B| £ (-1) lip , S ç Q B peB

for every antichain S of Q, the sum ranging over every superset B of S .
591

Using the canonical idempotents, we can define an order relation in V(L). For any monotonie f, the subring generated by f is of the form V(L") for a finite L". Since every g e V(L) is of the form g = f-h with monotonie f and h, it follows that g e V(L') for some finite L'. Hence
g = E a(p)e(p) , peP
where P is the set of meet-irreducibles of L 1 , and e(p) the canonical idempotents. Say g >_ 0 if a(p) 0 for all p. can be shown that this is an order relation which makes V(L) into a lattice-ordered ring. Note that this is a different order relation from the one defined by the monotonie cone.
The canonical idempotents can be used to systematically solve systems of Boolean equations in a distributive lattice In fact the notion of pseudo-Boolean function of Hammer and Rudeanu is seen to be a special case of the valuation ring, and much of their theory can be extended to the present context.
592

4. Representation If L is finite, then for x e L we have
x -- E e (p) , p<x
and in this way we obtain a representation of every x e L as the indicator function (characteristic function) of a decreasing subset of the set P of join-irreducibles. The monotonie cone of V(L) is thus represented as the cone of non-increasing functions on P, and V(L) is represented as the ring generated by the indicator functions of increasing subsets of P. We thus obtain a very simple proof of Birkhoff1 s theorem.
We can extend this result to arbitrary valuation rings. Define P(L) as the set of all prime ideals of the ring V(L) generated by all canonical idempotents. Given any two prime ideals a,b e P (L) , such that a b and a / b, we can find two orthogonal idempotents e,f e E(L) such that e e a and f e b; now take a finite-dimensional sublattice L' for which V(L') contains both e and f as canonical idempotents; it is then easy to find an increasing element p and a decreasing set q such that e p = e and f q = f.
593

Now use the canonical idempotents, together with u and z, to define a compact totally order disconnected topology on the ordered set P(L). This topology, in view of the above remarks, enjoys the following property: given a,b not comparable, we can find an increasing clopen set p and a decreasing clopen set q such that a e p and b e q. Such a space is called totally order disconnected.
One thus gets the following representation theorem: every valuation ring is isomorphic to the ring generated by the (monotonie) cone of integer-valued non-increasing continuous functions on a totally order-disconnected compact space. This representation theorem is easier than the direct representation theorems for lattices, even for Boolean algebras.
Restated in categorical terms, the preceding argument can be made to prove the following. Consider the category Dis of distributive lattices having maximal element u and minimal element z, where morphisms are lattice-homomorphisms preserving u and z, as well as the category Val of valuation rings,where morphisms are ring homomorphisms preserving u and z and the monotonie cone; finally, the category Mon of all rings of continuous integer functions on totally order disconnected compact spaces, endowed with the monotonie cone of
594

all non-Increasing functions, and morphisms consisting of all ring homomorphisms preserving the monotonie cone. The three categories are equivalent. (Note that in the category Mon the integral z requires special care.) By this equivalence, a host of questions relating to Boolean algebras and distributive lattices can be simplified.
A variant of the representation theorem replaces prime ideals by morphisms of V(L) into the valuation ring of the two-element distributive lattice. Another variant uses the representation in the finite case and constructs the space P(L) as a categorical limit. This last is perhaps the most satisfactory, though least familiar approach, since it exhibits totally order disconnected spaces as pro-finite ordered sets.
595

5. Homology
Let P be a finite ordered set. It is well-known that one can associate to P the homology groups of the simplicial complex £(P) whose faces are all the linearly ordered subsets of P , ordered by inclusion. If P is already a simplicial complex, one obtains ordinary simplicial homology. If P has a unique minimal element z, then the homology of P is trivial. More generally, the rank of the zero-th homology group Hq (E(P)) equals the number of connected components in the Hasse diagram of the ordered set P, but an interpretation of the homology of P in terms of the order of P has not been given.
Now, we can associate to P the valuation ring of the distributive lattice of its decreasing sets, by a (contravariant) functor. This leads to the suspicion that the homology of an ordered set may be defined in an algebraic way by means of the associated valuation ring. It turns out in fact that the Koszul complex construction gives a resolution which is closely related to the simplicial homology of Z(P). Because the technique is not familiar, we briefly describe it here.
Suppose the valuation ring V(L), with set P of joinirreducibles, acts on a module M . The most important case
596

occurs when M is a module of integer- or real-valued

functions on a set S , and the action is obtained by associating to every p e P the indicator function of a sub-

set of S , followed by ordinary multiplication. In

plain words, the ordered set P is "represented" by a family

of subsets of 3 , where inclusion of subsets is isomorphic

to the order of P . The homology of P thus should be a

measure of the complexity of a system of sets, relative to

unions and intersections. Note that different modules M

can give rise to essentially distinct homologies for the

same ordered set P .

For simplicity denote the action of P on M by

(p,m)+pm, and list the elements of P , say

,...,pn>

Choose anticommutative variables e^,...,e generating an ex-

terior algebra: e.e . = - eJ.e.1 . (Note: these are not
members of V(L).) Let E^(M) be the module of all linear combi-

nations of elements of degree k , with coefficients in M ,

that is, of linear combinations of elements of the form

m (e. e. . . . e . ) , 0 k n , to e M .

1 21 1

kx

Define the boundary operator 9 of such an element by

9(m e. e. ... e. ) =

1 2X 1

kx

597

= p . m (e. ... e. ) - p . m (e. e. ... e. ) + ... -

X1 X2

Xk 12 11 3 xk

- ...

+ (-1)^ ^ p. m (e. e. ... e. ) .

k 1 2X 1 1

1k-l

This is well defined in view of the anticommutativity of the
2
e^. It is easily verified that 8 = 0, so that we obtain a
complex associating a resolution to P and M .

Our claim is that simplicial homology of an ordered set

P can be obtained from the Koszul complex of P considered

as a subset of the valuation ring.

The following questions may be worth investigating:

(a) Starting with the valuation ring of an infinite

distributive lattice L , is it possible to define its

homology by approximation by finite sublattices, whose

valuation ring is a subring of the valuation ring of L ?

This might simplify the process of simplicial approximation.

(b) In the finite ordered set P , the submodules M^ k-1

generated by p^ - p^ + . . . + (-1) p^

·

generate all of the valuation ring. Each of these

alternating sums is the indicator of a subset of P; thus we

obtain a sequence of increasingly complex subsets of P ,

whose union is the family of all subsets of P . It is

598

inevitable to conjecture that the dimensions of M^/M^ ^ should be related to the Betti numbers of P . This filtration provides a measure of the complexity of a subset of P , which can in turn be used for the study of Boolean functions (see below.)
(c) The Koszul resolution may be expressed in terms of the canonical idempotents, instead of the join-irreducibles. In this way, one obtains an expression for the boundary in terms of the Mobius function. Is it possible in this way to relate the homology to the Mobius function? Judging by the example of geometric lattices, it should be.
(d) It is an open question to construct free resolutions for the valuation ring. Taking the elements of P as generators, one has the relations
p q = X c(r) r reP
for suitable coefficients c(r), easily computed in terms of the Mobius function of P . But these relations are not independent, considered as a module over V(L). What are their dependencies? The question is not trivial even in the case of a valuation ring freely generated by an ordered set Q , as considered above,where the only relations are of the
599

form pq = p. These relations are not independent; a smaller generating set is obtained by taking only those where q covers p; but even these are not always independent. The question of a free resolution is worth investigating, if only because of the possible connection with the characteristic polynomial of the ordered set P , which, as has been observed, shares some of the properties of the Hilbert polynomial .
In terms of the canonical idempotents, a set of relations is given by the orthogonality relations. However, these are seldom independent; their dependencies depend on linear relations satisfied by the Mobius function.
600

6. Propositional Calculus

Classical propositional logic is equivalent to the

study of the free valuation ring V(L) generated by a sequence

of idempotents x^ fJ^' · · · ·

e l e m e n t s of this ring will be

called Boolean polynomials. The axiomatic of pronositional

logic amount to an axiomatic for rings generated by idem-

potents. The constants u and z in the ring V(L) corres-

pond to the propositional constants for truth and falsehood.

The implication p o q for idempotent p and q turns out to

equal u - p + p g, and the deduction theorem states that if

P,q are idempotents and p>q, then pj> q « u. Verifying that a

statement is a tautology amounts to showing that it equals u.

The present context leads to a re-examination of some of

the concepts of classical logic, and we shall consider a few

by way of example.

Suppose f,g e V(L) are not idempotents. Is it possible

to give a meaning to "f implies g"? For monotonie (or even

non-negative) f and g, the natural extension is f <_ g.

For a given sequence f ^ , . . . , f 2 of Boolean polynomials,

not necessarily idempotent, one can define the information

of the sequence to be the sublattice L' of L generated by

the sequence (with o r without taking complements). The com-

plexity of the sequence can then be described by finding a

601

resolution of the set of generators of L', that is the joinirreducibles of L1, in the sense of generators and relations. The relations describe, in an intuitive way, the various ways of proving a subset of the f^ from another subset, and the relations between relations give a meaning to the notion "two proofs are equivalent." The Koszul complex built on P or directly on the f^ also gives information on the complexity of Boolean functions. Thus, the study of complexity of Boolean polynomials can be reduced to techniques of commutative algebra.
The duality of classical logic is preserved in the valuation ring: interchanging joins and meets simply interchanges the roles of u and z , and u becomes the integral, whereas z is theiunit.
The canonical idempotents of the free valuation ring can be explicitly computed. Any subset A of generators dedefines a join-irreducible

and gives for the canonical idempotents e(A) the formula

e (A) = I

\i{A,B)XB

B^<J>

602

If A is the set x ^ , , . . . , x n , then this can be rewritten as
e(A) = X 1 X 2 ... x n (u - x n + 1 ) (u - x n + 2 ) ... .
When is a Boolean polynomial a Boolean function? This question can be interpreted in two ways, according as one admits just meets and joins, or complementation as well. Every Boolean polynomial can be uniquely written as a linear combination of canonical idempotents; it is a Boolean function (including complementation) if every coefficient in such an expression is 0 or 1. It is a Boolean function, expressed by joins and meets only, if and only if the coefficients which equal 1 form a decreasing set of P .
Suppose now that a Boolean polynomial f is given in the form
( * ) f = I c(A)xa , A
where A ranges over a finite set of idempotents. What conditions must the numerical coefficients c(A) satisfy, in order that f be a Boolean function built up out of joins and meets (but not complements)? An elegant answer can be given using the notion of Euler characteristic of a simplicial complex, namely, a
603

family of sets closed under the operation of taking subsets. If I is a finite such simplicial complex, and A a member, or "face" of then the relative simplicial complex (E,A) consists of those faces of E which contain the face A; let denote the Euler characteristic of the relative simplicial complex (J],A). The answer to our question is: a Boolean polynomial (*) is a lattice polynomial if and only if
c (A) + 1 = -
for some simplicial complex £ of subsets of the set of joinirreducibles; A ranges through the faces of E , and c(A) = 0 otherwise.
Now consider the representation of a Boolean polynomial f in terms of joins, meets and complements x = u-x. In terms of the canonical idempotents a necessary and sufficient condition is that
f = E c (A) e (A) + u E ( .| c (A) | -c (A) ) /2 , AA
with c(A) = + 1. Again, this can be turned into a condition in terms of the generators x^,but we shall not do so. The representation in terms of joins, meets and complements is not unique, as is well-known, and the theory of prime implicants
604

can be developed along present lines. So can the classical

theory of Boolean equations.

A (propositional) theory is an ideal in the free valua-

tion ring, generated by Boolean functions, that is, by

members of L ; in this case the quotient is again a valuation

ring, in general not free; again, the complexity of the axiom

system can be investigated by generators and relations, or by

finding a suitable basis for the axioms in the valuation ring.

Finding the canonical idempotents explicitly amounts to solving

the decision problem for the theory. We shall illustrate the

simplicity of the use of the valuation ring by an example

from combinatorics.

Recall that a geometry on a finite set S is a family

of n-subsets called bases such that if (a^,...,a^) and

(b^, . . . , b ) are bases, then for some i , both (b^, , . . . , a^)

A
and ( a ^ , . . . , . . . , b n ) are bases. A fundamental problem is that of deciding which statements about bases follows from

this axiom.

Now one can restate the axiom as an identity in the

valuation ring generated by idempotents

) which

take the value 1 if the a^ form a basis, and 0 otherwise.

The basis axiom then turns into a linear identity, which,

simplified by the inclusion-exclusion principle, is

605

(a^,...,an) (b1,...,fc>n) = (b1,a2,...,an)

...fbn)V

V 2, a ' ' ' *

'al'b3 ' * " * V

n ( b ^ , b 2 , . . . - S (b^,a2,...an)

^ ^bn'a2 ' * * * ......,bn) -

A
· b^) 4" · · · ·

A

This identity can be analyzed by Young's method of standard tableaux. In this way, a decision procedure can be found for combinatorial geometry, and the powerful techniques of representations of the symmetric group can be brought to bear on the problem.

606

7. Averaging Operators
An averaging operator on a valuation ring V(L) is a linear operator A such that
(1) A u = u , A z = z . (2) A(fAg) = Af Ag. (3) If f is in the monotonie cone, so is Af.
Sometimes these operators go by the name of Reynolds operators. In probability, they are called conditional expectations . We shall investigate the structure of averaging operators. To this end, it is convenient to consider valuation rings with coefficients in an arbitrary commutative ring R with identity subject to conditions to be specified later, and written V(L,R).
The range of an averaging operator A is a valuation ring of the form V(L'), where L' is a sublattice of L . For every x e L we have
(*) A x = E c (x,e)e , c(x,eXe R , eeP
where P is the set of canonical idempotents of L' other than z , and the sum is finite. We shall characterize an averaging operator by properties of the coefficients c(x,e).
607

Since A e = e for e e P we infer that if x /y e = z, then A x A e = z, or, as we shall say, the support of Ax contains the support of x . Furthermore, we infer
(1) c(x A e,e) = c(x,e) . (2) c(e,e) = 1 , e e P . From the fact that A is linear, or A(x v y) + A(xy) = Ax + Ay we add the property (3) c(x A y,e) + c(x V y,e) * c(x,e) + c(y,e), x,yeL, in other words, for fixed e the function c is a valuation on the lattice L . Finally, we have that A z = z, so
(4) c(z,e) = 0 and A u = u , whence
c(u,e) = 1 . When the lattice L' is finite, and when P is the set of canonical idempotents of L' , conditions (1) - (4) on the coefficients c define a unique averaging operator.
608

When L' is not finite, the right side of (*) is not well-defined; to handle this case, we introduce a seemingly special class of averaging operators. For every finite sublattice 7T of L' , let A^ be an averaging operator whose range is the valuation ring V(tt) , considered as a subring of V (L) . If a is a sublattice of tt , we assume that

(**)'

A aA TT = A a ,'

in other words, the operators A^ form a martingale as TT runs through all finite sublattices of L' . Now set, for x eL

(***)

A x = lim A_ x TT tr

where the limit on the right side means the following: for

every x e L there is a sufficiently large sublattice ir of

L' such that A x
TT

= A x, and Aax

= x for all sublattices

o

of : L ' containing TT . We shall say that such an averaging

operator is obtained by finite approximation.

Condition (**) implies a condition on the coefficients

c , derived as follows. Writing

A x = I c(x,e)e; A x = E c(x,f)f,

° eeP

feQ

609

where P and Q are the sets of canonical idempotents of a and it, we find

A aA

x = £ £ c(x,f)c(f,e)e = ÏÏ e f£

and hence

= £ c(x,e)e , e

£ c(x,f)c(f,e) = c(x,e) . f

Since a is a sublattice of TT , each canonical idempotent of ÏÏ is contained in a unique canonical idempotent of a , and the preceding sum simplifies to

£ c(x,f)c(f,e) = c(x,e) . f <e
Replacing x by xf for a fixed canonical idempotent f of o, this gives
£ c(xfQ,f)c(ffe) = c(xfQ,e). f <e
But c(xf o ,f) = 0 unless f = fo . and this sum simp^lifies to
610

c(xfo ,' fo )c(fo' ,e) = c(xf o' ,e) ,'
which in turn can be restated in more elegant form as

(5) c(x,ef)c(f,e) = c(xf,e) .

This is the condition for a cocycle in homology. Finally, consider the limit condition (***). If A x is given by the right side of (*), and if f is any canonical idempotent of L', then

A(xf) = fAx = £ c(x,e)ef = £ c(x,ef) ef ee
and thus we have that c(x,e) = c(x,f) for any f £ e; in other words, we require :(6) for every x e L and every canonical idempotent e of L' such that

A x = £ c(x,e)e e

with c(x,e) ^ 0

one has c(x,e) = c (x, f ) for every canonical idempotent f of L1 contained in e.
This last condition puts a strong restriction on the sublattice L'. For suppose f < x; then c(x,f) = 1 by (1)

611

and hence c(x,e) = 1; thus, if c(x,e) ^ 1, then no f < e is contained in x . Again, if f x = z, then c(x,f) = 0 by (4); thus, if c(x,e) ? 0, then any canonical iderupotent f such that f meets e also meets x , that is, f A x ^ z. We conclude that there is a maximal f e L' contained in x, call it V'xf and a minimal e c L' containing x, call it ,3x · The (non-linear I) operators on L
x Vx,
are quantifiers (universal and existential) in the sense of Halmos, and the sublattice L' must be relatively complete in L.
We thus find that on the right side of (*) one term always is c(x, V x ) V x , with c(x, Vx) = 1; of the remaining terms, c(x,e) ^ 0 only if e < -Jx. ,A function c (x,e) defined for x c L and for all non-zero canonical idempotents e e L ' , satisfying condition (1) - (6) is called a fibering of L1 by L. We have shown that every averaging operator obtained by finite approximation determines a fibering; conversely, every fibering determines an averaging operator, assuming that L' is relatively complete in L.
612

Any further statement about the existence of a fibering for a given pair L and L' depends on more delicate measure-theoretic questions. If L and L' are Boolean algebras, the existence of a "universal" fibering can be e established, but this requires a previous classification of subalgebras of a Boolean algebra (Haharam ), and cannot be undertaken here. The case of interest in predicate logic is worked out below.
613

8. Quantifiers. Every relatively complete Boolean subalgebra L'
of a Boolean algebra L defines two quantifiers, the existential quantifier
_.. x = inf {y: y x , v e L'}
and the universal quantifier
V x = sup {y : y <_ x, y e L 1 }
We have seen that every non-trivial averaging operator on the valuation ring V(L,R) defines two such quantifiers. Is it possible to reverse the process? In other words, given L and L' , we wish to construct an averaging operator:
A x = E c(x,e)e e
where e ranges over the canonical idempotents of L' , with the following properties:
(a) for x e L, the support of x, that is, £{e: c(x,e)^0}, is the idempotent j x
614

(b) for x e L , the idempotent V x coincides with £{e: c (x,e) = 1}.

Vie shall solve this problem in a special case, which is strong

enough to include the quantifiers of predicate logic. It

will be simpler to describe the construction in set-theoretic

language. Thus, we are given two sets S and T , and on S

a Boolean algebra L' of subsets freely generated by elements

' W 1 ,y2 ,w2 ' Y3 'w3 ' · · · such that

= We identifv L1

with the Boolean alnebra of S-cylinder sets in the product S x T. Now take a Boolean algebra of T-cylinder sets, freely generated by z,,z0,... .

Set

y,1 + t,1

Now let L be the Boolean alaebra of subsets of S x T

generated by the

and w^. The quantifiers from L

to L' can be explicitly described as follows:

(1) If x belongs to the Boolean subalgebra generated

by the y.1 and w.1 , set V x = x and J x x;

(2) Set J (x v y)

v

615

and V(x A y) = V x A V y for all x,y e L;
(3) Set

x.l = yJ .i + wl. , --!Jvl. = 7 1y.' ,

J (x. x. ... x. ) = (y. + w. ) ... (y. + w. ) ,

12

n 11 X1

l2 xn

V

x

. i

=

yx l.'.

^y

y l

.

=

y. l

V(x.1 -,v -- V x ,1n ) = y.1-i,\/ ... V y ,1n, J x. =
!
Vv x.l = 2y1. + w:

In view of the known properties of quantifiers (Halmos) this gives __ x for all x in L . We can now construct the averaging operator of L onto L' , by choosing a suitable universal ring of coefficients.
Set
A x l. = 1y1. + c(x.I.'w.l)wl.

616

where the coefficients c belong to an as yet unspecified

ring. Define A(x. x. ... x. ) by induction, writing

11 l2

1n

A(xti...x n) for simplicity. Having defined A(x,± ...x n--i,) we

have

A(Xl...xn) = A(x1...xn_1(yn + tn)) =

= ynA(x1...xn_1) + A(x1...xn_1tn) ,

so we set A(x1...xn_1tn) = c(x1...xn_1xn, w1...wn)w1...wn .

Let R be the commutative ring with identity generated by these values of c , together with conditions (1) - (6) of the preceding Section. Condition (6) is made specific by stating that

cCx^-.x , w±. . .wnf) = c(x1...xn, w^.-.w^

for any idempotent f in the range of A . These conditions determine the values of c uniquely, and in fact make it a fibering of L by L* .

617

To simplify the computation of A x , write

x.1 = 1p. +1 q., where p.1 =1y. - w. +1 t.1 qa.i = w.l - t.l. Then

is a cylinder set, and

A x .l = p*.l + c (x.l, 'w.)lw. l,'

as is easily checked. As an example of computation with the averaging operator
A , let us verify that

Now,

A(x1X2) + A (x^x2 ) =

·

AfXj^) = yxP2 + c(x1,w1)p2w1 + c^2'W2*ylW2 +

+ c (x^x"2 ,w^w2) w^w2 , and
A(x1X2) = yxy2 + c^x'wl^2Wl + c^x2'w2^ylw2 +

+ c (x1x2 ,w^w2) w 1 w 2 .

Adding,
A(X±X2)

+ A(X1X2)

= Y1(Y2+P2)

+ C ^XL'WL^Y2+P2^

W1 +

45

+ ylW2 + C ' W 1 W 2 ^ W 1 W 2 '
where we have used the additivity of e . But Y 2 + P 2 + w 2 = u ' and furthermore c(x^,w^w2) = c(x^,w^) by condition (6) in the definition of a fibering. Simplifying, the right side is seen to equal y^ + c ^ x l ' w l ^ w l ' a s desired.
One retrieves the quantifiers from the averaging operator by the following algorithm:
(1) Write A x as the sum of multiples of disjoint idempotents,where the multiples are values of c;
(2) To get _J. x, replace by 1 all coefficients which are non-zero, and take the sum of the resulting idempotents;
(3) To get V x , replace by 0 all coefficients which do not equal 1, and take the sum of the remaining idempotents.
We shall informally illustrate the connection with the decision problem for the predicate calculus. Let x^,x2,... be predicates in two individual variables: F1(x,y),F2(x,y),... and let the y.l and w.l be predicates in one individual variable such as G(y). In order to analyze the validity or satisfiability of a formula in the predicate calculus quantified in the single variable x, and not necessarily in prenex normal form, reason as follows. Every predicate F^(x,y) can be decomposed into the disjoint sum of three predicates: F.n(x,y), corresponding to the set of x for which no y
619

exists for which F^(x,y) is true, F ^ ( x , y ) , corresponding to

the set of x for which there exists some y such that

F^(x,y) is true, and F^2 (x,y), corresponding to the set of

x for which F^(x,y) is true irrespective of y. Clearly

F±(x,y) = Fi0(x,y) + Fi;i(x,y) + F ± 2 (x,y) . Now Fi]L(x,y)

corresponds to t^, and F^2(x,y) corresponds to y^. We as-

sign predicates G.(x) and H.(x) = F.~(x,y) to t. and y.,

"

l

l

i2 '1

l yl'

so that we have

A F (x,y) = C (F, Gi) G± (x) + H± (x) .

By this technique, and its extension to several variables, every formula of the predicate calculus is seen to be equivalent to a formula in a valuation ring endowed with commuting averaging operators. In other words, problems of first-order logic, such as the decision problem, can be shown to be equivalent to algebraic problems for valuation rings with averaging operators.
The case of several commuting quantifiers is technically more complex, but the idea is the same: one considers a Boolean algebra generated by disjoint parellelepipeds of a very special kind in an n-cube; the expression of quantifiers by averaging operator is akin to an Herband expansion,

620

but the linear structure of the valuation ring allows considerable simplifications. We hope to take up these matters elsewhere.
621

9. Logic and Probability.
In the present context, the algebra of real random variables on a probability space can be viewed as a close analog of a valuation ring, the only difference being that infinite sums of idempotents are allowed. In fact, the passage from predicate logic - i.e., a valuation ring with a set of commuting averagincr operators - to probability is achieved by the following steps:
(1) Assign a probability measure y to the canonical idempotents;
(2) Define an L-space norm on the valuation ring by setting
|Ea(e)e| = E|a(e)|p(e) ? e
(3) Complete the resulting normed linear space, thereby obtaining an L-space, representable as the space of all integrable functions.
(4) Represent every averaging operator as a conditional expectation operator (in the sense of probability.) Once the restriction that every element of the range be finite-valued is removed, one can show that a conditional expectation operator always exists.
622

The resulting structure is richer than that of a probability space, because it is endowed in addition with a monotonie cone of non-decreasing functions.
By this process certain questions of predicate logic can be seen to be analogous to questions in probability, and new questions in probability are suggested by the analogy - . For example, does the decision problem for averaging operators make sense? Problems of model theory, which can be rephrased and simplified in the context of valuation rings, have analogs for probability spaces. The intriguing possibility arises of handling the decision problem of predicate logic by the techniques of probability.
623

10. Acknowledgements.

It was L. Solomon who first introduced what we have

called canonical idempotents, but his construction remained

obscure for several years; he called it the Mobius algebra

of an ordered set. A few years later, the present writer

introduced the notion of valuation ring of a distributive

lattice, quite unaware that it might be related (at least in
n
the finite case) with Solomon's Mobius algebra. It was R,

Davis who proved the isomorphism of the two structures;

successively, C. Greene made the calculations with canonical

idempotents obvious, and used them to systematically derive

properties of the Mobius function. It must be pointed out

however that the valuation ring is more general than the

j» ,

,

Mobius algebra, since it does not require any fmiteness

assumptions.

The valuation ring was later studied by Geissinger in

a series of papers; to him is due the existence of an aug-

mentation, the integral, and the elegant duality, which ex-

tends to all valuation rings the duality of Boolean algebras.

The representation of distributive lattices in terms of

totally order disconnected spaces was recently discovered by

Priestley ; we have given here the valuation-ring version,

which is slightly simpler and tells more. The notion of

624

quantifier on a Boolean algebra was introduced by Everett and Ulam and extensively studied by Ilalmos and others, but the precise connection with averaging operators seems to be new, though the analogy had been noted by Wright. Averaging operators on spaces of continuous functions have an extensive literature (Brainerd, Kelley, Wright); in the present context they have not been previously considered.
It seems astonishing that the use of the valuation ring as a technique of proof and as a decision procedure should not have been realized and exploited, even for the propositional calculus. We hope the present paper will contribute to correct this neglect.
The conjectured connection between the homology of an ordered set and the Koszul complex also seems to be new, and we hope its potential usefulness in studies of computational complexity will also be developed.
625

Bibliography
1. Adam, A., Truth functions, Akademiai Kiado, Budapest, 1968. 2. Birkhoff, G., Lattice Theory, 3rd ed., A.M.S.,
Providence, 19 6 8. 3. Brainerd, B., On the structure of averaging operators,
Journ. Math. Appl., 5 (1962), 347-377. 4. Cartan, II., and Eilenberg, S., Ilomological Algebra,
Princeton University Press, Princeton, 1956. 5. Church, A., Introduction to Mathematical Logic,
Princeton University Press, Princeton, 1956. 6. Davis, R., Order algebras, Bulletin A.M.S., 76 (1970),
83-87. 7. Gratzer, G., Lattice Theory, Freeman, San Francisco, 1971. 8. Geissinger, L., Valuations on distributive lattices I,
II and III, to appear in Arkiv der Mathematik. 9. Greene, C., On the Mobius algebra of a partially
ordered set, Advances in Math., 10 (1972), 177-187. 10. Ilalmos, P., Algebraic Logic, Chelsea, New York, 1962. 11. Hammer, P. and Rudeanu, S., Boolean Methods in Ope-
rations Research, Springer, New York, 196 8. 12. Xeimel, K., Algèbres commutatives engendrees par leur
elements idempotents, Can. J. Math., XXII (1970), 1071-1078.
626

13. Kelley, J. B. , Averaging operators on C^iX) , Illinois J. Math., 2 (1953), 214-223.
14. Priestley, H. A., Representation of distributive lattices, Bull. London Math. Soc. 2 (1970), 186-190.
15. Rasiowa, II. and Sikorski, R. , The mathematics of meta mathematics, Warsaw, 1963.
16. Rota, G.-C., On the representation of averaging operators, Rend.Padova, 30 (1960), 52-64.
17. Rota, G.-C., On the foundations of combinatorial theory I : Theory of Mobius functions, Zeit. fur Wahr 2 (1964) , 340-368.
18. Rota, C.-C., Reynolds operators, Proceedings of the Symposia in Applied Mathematics, Vol. XVI (1964), pages 70-83.
19. Rota, G.-C., On the combinatorics of the Euler characteristic, Studies in Pure Math., edited by L. Mirsky, Academic Press , London, 1971, pp. 221-233.
20. Solomon, L., The Burnside algebra of a finite group, J. Comb. Th. 2 (1967), 603-615.
21. Sweedler, M., Hopf Algebras, Benjamin, 1969. 22. Whitney, H., Characteristic functions and the algebra
of logic, Annals of Math. 34 (1933), 404-414.
627

23. Wright, F. B., Generalized means, Trans. A.M.S., 9 8 (1961) , 187-203.
24. Wright, F. B., Convergence of quantifiers and martingales, Illinois J. Math., 6(1962), 296-307. December 7, 1973
628

