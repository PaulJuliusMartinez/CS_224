The Differential Geometry of Landmark Shape Manifolds: Metrics, Geodesics, and Curvature
by Mario Micheli Laurea, Universita` di Padova, Italy, 1999 M. S., University of California at Berkeley, 2001 Sc. M., Brown University, 2003
A Dissertation submitted in partial fulfillment of the requirements for the Degree of Doctor of Philosophy in the Division of Applied Mathematics at Brown University
Providence, Rhode Island May 2008

c Copyright 2008 by Mario Micheli

This dissertation by Mario Micheli is accepted in its present form by the Division of Applied Mathematics as satisfying the
dissertation requirement for the degree of Doctor of Philosophy.

Date

David B. Mumford, Director

Date Date

Recommended to the Graduate Council Stuart A. Geman, Reader Peter W. Michor, Reader

Date

Approved by the Graduate Council
Sheila Bonde, Dean of the Graduate School
iii

Curriculum Vitæ
Mario Micheli was born in Rovereto (Trento), Italy, on August 27, 1973. He received the laurea degree in Telecommunications Engineering from the University of Padova, Italy, in 1999; as an undergraduate, he was an exchange student at the Universit´e Bordeaux I, France, during the Fall semester of 1997 and at the University of California at Berkeley during the academic year 1998-1999. While at Berkeley he wrote a thesis for his laurea degree with the title A Probabilistic Approach to Three-dimensional Autonomous Navigation.
In the Fall of 2000 he enrolled into a graduate program at UC Berkeley and received Masters of Science degree in Electrical Engineering in May 2001; while at Berkeley he worked under the supervision of Professors Shankar S. Sastry and Michael I. Jordan, both from the Department of Electrical Engineering and Computer Sciences, and wrote a thesis with the title Random Sampling of Continuous-time Stochastic Dynamical Systems: Analysis, State Estimation, and Applications..
In September of 2001 he began his doctoral work in the field of Applied Mathematics at Brown University, where he was supervised by Professor David B. Mumford. While at Brown he was supported by research assistantships, a teaching fellowship, a Florence Harnish Fellowship, and a dissertation fellowship. He received a Masters of Science degree from Brown University in Applied Mathematics in May 2003.
In September 2008 he will join the Department of Mathematics of the University of California at Los Angeles, as a postdoctoral scholar.
iv

Dedicated to my parents, Margherita and Giuseppe Micheli
v

Acknowledgements
First and foremost I wish to thank my thesis advisor, David Mumford, for having given me the honor of working with him and for having introduced me to the wonderful topic of shape spaces; his precious teachings will help me for many years to come. Stuart Geman has also been an invaluable resource, and I am very grateful for all of our many helpful discussions. I must add that both David Mumford and Stuart Geman have given me, during my years at Brown University, advice and support that often times went beyond the academic realm; their graciousness and wholeheartedness are truly rare. I also wish to give my special thanks to Peter Michor of the University of Vienna for his remarkable patience and flexibility as reader of this thesis.
I had initially promised myself that I would not attempt to make a list of all the people and friends who have made these many years at Brown University the life-changing experience that it has been--although it would have been an excellent excuse to add a few pages to this thesis. However, I finally decided to (partially) break my promise: some of them have been so caring and supportive in different ways during the very last part of my stay here at Brown that I would have probably not been able to complete my work without them. They are Dzigbodi Agbenyadzie, Yi Cai, Indrek Kulaots, Akil Narayan, Anish Shah, Vito Stella, and Wei-Ying Wong. They truly deserve my gratitude.
Last, but certainly not least, I would like to thank my parents, Margherita and Giuseppe Micheli, for their unconditional support, selfless love, and continuous advice; despite the physical distance separating us they have always been the harbor where to seek refuge in case of need. This work is dedicated to them.
vi

Contents
Curriculum Vitæ
Dedication
Acknowledgements
List of Tables
List of Figures
Chapter 1. Introduction
Chapter 2. The Riemannian Manifold of Landmarks 1. General framework 2. Riemannian formulation 3. Numerical Examples 4. More on Kernels 5. Further Generalizations
Chapter 3. Momenta and Conservation Laws 1. Hamilton's equations 2. Conservation laws
Chapter 4. Curvature in terms of the Cometric Tensor 1. Motivation 2. Generalities on the Riemannian Curvature Tensor 3. The dual Riemannian Curvature Tensor 4. Sectional Curvature in terms of the cometric tensor 5. Bounds on Sectional Curvature
vii

iv
v
vi
ix
x
1
4 4 8 20 23 25
29 29 34
40 40 41 45 52 58

Chapter 5. Curvature of the Landmarks Manifold 1. The dual curvature tensor for one-dimensional landmarks 2. Sectional curvature for two one-dimensional landmarks 3. Sectional curvature for three one-dimensional landmarks 4. Sectional curvature for N one-dimensional landmarks 5. Sectional curvature for N D-dimensional landmarks 6. Conclusions
Chapter 6. The Qualitative Dynamics of Landmarks 1. Introduction 2. Dynamics of two one-dimensional landmarks 3. Dynamics of three one-dimensional landmarks 4. Dynamics of two two-dimensional landmarks
Chapter 7. Conclusions 1. Results 2. Applications and Future Work
Appendix A. Admissible Hilbert Spaces and Reproducing Kernels
Appendix B. Properties of Bessel Kernels 1. Introduction 2. Differential equation 3. Asymptotic behavior at zero
Bibliography

66 66 77 85 91 96 103
105 105 106 133 137
144 144 145
148
155 155 156 158
161

viii

List of Tables

5.1 Eigenvalues and pairs (X, Y ) that achieve them, along 12 = 23;

 denotes a very small (but nonzero) number.

90

5.2 Eigenvalues and pairs (X, Y ) that achieve them, in selected

locations of along the ridge of scalar curvature, shown in

Figure 5.8;  denotes a very small (but nonzero) number.

91

6.1 The nine cases of initial momenta p1(0), p2(0) .

108

ix

List of Figures

2.1 Geodesic curve for landmarks traveling in opposite directions; black dots and circles represent initial and final positions, respectively. The corresponding diffeomorphism v01 is also shown. 21

2.2 Geodesic curve for landmarks traveling in the same direction; black dots and circles represent initial and final positions, respectively. The corresponding diffeomorphism 0v1 is also shown. 22

2.3 Deformation of a square; black dots and circles represent

initial and final positions, respectively. The corresponding

diffeomorphism v01 is also shown.

23

5.1 Typical shape of function f : R  R.

70

5.2 Sectional curvature ( 12) for the Gaussian kernel.

81

5.3 Maximum generalized eigenvalue (i.e. maximum sectional

curvature) for three landmarks in one dimension, as a function of

distances 12 and 23.

86

5.4 Minimum generalized eigenvalue (i.e. minimum sectional

curvature) for three landmarks in one dimension, as a function of

distances 12 and 23.

87

5.5 Median generalized eigenvalue for three landmarks in one

dimension, as a function of distances 12 and 23.

88

5.6

Trace

(i.e.

1 2

times

scalar

curvature)

for

three

landmarks

in

one

dimension, as a function of distances 12 and 23.

88

x

5.7 Generalized eigenvalues of (-R, G) for three landmarks in one

dimension of the quadratic form along the line 12 = 23.

89

5.8 Locations along the "ridge" of scalar curvature for Table 5.2. 92

5.9 Typical shape of function f1(x), x = (v, u), for D = 2;

99

6.1 Sectional curvature ( 12) for the Gaussian kernel.

109

6.2 Six trajectories in Case 1: q1(0), q2(0) = (0, 1), (0, 2), . . . , (0, 6)

and, in all six cases, p1(0), p2(0) = (10, 0).

111

6.3 Trajectory in Case 2: q1(0), q2(0)) = (0, 1), p1(0), p2(0) = (9, 1). The top and bottom graphs represent, respectively, the evolution

of positions and momenta versus time. Note that the second

landmark (dashed line) bounces off the first one (continuous line)

and eventually the two momenta are swapped.

113

6.4 The same trajectory of Figure 6.3 drawn in the (q1, q2) plane. 114

6.5 Conjugate points for trajectories that originate at a common

point in the region of positive curvature (Case 2).

117

6.6 Trajectories that originate at the same point in the region of

negative curvature (Case 2).

118

6.7 Trajectories that originate at the same point in the region of

negative curvature and meet again in the region of positive

curvature (Case 2). Dashed trajectory: q1(0), q2(0) = (0, 1.3),

p1(0), p2(0) = (7, 3). Continuous trajectory: q1(0), q2(0) =

(0, 1.3), p1(0), p2(0) = (5.01, 4.99).

119

6.8 Trajectories with initial momenta p1(0), p2(0) = (5, 5) but

different initial positions (Case 3).

120

6.9 Two sets of trajectories for Case 4, which share common initial

momenta but have two different starting positions.

122

xi

6.10 Trajectories for Case 5, all with initial momenta p1(0), p2(0) =

(0, 10) but different initial positions.

122

6.11 Evolution of positions (top) and momenta (bottom) versus time

in Case 6. The continuous lines represent q1(t) and p1(t), while

the dashed lines represent q2(t) and p2(t).

124

6.12 A typical trajectory for Case 7, plotted against time. Top:

positions; bottom: momenta. Continuous line: first landmark;

dashed line: second landmark.

127

6.13 Three sets of trajectories in Case 7.

128

6.14 A typical trajectory for Case 8, plotted against time. Top:

positions; bottom: momenta. Continuous line: first landmark;

dashed line: second landmark. Note the exchange of momentum

that occurs in the first part of the trajectory, when the two

landmarks are relatively close.

130

6.15 A typical trajectory for Case 9, plotted against time. Top:

positions; bottom: momenta. Continuous line: first landmark;

dashed line: second landmark.

131

6.16 Three sets of trajectories for Case 9.

133

6.17 Positions and momenta versus time for Example 1 (p1(0) > 0,

p2(0) = p3(0) = 0). Landmark 1: thin line; Landmark 2: thick

line; Landmark 3: thick dashed line.

134

6.18 Positions and momenta versus time for Example 2 (p1(0)

p2(0) = p3(0) > 0); large initial mutual distances. Landmark 1:

thin line; Landmark 2: thick line; Landmark 3: dashed line.

135

6.19 Positions and momenta versus time for Example 2 (p1(0)

p2(0) = p3(0) > 0); small initial mutual distances. Landmark 1:

thin line; Landmark 2: thick line; Landmark 3: dashed line.

136

xii

6.20 Positions and momenta versus time for Example 3 (p1(0) > 0,

p2(0) < 0, p3(0) < 0, with p1(0) > |p2(0) + p3(0)|). Landmark 1:

thin line; Landmark 2: thick line; Landmark 3: dashed line.

137

6.21 Converging trajectories for two landmarks in 2D.

139

6.22

Converging trajectories for two landmarks in 2D--detail.

139

6.23 Diverging trajectories for two landmarks in 2D.

140

6.24 Converging trajectories for two landmarks in 2D.

141

6.25 Diverging trajectories for two landmarks in 2D.

142

6.26

Existence of conjugate points for two landmarks in 2D.

142

xiii

CHAPTER 1
Introduction
The study of shapes and their similarities is central in computer vision, in that it allows to recognize and classify objects from their representation. One has the interest of defining a distance function between shapes, which both expresses the meaning of similarity between shapes for the application and task that one has in mind, and at the same time is mathematically sound and treatable. In recent years the use of differential-geometric techniques for the study of shape deformation has rapidly spread to broad applied fields such as Pattern Analysis and Statistical Methods (e.g. for object recognition, target detection and tracking, classification of biometric data, and automated medical diagnostics).
One of the main ideas in this area has been to use fluid flow notions [8, 9], which lead to Riemannian metrics on many deformation related spaces ("shape spaces") [22, 24, 36, 42, 43, 47]; the aforementioned distance function is, in these cases, precisely the geodesic distance with respect to such metrics. However, the geometry of these Riemannian manifolds has remained terra incognita until very recently, when certain fundamental questions started being addressed [31, 32, 33, 48]: for example, the curvature of such manifolds has remained completely unknown in most cases. This thesis focuses on the computation of sectional curvature and its implications in one of the simplest shape spaces, which is that of landmark points.
The knowledge of curvature on a Riemannian manifold is essential in that it allows one to infer about the existence of conjugate points, the well-posedness of the problem of computing the implicit mean (and higher statistical moments) of samples on the manifold, and more. Such issues are of fundamental importance since they allow to build templates, i.e. shape classes that represent typical situations in certain applications like the emerging field of computational anatomy [10, 14, 15,
1

18, 22, 34, 35, 46]. For example, templates can used for the identification of structures in Magnetic Resonance Images (MRI) of brains. A template can represent the prototypical structure of a healthy person's brain, or the structure of the brain of someone developing Alzheimer's disease: such templates are matched to the MRI scan of an individual patient, and the geodesic distances between the data and the templates can then be used to formulate a diagnosis on the patient's health. In Medical Imaging statistical analysis is normally performed on the tangent space at the implicit mean (or Karcher mean [38]), but the differential-geometric issues mentioned above are too often ignored, which can lead to conspicuous inaccuracies. We will briefly return on these motivating issues in the concluding chapter of this thesis, after the geometric structure of the shape manifold of landmark points has been explored.
The thesis is organized as follows. Chapter 2 formally introduces the energy functional that has to be minimized in order to compute the distance between between two sets (landmarks configurations); most of the chapter is dedicated to proving that such functional can be written as the energy of a path with respect to a Riemannian metric tensor, so that the square root of the minimized energy is, in fact, a geodesic distance. Once the Riemannian structure is established, the geodesic equations are developed (in the Hamiltonian formalism) in Chapter 3, where conservation laws deriving from the translation-invariance and the rotation-invariance of the metric tensor are also explored.
It turns out that the cometric tensor (i.e. the inverse of the metric tensor) for the Riemannian manifold of N landmarks in D dimensions can be written as a matrix whose elements depend only on 2D of all the N D coordinates of the manifold, making the matrix of partial derivatives of the cometric tensor very sparse. This suggests finding a general formula for the Riemannian curvature tensor and for sectional curvature in terms of the first and second partial derivatives of the cometric instead of the metric; Chapter 4 is dedicated precisely to solving this highly nontrivial problem, for a generic n-dimensional Riemannian manifold. In Chapter 5, which is central in this thesis, we apply the formulas developed in the previous one precisely to the
2

Riemannian metric for the manifold of landmarks; special attention is dedicated to the simple but informative examples of one-dimensional landmarks. In Chapter 6 we study the qualitative dynamics of landmarks, i.e. the geodesic trajectories that solve the equations developed in Chapter 3; in particular, we study the effect of curvature on said dynamics by verifying, for example, the existence of conjugate points in regions of the manifold of positive curvature. Finally, Chapter 7 summarizes our results, discusses the their potential application to the statistical analysis of medical images, and draws the future plans of our research.
3

CHAPTER 2
The Riemannian Manifold of Landmarks
In this chapter we illustrate how the shape space of landmarks can be endowed with the structure of a Riemannian manifold. The treatment is rigorous, however we skip some technicalities in the mathematical preliminaries section regarding the regularity of diffeomorphisms, limiting ourselves to citing and later using results that the reader can find, for example, in [43, 47]. We formulate the distance between two shapes in terms of the average kinetic energy of a velocity field that transports one shape into the other; we then show that such energy can be expressed in the form of the energy of a path with respect to a Riemannian metric tensor. At the end of the chapter we briefly discuss ways of extending the approach to generic shapes, by formulating it in terms of Lie groups of diffeomorphisms acting on shape manifolds.

1. General framework
Let I be the space of N landmark points in D dimensions, that is, the generic element of I is given by I = (x1, x2, . . . , xN ), xi  RD, with xi = xj for i = j. Our objective is to endow I with a distance function d : I × I  R+ that will turn out to be the geodesic distance [11, 23, 27] with respect to a Riemannian metric. The idea is to find, among the diffeomorphisms of the plane that map a shape into another, the one that is generated by the velocity field of minimal average "kinetic energy" (to be defined): the distance between the two shapes will be given by the square root of such average energy.

1.1. Mathematical preliminaries. We will start with some definitions and preliminary notions. Let Q be the set of differentiable landmarks paths, that is:

Q

qi : [0, 1]  RD

N i=1

qi(·) is differentiable, for all i

;

4

we shall indicate the generic element of such set simply with q, so that q(t) = {q1(t), . . . , qN (t)}, t  [0, 1]. Let V be a set of functions RD  RD that has the structure of an admissible Hilbert space V, ·, · V (see [17, 43, 47], or Appendix A for an essential treatment of such spaces); the most salient property of admissible Hilbert spaces is that V is embedded in C01(RD, RD) (the subscript 0 denotes functions that vanish at infinity [16]), i.e. such that for some constant C we have u 1,  C u V , for all u  V . For example, V can be chosen to be Sobolev space Hk(RD, RD) with its norm [13]:

(2.1)

||u||V2

RD Lu(x), u(x) RD dx;

in the above expression L = (id - a2)k is a self-adjoint spatial differential operator

(a  R, k  N and  is the Laplacian) that is applied to each of the D components of the vector field1 u. By the Sobolev Embedding Theorem [16] we have in fact that

if k >

D 2

+

1

then

V

is embedded in C01(RD, RD).

Space L1([0, 1], V ) is defined as the

set of functions v : [0, 1]  V : t  vt such that:

||v||L1([0,1],V )

1
vt V dt <  ,
0

while space L2([0, 1], V ) is the set of functions v : [0, 1]  V : t  vt such that:

||v||L2 2([0,1],V )

1

vt

2 V

dt <  .

0

1If we write u = (u1, u2, . . . , uD) the following holds when L = (id - a2)k:

RD

Lu(x), u(x) RD dx =

Dk RD =1 m=0

k m

a2m Du 2 dx,
||=m

where we have used the multi-index notation introduced in [13, 16]. In particular for k = 2 the above expression becomes:

D
RD Lu(x), u(x) RD dx = RD =1

u 2 + 2a2 u

2 RD

+

a4

Hu

2 RD×D

dx,

where u and Hu are, respectively, the gradient and the Hessian matrix of scalar function u . We can see that the Sobolev norm is a linear combination of the L2 norms of a function and of its derivatives; parameter a is just a scaling factor.

5

Set L2([0, 1], V ) is a subset of L1([0, 1], V ) and is in fact a Hilbert space with inner

product u, v L2([0,1],V )

1 0

u, v

V

dt;

we will write the generic element of L1([0, 1], V )

or L2([0, 1], V ) explicitly as vt(x), t  [0, 1], x  RD.

It is well known from the theory of ordinary differential equations [7] that, given

a generic vector field v = vt(x), t  [0, 1], x  RD, under some regularity assumptions

on v the D-dimensional non-autonomous dynamical system

(2.2)

  z = vt(z)  z(t0) = x

has a unique solution of the type z(t) = (t, t0, x). Let V be an admissible Hilbert space; for any v  L1 [0, 1], V we shall define svt(x) (t, s, x); fixing t = 1 and s = 0 we get v(x) 0v1(x), which is the diffeomorphism generated (or induced ) by v. Given an admissible Hilbert space V we will call the set

GV v : v  L1 [0, 1], V

the group of diffeomorphisms generated by V ; its name is justified by the result that for any v  L1 [0, 1], V the map v : RD  RD is indeed a diffeomorphism and the set GV is a group with respect to the operation of composition between functions [43, 47]. In the language of manifolds it turns out that GV is an infinitedimensional Lie group and V is its Lie algebra.

1.2. Definition of the distance function. For generic velocity v  L2 [0, 1], V

and landmark trajectories q  Q define the energy

(2.3) E[v, q]

1 1N
0 RD Lvt(x), vt(x) RD dx dt +  0 i=1

dqi dt

(t)

-

vt

qi(t)

2
dt.
RD

We claim that a distance function d on I between two landmark sets (or shapes)

I = (x1, x2, . . . , xN ) and I = (y1, y2, . . . , yN ) can be defined as

(2.4) d(I, I ) inf E[v, q] : v  L2 [0, 1], V , q  Q with q(0) = I, q(1) = I ;
v,q
the main objective of this chapter is in fact to show that the above function is in fact a geodesic distance with respect to a Riemannian metric.
6

The above infimum is computed over all differentiable landmark paths q  Q that satisfy the boundary conditions, and vector fields v  L2 [0, 1], V . Such fields more or less exactly "transport" (i.e. generate diffeomorphisms that map) the first set of landmarks I into the second one I , depending on the value of smoothing parameter   (0, ]. Such paramenter is a weight between the first term (the aforementioned "kinetic energy", averaged over a unit of time), that measures the smoothness of the vector field that generates the diffeomorphism, and the second term, which measures the exactness of the matching. When  =  we have exact matching, i.e. the landmark trajectories exactly satisfy the ordinary differential equations qi = vt(qi), i = 1, . . . , N which are obtained by setting the integrands of the second term in the right-hand side of (2.3) equal to zero. When  <  we have regularized (or approximate) matching, i.e. the landmark trajectories "almost" satisfy such ODE, so that the diffeomorphism generated by vt(x) does not transport I exactly into I ; this allows for the time varying vector field to be smoother, thus resulting in a smaller distance between the two given landmark configurations. For this reason the second term in (2.3) is often referred to as smoothing term; its function is to make distance d tolerant of small diffeomorphisms, so that object variations due to noise in data are neglected. For the rest of the chapter we shall consider generic values of smoothing parameter .
Note that the smaller  is, the smoother will be the vector field and the less exact will be the matching. In fact for  0 the minimizer (v, q) of energy (2.3) (if it actually exists) has velocity v is close to zero, so that the diffeomorphism v it generates is close to the identity map. This makes the second integral in (2.3) large, but its contribution to E[v, q] is small since  is almost zero. The corresponding minimizing trajectories q will be (almost) straight lines. We shall return to this discussion further on the chapter, when the dependance on  of the Riemannian metric tensor of landmarks manifold I will be clear.
7

2. Riemannian formulation
We remind the reader that our objective is to show that d defined in (2.4) is a geodesic distance on I with respect to some Riemannian metric, which in fact will depend on the chosen differential operator L and on smoothing parameter .

2.1. Minimizing velocity fields and momenta. The following result holds.

Proposition 2.1. For a fixed q¯ =

q¯i

: [0, 1]



RD

N i=1



Q there exists a

minimizer with respect to v  L2([0, 1], V ) of E[v, q¯] and it belongs to the set of vector

fields of the general form:

(2.5)

N
vt(x) = i(t) G x, q¯i(t) ,
i=1

where G : RD × RD  R is the Green's function (or fundamental solution) of op-

erator L in (2.3) and coefficients i : [0, 1]  RD, i = 1, . . . , N are continuous functions.

Note that typically G(x, y) =  x-y RD for some bell-shaped scalar function  : [0, )  R; function G is sometimes called the kernel of space V (in section 4 of this chapter we will briefly return on the topic of kernels). Therefore, for fixed differentiable trajectories q¯i(·), i = 1, . . . , N , energy E[v, q¯] can be minimized with respect to functions i(·), i = 1, . . . , N . We shall indicate with pi(·), i = 1, . . . , N the minimizing values of coefficients i in expression (2.5) and with v = vt(x), t  [0, 1], x  RD the resulting minimizing velocity field; the coefficients pi are called momenta (once the Riemannian formulation is proven, it will turn that such vectors will be the actual momenta for landmark points, as defined in Hamiltonian mechanics).

Remark. We would like to argue that it makes sense, from a physical point of view, that the minimum-energy velocity field that transports the landmarks along trajectories q must be of the form (2.5). In fact what the formula expresses is that the N landmarks are moved around space RD by "lumps" of velocity fields centered around each one of the landmarks themselves; such lumps cannot be point-supported,
8

since the global velocity field vt(x) must minimize a norm of the Sobolev type and therefore be smooth to a certain degree.

Before proving the above proposition and computing the momenta in func-

tion of trajectories q¯ and their time derivatives, we shall introduce some nota-

tion that will allow us to express the results in terms of matrix and vector sum-

mations/multiplications. The scalar components of the N landmark trajectories

qi = qi,1, . . . , qi,D , i = 1, . . . , N can be ordered in an N × D matrix:





q1,1
q2,1
q3,1 ...

q1,2
q2,2
q3,2 ...

···
···
··· ...

q1,D
q2,D
q3,D ...

 ,

qN,1 qN,2 · · · qN,D

where the coordinates of the first, second, . . . , N th landmarks lie on the first, first,

second, . . . , N th rows of the above matrix. In order to keep notation consistent, from

now on we shall consider trajectories qi(·), i = 1, . . . , N as 1 × N row vectors. Instead

we will indicate with q(k) the N × 1 column vector of the kth components of the set

of labeled landmarks:



q(k)



q1,k
q2,k ...

 ,

qN,k

for k = 1, . . . , D, while with an abuse of notation we will indicate with q the super-

position of the above defined q(k)'s, i.e.:

(2.6)



q



q(1)
q(2) ...

 ,

q(D)

9

which is a DN × 1 column vector (the abuse of notation consists in the fact that we

are using the symbol q for both the above vector and the generic element of Q, but

the context in which such symbol is used should clarify its meaning).

As far as the scalar components momenta pi = pi,1, . . . , pi,D , i = 1, . . . , N are

concerned we can order them in a matrix in the same way that we ordered the qi,k's:

(2.7)





p1,1
p2,1
p3,1 ...

p1,2
p2,2
p3,2 ...

···
···
··· ...

p1,D
p2,D
p3,D ...

 ;

pN,1 pN,2 · · · pN,D

similarly to what we did before, we will define:



p(k)



p1,k
p2,k ...

 ,

for k = 1, . . . , D

pN,k

and



p



p(1)
p(2) ...

 ,

p(D)

which are column vectors of size N × 1 and DN × 1, respectively2. In fact, we will

also need to order in a matrix the generic coefficients that appear in (2.5) in the same

way that the momenta are ordered:





1,1
2,1
3,1 ...

1,2
2,2
3,2 ...

···
···
··· ...

1,D
2,D
3,D ...

 ,

N,1 N,2 · · · N,D

and vectors (k), k = 1, . . . , D and  (which are column vectors of size N ×1 and DN × 1, respectively) are defined in an analogous manner. Consistently with the above

2We chose superscript indices for landmark coordinates and subscript indices for momenta because it will turn out that the derivatives of landmark coordinates q and momenta p live, repectively, on tangent bundle T I and on cotangent bundle T I of the Riemannian manifold [28].
10

notation we shall consider velocity fields of the type (2.5) to be row vectors. Also, we

will define the following N × N matrix:

(2.8)

S(q)





G(q1, q1)
G(q2, q1) ...

G(q1, q2)
G(q2, q2) ...

···
··· ...

G(q1, qN )
G(q2, qN ) ...



G(qN , q1) G(qN , q2) · · · G(qN , qN )

where G is the kernel of V ; its generic element will be Sij G(qi, qj), with i, j = 1, . . . , N . Matrix S(q) is definite positive, whence invertible, by Corollary A.5 in Appendix A. Given the above machinery we can proceed to the following proof.

Proof of Proposition 2.1. We will use variational calculus techniques. Neglecting the bar above the symbol q and some of the time arguments for notational compactness, for two time-dependent vector fields v, w  L2 [0, 1], V and for an arbitrary   R we have

1 1N

E[v + w, q] =

vt + wt, vt + wt V dt + 

qi -

vt + wt (qi)

2 RD

dt,

0 0 i=1

that is:

1

E[v + w, q] =

vt, vt V + 2 vt, wt V + 2 wt, wt V dt

0

1N
+
0 i=1

qi - vt(qi), qi - vt(qi) RD - 2 qi - vt(qi), wt(qi) RD

+ wt(qi), wt(qi) RD dt;

therefore the first variation of the functional is

E

 

E[v

+

w,

q]

=0

=

2

1 0

N

vt, wt V - 

qi - vt(qi), wt(qi) RD

i=1

dt.

By the reproducing property described in Corollary A.4 we have that

qi - vt(qi), wt RD = G(·, qi) qi - vt(qi) , wt(qi) V
11

for i = 1, . . . , N , so that

1N

E = 2

vt -  G(·, qi) qi - vt(qi) , wt dt.

0 i=1

V

Setting the E = 0 for all w  L2 [0, 1], V yields:

N
vt(x) =  qi(t) - vt qi(t) G x, qi(t) ,
i=1

t  [0, 1], x  RD

which is precisely of the form (2.5), having set i(t) =  qi(t) - vt qi(t) .

The momenta may be computed in the following manner.

Proposition 2.2. For a fixed q¯ =

q¯i : [0, 1]  RD

N i=1



Q

the

minimizer

with

respect to v  L2([0, 1], V ) of E[v, q¯] is

(2.9)

N
vt(x) = pi(t) G x, q¯i(t) ,
i=1

where the components of momenta (2.7) are given by:

(2.10)

p(k)(t) =

S q¯(t)

+

id 

-1

·

d dt

q¯(k)(t),

k = 1, . . . , D, where id is the N × N identity matrix.

In order to prove the above result we will need two lemmas.

Lemma 2.3. When the velocity field has the form (2.5), its squared norm

vt

2 V

at a given time t can be expressed as:

D

RD

Lvt(x), vt(x) RD dx =

(Tk)(t) S q(t)
k=1

(k)(t).

Proof. We are going to use some of the notation and terminology introduced in

Appendix A. When the velocity field in form (2.5), i.e. vt(x) =
12

N i=1

i

G(x,

qi)

,

we

have:

RD Lvt(x), vt(x) RD dx = vt(x), vt(x) V

NN

=

G(·, qi)i, G(·, qj)j V (=)

i, G(qi, qj)j RD

i,j=1

i,j=1

N

DN

D

= G(qi, qj) i, j RD =

G(qi, qj) i,kj,k =

(Tk) S(q) (k),

i,j=1

k=1 i,j=1

k=1

where in step () we have used Corollary A.4.

Lemma 2.4. When the velocity field has the form (2.5) the integrand of the smoothing term in energy (2.3) can be written as:

N i=1

qi(t) - vt qi(t)

2D
=
RD k=1

S q(t) (k)(t) - q(k)(t) T S q(t) (k)(t) - q(k)(t) .

Proof. We will write the components of the velocity field as vt = (vt1, . . . , vtD). Neglecting the time argument for notational compactness, we have that

N
vtk(x) = j,k G(x, qj),
j=1

whence

NN
vtk(qi) = j,k G(qi, qj) = Sijj,k,
j=1 j=1

so that we can write the N × 1 column vector q(k) - S(q)(k) as



q(k) - S(q)(k) = 

q1,k - q2,k -

qN,k -

N j=1

S1j j,k

N j=1

S2j j,k

...

  = 

N j=1

S

N

j

j,k

q1,k - vtk(q1) q2,k - vtk(q2)
... qN,k - vtk(qN )

  .

Therefore the integrand of the smoothing term in (2.3) can be expressed as:

N
qi - vt qi
i=1

2 DN
=
RD k=1 i=1

qi,k - vtk

qi

2D
=
k=1

q(k) - S(q) (k)

2 RN

=

D

S(q) (k) - q(k)

2 RN

=

D

S(q) (k) - q(k) T S(q) (k) - q(k) ,

k=1 k=1

which precisely is what we wanted to prove.

13

Proof of Proposition 2.2. We will omit the bar above the symbol q and some

arguments for notational compactness. For a velocity field of the type (2.5) Lem-

mas 2.3 and 2.4 imply that, for a velocity field of the type (2.5), the energy (2.3) can

be written in the form:

E[v, q] = 1 D (Tk)S(k) +  S(k) - q(k) T S(k) - q(k)
0 k=1

dt.

In fact, we will indicate the above functional with U [, q] since it is now a function

of the  coefficients and the landmark trajectories. Once again, we will be using

variational principles. For arbitrary functions (k), (k) : [0, 1]  RN×1, k = 1, . . . , D and any   R we have

U [ + , q] =

1D 0 k=1

(k) + (k) T S (k) + (k) + S (k) + (k) - q(k) T S (k) + (k) - q(k)

dt,

that is:

1D
U [ + , q] =
0 k=1

(Tk)S(k) + 2 (Tk)S(k) + 2(Tk)S(k)

+ S(k) - q(k) T S(k) - q(k) + 2 S(k) - q(k) T S(k) + 2(Tk)ST S(k)

dt.

Therefore the first variation of functional U with respect to  is given by:

U

 

U [

+

, q]

=0

=

2

1D 0 k=1

(Tk)S +  S(k) - q(k) T S

(k) dt,

which is equal to zero for any choice of functions (k), k = 1, . . . , D if and only if

(Tk)S +  S(k) - q(k) T S = 0,

k = 1, . . . , D.

Matrix S is positive definite, whence invertible, therefore the above equations are

equivalent to

(k) +  S(k) - q(k) = 0,

k = 1, . . . , D

which immediately yield:

(k) =

S

+

id 

-1q(k)

14

k = 1, . . . , D,

that are precisely equations (2.10).

2.2. Main result. It is convenient, at this point, to introduce the N ×N matrix:

R(q)

S(q)

+

id 

-1

where S(q) was defined in (2.8) and also the DN × DN , block-diagonal matrix

(2.11)



g(q)



R(q)
0 ...

0
R(q) ...

···
··· ...

0
0 ...



0 0 · · · R(q)



=



S(q) +
0 ...

id 

0

S(q)

+

id 

...

···
··· ...

-1

0
0 ...

 ,

0

0

···

S(q)

+

id 

where the N × N block R(q) is repeated exactly D times (the zeroes above repre-

sent N ×N blocks of zeroes); the choice of symbol g in the definition above is justified,

as we shall see in Theorem 2.7, by the fact that (2.11) is precisely the metric ten-

sor of Riemannian manifold I, and g is the classic symbol used for such tensor in

Differential Geometry. We will need the following technical result.

Lemma 2.5. Given two generic sets S and W, consider a function f : S ×W  R and assume that, for any fixed w¯  W, function f (s, w¯) has a unique minimizer with respect to s  S: we shall define h(w¯) arg minsS f (s, w¯). Under these hypotheses,

inf f (s, w) = inf f (h(w), w).

(s,w)S ×W

wW

Proof. Let 1 inf(s,w)S×W f (s, w) and 2 infwW f (h(w), w). It is obvious that 1  2: in fact we have that 2 = inf(s,w)graph(h) f (s, w)  1, since graph(h)  U × V . We now want to prove that 1  2. But if 1 < 2 then by the definition of 1 (a number µ is the infumum of a set T  R if: (a) for all x  T , we have x  ; (b) for any choice of µ > µ,  y  T such that y < µ ) there would exist a
15

pair (s, w)  S × W such that f (s, w) < 2. By the definition of h we would have f (h(w), w)  f (s, w) < 2, which is a contradiction of the definition of 2.
For a fixed pair of landmark sets I = {x1, . . . , xN } and I = {y1, . . . , yN } we can apply the above Lemma to sets
S = L2([0, 1], V ) and W = Q0 q  Q : q(0) = I, q(1) = I ,
and to function f = E[v, q]. Velocity v provided by expression (2.9) in Proposition 2.2 minimizes E[v, q¯] for a fixed trajectory q¯, so that v = h(q¯); in fact, with an abuse of notation, we shall write v = v(q¯). The following consequence holds.

Corollary 2.6. Fix landmark sets I = (x1, . . . , xN ) and I = (y1, . . . , yN ). For an arbitrary q¯  Q0 let velocity v = v(q¯) be the minimizer of E[v, q¯] provided by Proposition 2.2. Then the function d defined in (2.4) is such that

d(I, I )2

inf E v, q¯ = inf E v(q¯), q¯ .

(v,q¯)L2([0,1],V )×Q0

q¯Q0

If there exists a unique q  Q0 such that q = arg minq¯Q0 E v(q¯), q¯ then

arg min E v, q¯ = v(q), q ,
(v,q¯)L2([0,1],V )×Q0
where v(q) is the minimizer with respect to v of energy E[v, q], again provided by Proposition 2.2; under these conditions, d(I, I ) = E v(q), q .

Proof. First note that the square root and the "inf" can be exchanged since the square root is a monotone increasing function. The first part of the corollary follows directly from Lemma 2.5. If q = arg minq¯Q0 E[v(q¯), q¯] is well defined then infq¯Q0 E v(q¯), q¯ = E v(q), q , so that
v(q), q = arg inf E v, q¯
(v,q¯)L2([0,1],V )×Q0
and d(I, I ) = E v(q), q . Note that the above infimum is actually achieved by a pair in L2([0, 1], V ) × Q0, and therefore is a minimum.
16

Inserting v(q¯) into E[v, q¯] yields a new energy expression that only depends on q¯, which we shall indicate with E[q¯]. In fact, given the arbitrariness of the choice of trajectory q¯ from now on we will drop the bar above symbol q so that we can write:

E[q] E v(q), q , q  Q

where v(q) is the minimizer of E[v, q] with respect to v, given by Proposition 2.2. By the above corollary, d(I, I ) = infqQ0 E[q]. We are not ready to prove the main result of this chapter; a discussion will follow.

Theorem 2.7. For an arbitrary landmark trajectory q  Q it turns out that E[q] has the form:

(2.12)

1
E[q] = q(t)T g q(t) q(t) dt,
0

where q is the derivative of the DN × 1 column vector q defined by (2.6) and g is the DN × DN matrix defined by (2.11).

Proof. Let q  Q be an arbitrary set of landmark trajectories, and v(q) be the minimizer with respect to v of E[v, q], provided by Proposition 2.2. Applying Lemmas 2.3 and 2.4 to formula (2.9) rather than to formula (2.5) allows one to write:

E[q] = E[v(q), q]

=

1 1N
0 RD Lvt(x), vt(x) RD dx dt +  0 i=1

dqi dt

(t)

-

vt(qi(t))

2
dt
RD

=

1D
pT(k) S(q) p(k) dt + 

1D

S(q) p(k) - q(k) T S(q) p(k) - q(k)

0 k=1

0 k=1

= 1 D p(Tk) S(q) p(k) +  S(q) p(k) - q(k) T S(q) p(k) - q(k)
0 k=1

dt .

17

dt

Inserting the formula for the momenta p(k) =

S(q)+

id 

-1
q(k), provided by (2.10),

into the above expression yields3

E[q] =

1D 0 k=1

q(k) T

S

+

id 

-T
S

S

+

id 

-1q(k)

+

S

S

+

id 

-1q(k) - q(k)

T

S

S

+

id 

-1q(k) - q(k)

dt,

which we may rewrite as

(2.13)

E[q] =

1D 0 k=1

q(k) T

S

+

id 

-1
S

S

+

id 

-1

+

S

S

+

id 

-1 T
- id

S

S

+

id 

-1
- id

q(k) dt.

It is the case that

id - S

S

+

id 

-1

·

S

+

id 

=

S

+

id 

- S  = id,

whence

id - S

S

+

id 

-1

=

1 

S

+

id 

-1
.

Inserting the above expression into (2.13) yields:

E[q] = = =

1D
0 k=1 1D
0 k=1 1D
0 k=1

q(k) T q(k) T q(k) T

S

+

id 

-1
S

S

+

id 

-1
+

1 

S

+

id 

-1

S

+

id 

-1

q(k) dt

S

+

id 

-1

S+

id 

S

+

id 

-1q(k) dt

S

+

id 

-1q(k) dt =

1
qT g(q) q dt ,
0

which is precisely the statement of the theorem.

3We are using the notation A-T

A-1 T ; if A is symmetric then A-T = A-1.
18

2.3. Discussion. First and foremost, since matrix g : RDN  RDN×DN is positive definite for any landmark set we have that expression (2.12) provides a Riemannian energy function [11, 23, 27]. Therefore the set of landmarks I is endowed with a Riemannian structure, where g is the metric tensor, geodesic curves are the extrema of energy functional (2.12), and the geodesic distance between two shapes I, I  I is given by d(I, I ) = infqQ0 E[q], where Q0 = q  Q : q(0) = I, q(1) = I . Note that the (infinite-dimensional) diffeomorphism group GV and its Lie algebra V have formally "disappeared" from the energy, their information being incorporated into the metric tensor of the Riemannian shape manifold I, of finite dimension n = DN ; the metric tensor in fact depends on the kernel G of space V , and on smoothing parameter . In following chapters we will investigate the geometry of the Riemannian structure of I, namely its curvature.
Since metric tensor g is block diagonal with D blocks and the DN × 1 vector q can be partitioned in precisely the D vectors of the components of the landmarks set, at a first look it may seem that the D dimensions of q could be treated in an independent manner from one another, i.e. that we could split enargy (2.12) into D "uncoupled" integrals

D
E~[q] =
k=1

1 0

q(k) T

S(q)

+

id 

-1q(k) dt,

and minimize them separately. In fact (while the above formula is correct) this is

not the case since all the components appear in the argument of matrix S(q) =

G(qi,

qj)

+

ij 

1i,jN .

We should note that for small values of parameter  the metric tensor g gets

close (up to a multiplicative constant) to the DN × DN identity matrix, i.e. the

diagonal elements become far larger than the off-diagonal elements, and they are all

approximately given by 1/. This means that the metric converges to the Euclidean

metric in RDN for   0 and the geodesic curves converge to straight lines, as we

anticipated at the end of section 1 of this chapter.

19

It is well known from the theory of Riemannian manifolds that energies of the type (2.12) may not have a unique minimizer. However, if such length-minimizing geodesic path q exists and is numerically computable, by Corollary 2.6 one can also compute the "other half" of the minimizer of energy (2.3), i.e. the velocity field v such that (v, q) = arg minv,q E[v, q] by applying formula (2.9) of Proposition 2.2 to trajectory q. Consequently, one can also (numerically) compute the corresponding diffeomorphism v by implementing the system of ordinary differential equations (2.2).
Last, but not least we should remark that the Lagrangian function that corresponds to energy (2.12) is:

(2.14)

L(q, q)

=

1 2

qT

S(q)q

=

1 2

D

q( ) T

S(q)

+

id 

-1q( );

=1

it is easy to see that the momenta, which we defined as the coefficients of the velocity

field of the form (2.5) that minimizes energy E[v, q] with respect to v, actually coincide

with the momenta of landmark points in the sense of classical mechanics [2]. In fact in

the

Hamiltonian

formalism

the

momenta

are

defined

as

pi,k

=

L qi,k

(q

,

q),

i

=

1, . . . , N ,

k

= 1, . . . , D;

that is,

in vector notation, p(k)

=

,L
q(k)

k

=

1, . . . , D.

Applying such

definition to (2.14) yields

p(k) =

S(q)

+

id 

-1q(k),

k = 1, . . . , D

which coincide with equations (2.10) of Proposition 2.2. Whence the use of the term momenta is justified. Chapter 3 is dedicated to momenta for landmarks, Hamilton's equations (cogeodesic flow), and conservation laws.

3. Numerical Examples
In this section we briefly illustrate the qualitative behavior of geodesics connecting pairs of landmark shapes I = (x1, . . . , xN ) and I = (y1, . . . , yN ) on the plane (D = 2). In the figures that follow black dots and circles are, respectively, the initial and final
20

0.8
0.6
0.4
0.2
0
-0.2
-0.4
-0.6
-0.8 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8
Figure 2.1. Geodesic curve for landmarks traveling in opposite directions; black dots and circles represent initial and final positions, respectively. The corresponding diffeomorphism 0v1 is also shown.
landmark sets I and I ; the curves represent, in principle4, the length minimizing (2N -dimensional) geodesic between the initial and final configurations. In each of the figures that follow the diffeomorphism 0v1 (induced by the velocity (2.9) that corresponds to the depicted landmark trajectories) is also shown. In all the examples smoothing parameter  is set to a high (but finite) value.
Figure 2.1 shows a case with N = 2 where one landmark must travel from the left to the right and the other must do the opposite. The qualitative behavior of the geodesic q(t) = q1(t), q2(t) , t  [0, 1] is such that the two arcs "repel" each other: in fact if the two landmarks traveled too close to each other the vertical derivative of the horizontal component of the velocity field vt(x) would be large in a neighborhood
4The curves were computed a conjugate gradient [6, 39] descent algorithm on the energy for fixed boundary conditions and it may well be the case that the curves are, in fact, points of local minimum of the functional. An alternative method for solving the boundary value problem is the geodesic shooting method [35], which we did not implement here.
21

0.8 0.6 0.4 0.2
0 -0.2 -0.4 -0.6 -0.8
-0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1
Figure 2.2. Geodesic curve for landmarks traveling in the same direction; black dots and circles represent initial and final positions, respectively. The corresponding diffeomorphism 0v1 is also shown.

of

the

origin

x

=

(0, 0)

and

time

t

=

1 2

,

thus

giving

a

strong

contribution

to

the

second

term

1 0

R2

2 =1

vt (x)

2 R2

dx

dt

of

the

Sobolev

norm5

of

the

velocity.

On the other hand, the opposite happens when the two landmarks must travel

in the same direction, as shown in Figure 2.2: the two arcs of the geodesic "attract"

each other. The two landmarks tend to "carpool", i.e. to use a velocity field with the

smallest possible support in order to minimize the first term

1 0

R2

2 =1

|vt

(x)|2

dx

dt

of the Sobolev norm of the velocity field.

Finally, Figure 2.3 depicts a somewhat more complex situation where four corners

of a square are moved (in this case, N = 4). We shall limit ourselves to note that

the shape of the four arcs of the (8-dimensional) geodesic curve are mostly deter-

mined by the fact that the bottom-right landmark must take the longest journey in a

unit of time, whence traveling the fastest and causing the top-right and bottom-left

landmarks to initially "pull away" from it. This sudden evasive maneuver causes the

5See footnote 1.

22

0.02 0.015
0.01 0.005
0 -0.005
-0.01 -0.015
-0.02 -0.025
-0.02 -0.015 -0.01 -0.005 0 0.005 0.01 0.015 0.02
Figure 2.3. Deformation of a square; black dots and circles represent initial and final positions, respectively. The corresponding diffeomorphism v01 is also shown.
remaining (top-left) landmark to initially travel towards the center of the square, but eventually turning back so to be able to reach its designed destination.

4. More on Kernels

The Green's function of differential operator L = (id - a2)k in RD has the form G(x, y) =  ||x - y||RD , with  : (0, )  R given by the bell-shaped function [20]:

(2.15)

(

)=

2k

(k

-

1)!

(2a)k+

D 2

Kk-

D 2

k-

D 2

a,

where K is a modified Bessel function [1, Ch. 9];  can be extended to 0 by continuity. Such functions are referred to as Bessel kernels or Sobolev kernels (since they are the inverse of the differential operators that define the Sobolev norms). One can prove (see Appendix B) that (2.15) is a solution to the ordinary differential equation

(2.16)



=

2 - 1 

+

1 a2



,

23

where



=

k

-

D 2

,

with

the

appropriate

choice

of

boundary

conditions

that

can

be

directly derived from (2.15); Propositions B.4 and B.5 describe the behavior of ( )

in a neighborhood of zero.

We should however note that the whole theory we have presented so far would still

hold if, instead of starting from an admissible Hilbert space V of the Sobolev kind and

then building its kernel G (as the Green's function of the differential operator L that

defines the norm on V ), we started from a generic continuous, positive definite scalar

kernel G  L2 RD × RD, R ; the Mercer-Hilbert-Schmidt theorem [40, 45, 47] would

then allow us to reconstruct the Hilbert space V (which, in general, will not be of the

Sobolev kind) that has G as its reproducing kernel, i.e. such that G(·, x), v V = , v(x) RD for any point x  RD, vector   RD, and function v  V (as it is the case for kernels for Sobolev-type admissible Hilbert spaces, see Corollary A.4).

The energy to be minimized with respect to v  L2 [0, 1], V and q  Q (with the

appropriate boundary conditions) would the general form:

E[v, q]

1 1N

vt

2 V

dt + 

0 0 i=1

dqi dt

(t)

-

vt

qi(t)

2
dt,
RD

which of course coincides with (2.3) when the norm on space V is of the Sobolev

type (2.1). Proposition 2.2 and Theorem 2.7 would still hold. The discussion on how

to construct an admissible space from a kernel goes well beyond the scope of this

introductory chapter, and the reader is referred to [47] for further details. However,

in the future we will use functions  not given by (2.15) but that are of a form which

is easier to manipulate both analytically and numerically, such as Gaussians

(2.17)

( ) =  1 exp 22

2
- 22 },

or heavy-tailed Cauchy-type functions

(2.18)

(

)

=

1

1 + a2

2.

We will see in Chapter 5 that the Riemannian curvature tensor and sectional

curvature for the landmarks manifold can be expresses in terms of function  and its

first and second derivatives  and  ; therefore, for a specific choice of the kernel,

24

from a computational point of view it is convenient to know how  and its derivatives

are related to each other. In the case of kernels of the Sobolev form, i.e. deriving from

an admissible Hilbert space with norm (2.1), such relationship is precisely provided

by (2.16); in the case of Gaussian type kernels (2.17) the first and second derivatives

are related to  simply by

(2.19)

 ( ) = -2 ( )

and



(

)=

1 2

2 - 1

( ),

respectively; on the other hand, in the case of Cauchy kernels (2.18) it is easy to get

equations

(2.20)

 ( ) = -2a2 2( ) and  ( ) = 8a4 23( ) - 2a22( ).

We will use these relationships later on in Chapter 5.

5. Further Generalizations
In this final section we shall briefly illustrate how the theory of landmark manifolds that we have presented so far may be thought of as a particular case of a more general approach to shape analysis, based on Lie groups of diffeomorphisms acting on shape manifolds. Such general approach is presented in [36, 47] and here we shall limit ourselves to summarizing it, noting that it is applicable to landmarks, images, planar curves, surfaces, and currents [17].
5.1. Extensions to generic Shapes. Given a manifold I of "objects" (e.g. landmark configurations, images, curves, etc.) consider a Lie group G that acts on I, i.e. a map G × I  I : (g, I)  g · I. The group also acts on A = G × I by the operation G × A  A : (g, (h, I))  (gh, g · I). Assuming we are given a left-invariant distance D(·, ·) on A (i.e. D(g·a, g·a ) = D(a, a ), for all a, a  A and g  G) this induces a (pseudo-)distance on I by defining: d(I, I ) = inf D (g, I), (g, I ) : g, g  G .
This simple idea can be applied to groups G of diffeomorphisms RD  RD (with group operation  =   ) acting on shape manifolds I, such as sets of D-dimensional landmarks or images (described as scalar functions I : RD  R, with D = 2). In fact we can construct a left-invariant metric ·, · (g,I) on A = G × I, that
25

keeps into account both the magnitude of the diffeomorphism generated by vector fields on G and variations in the structure of objects in I. There are several advantages in designing a left-invariant metric on G × A (and not just on G): for example,

the resulting distance d on I is tolerant to small group actions, so that object variations due to "noise" are neglected; also, we shall see later that in the case of image matching the approach allows to variations in the image values themselves, and not just in the geometry via a diffeomorphism of the domain. We should also note that, from a purely mathematical point of view, left-invariance is a conditio sine qua non

for d to be a distance on I.

The energy of a smooth path a : [0, 1]  A : t  at = (gt, It), is

E[a] =

1 0

dat dt

2
dt =
at

1 0

dgt dt

,

dIt dt

2
dt ;
(gt,It)

it turns out that since the metric ·, · (g,I) was constructed to be left-invariant, the geodesic distance on A: D(b, b ) = E[a] : a(0) = b, a(1) = b is left-invariant with respect to G actions. By the simple construction above, we have that d(I, I ) =

inf D (g, I), (g, I ) : g, g  G is in fact a distance on I. Using the left-invariance of the metric it is often convenient to rewrite the above energy as follows:

(2.21)

1
E[a] =
0
1
=
0
1
=
0

Lgt-1 

dgt dt

,

dIt dt

2
dt
gt-1gt, Lgt-1 (It)

dgt dt



gt-1,

Lgt-1

dIt  dt

2
dt
e, gt-1·It

vt,

d dt

gs-1 · It

s=t

2
dt =: E[v, J],
(e,Jt)

where

we

have

set

vt

:=

dgt dt

 gt-1



TeG

and

Jt

:=

gt-1 · It



I

(we

have

indicated

with L both the left action on G × I and on I, and with (L) the corresponding

pushforward map [28] on the corresponding tangent spaces). It turns out that the

pair of functions (gt, It) is uniquely determined by (vt, Jt), whence with an abuse of notation we can indicate the above energy as E[v, J]. The induced distance on I is

d(I, I ) = inf E[v, J] : vt  TeG, J0 = I, J1 = I . We will now illustrate how this general approach applies to the manifold of images and the manifold of landmarks.

26

5.2. Examples. Depending on how the object space I is defined, on how the diffeomorphism group G acts on it and on how the left-invariant metric on A = G × I is constructed, the energy (to be minimized) takes different forms. For example, first assume that manifold I is the set of scalar images I : [0, 1]2  R, that G is a group of diffeomorphisms on [0, 1]2 (that leave the boundary unchanged), and that the group action is given by composition: g · I = I  g. Let V be the Lie algebra TeG of Lie group G; we will assume that V is an admissible Hilbert space (which is obviously also a constraint on the group of diffeomorphisms G that V generates). If the left-invariant metric is such that

(2.22)

(v, )

2 (e,I )

=

v

2 V

+

||2 dx
[0,1]2

for all I  I, v  V = TeG  C(R2, R2), and   TII, then energy (2.21) takes the

form

E[v, J] =

1 0

vt

2 V

dt

+



1 0

[0,1]2

Jt t

+

xJ, vt

2
dx dt,

which in the case of a Sobolev-type admissible Hilbert space V looks like:

E[v, J] =

1 0

[0,1]2

Lvt(x), vt(x) R2 dx dt + 

1 0

[0,1]2

Jt t

+

xJ, vt

2
dx dt.

Note that the integrand in the second term on the right-hand side is the well-known optical flow constraint equation [19], or transport equation for J, so that the first integral penalizes large variations due to the diffeomorphism of the domain, while the second one penalizes violations of the optical flow constraint equation, i.e. variations of pixel intensity along the flow. This also allows for matching two images with different luminance values. The induced distance on I between two images I and I is given by d(I, I ) = inf E[v, J] : vt  TeG, J0 = I, J1 = I .
Assume now that I is the space of landmark points, that is, the generic element is given by I = (x1, x2, . . . , xN ), xi  RD, with xi = xj for i = j. If G is a group of diffeomorphisms RD  RD that leave the point at infinity unchanged, the group action is g · I = g-1(I) = (g-1(x1), . . . , g-1(xN )) and the left-invariant metric is such
27

that

N

(v, )

2 (e,I )

=

v

2 V

+

xi

2 RD

i=1

for all I  I, v  V = TeG  C(RD, RD), and   TII = RDN , then energy (2.21)

takes the form

E[v, q] =

1 1N
0 RD Lvt(x), vt(x) RD dx dt +  0 i=1

dqi dt

(t)

-

vt(qi(t))

2 Rd

dt,

where we have assumed that the admissible Hilbert space is of the Sobolev type;

in the above equation we have indicated with q(t) = (q1(t), . . . , qN (t)) the set Jt = gt-1 · It = gt(x1(t)), . . . , gt(xN (t)) . Once again, the induced distance on I is given by d(I, I ) = inf E[v, q] : vt  TeG, q(0) = I, q(1) = I . Incidentally, note that the above energy coincides with (2.3) and the induced distance d(I, I ) coincides

with (2.4); that is, this was precisely our starting point at the beginning of this

chapter.

28

CHAPTER 3
Momenta and Conservation Laws
In this chapter we will explore the structure of Hamilton's equations for the Riemannian manifold of landmarks and discuss the corresponding conserved quantities.

1. Hamilton's equations

1.1. Generalities. It is well known from the theories of classical mechanics and variational calculus [2, 4, 37] that for a system with n degrees of freedom the n second order Euler-Lagrange equations for an energy of the type

namely

1
F [q] = L(q, q) dt,
0

(3.1)

d dt

L qi

-

L qi

=

0

i = 1, . . . , n,

are equivalent to 2n first order differential equations, known as Hamilton's equations, where the variables are positions q = (q1, . . . , qn)  Rn and momenta p = (p1, . . . , pn)  Rn. The momenta are in fact defined as the variables

pi

=

L qi

(q,

q),

i = 1, . . . , n;

if the determinant of matrix

L qiqj

n i,j=1

is

nonzero

then

the

above

system

of

equations

is (locally) invertible and we can write qi = qi(p, q), i = 1, . . . , n, or just q = q(p, q)

in a more compact notation. The Hamiltonian is the scalar function

H(p, q)

n

pi qi - L(q, q)

;

i=1 q=q(p,q)

29

as anticipated above, the Euler-Lagrange equations (3.1) turn out to be are equivalent to Hamilton's Equations:

qi

=

H pi

(p,

q),

pi

=

-

H qi

(p,

q).

The flow determined by Hamilton's equations is known as the cogeodesic flow [23].

The Hamiltonian function is always an integral of motion, i.e. it is conserved along

the cogeodesic flow, since

d dt

H(p,

q)

=

n

i=1

H pi

pi

+

H qi

qi

n
=
i=1

-

H pi

H qi

+

H qi

H pi

 0.

This approach is very convenient when the variables live on a Riemannian man-

ifold M with metric tensor g(·), since in this case the Lagrangian and Hamiltonian

functions have a particularly simple form. In fact the Lagrangian is given by:

L(q, q) =

1 2

qT

g(q)q

=

1 2

N

gij(q) qi qj;

i,j=1

momenta are scalar variables

(3.2)

pi

=

L qi

=

n

gij(q) qj,

i = 1, . . . , n,

i=1

i.e. p = g(q)q in vector form,

and the Hamiltonian function is

(3.3)

H(p, q) =

1 2

pT

g(q)-1p

=

1 2

N

gij(q) pi pj

i,j=1

where we have indicated with gij, i, j = 1, . . . , n the elements of the inverse of the

metric tensor, g(q)-1, also known as the cometric tensor ; in other words, it is such

that

n j=1

gij

(q)

gjk

(q)

=

ki

(Krnonecker's

symbol).

Hamilton's

equations

are

(3.4) (3.5)

qi

=

H pi

=

n
gij(q) pj
j=1

pi

=

-

H qi

=

1 2

n

gjk qi

(q)

pj

pk

j,k=1

30

for i = 1, . . . , n. Note that equation (3.5) is in fact equivalent to definition (3.2). The geodesic flow on the tangent bundle T M is obtained from the cogeodesic flow by the first of Hamilton's equations. Being the Hamiltonian an integral of motion the cogeodesic flow maps the set Ec (q, p)  T M : H(p, q) = c onto itself for c  0, so that the cotangent bundle T M is partitioned into the level sets Ec, c  0. In the following we will compute Hamilton's equations in the case of the Riemannian manifold of landmarks and explore the corresponding conservation laws.

1.2. The landmarks manifold case. The metric tensor (2.11) of the Riemannian manifold of landmarks is, in fact, the inverse of a matrix (whose non-zero elements are given by the Green's function of a differential operator) which makes the Hamiltonian approach especially convenient since the Hamiltonian function itself (3.3) is expressed in terms of the cometric tensor. A slight complication comes from to the fact that the variables qi,k introduced in Chapter 2 have in fact two indices, i = 1, . . . , N and k = 1, . . . , D, the former indicating the landmark label while the latter refers to the dimensional component of the single landmark; the dimension of the Riemannian manifold I is n = DN .
Equation (2.10) of Chapter 2 can be rewritten as

q(k)(t) =

S

q(t)

+

id 

p(k)(t),

k = 1, . . . , D

so that (omitting the time argument) the single components are

(3.6)

N
qi,k =

G(qi,

qj)

+

ij 

pj,k ,

j=1

i = 1, . . . , N, k = 1, . . . , D;

they can also be expressed in the convenient compact form

(3.7)

N
qi =

G(qi,

qj)

+

ij 

pj ,

j=1

i = 1, . . . , N,

where both the left-hand and the right-hand sides are 1 × D row vectors. Before

proceeding to the derivation of the second set of equations (3.5) we will introduce

some useful notation.

31

Given the block-diagonal nature of the DN ×DN metric tensor g, defined in (2.11), it is convenient to write its generic element as giajb, with i, j = 1, . . . , N and a, b = 1, . . . , D, where:

i = row index within a N × N block; j = column index within a N × N block;

a = index of row block; b = index of column block.

For example, with the above convention in the simple case N = 3, D = 2 the elements

of a tensor q would be ordered as follows:

(3.8)



g

=



g1111 g2111 g3111 g1211 g2211

g3211

g1121 g2121 g3121 g1221 g2221 g3221

g1131 g2131 g3131 g1231 g2231 g3231

g1112 g2112 g3112 g1212 g2212 g3212

g1122 g2122 g3122 g1222 g2222 g3222



g1132 g2132 g3132 g1232 g2232

 .

g3232

In general, by Theorem 2.7 the metric tensor for the landmarks manifold is

g(q) = diag R(q), . . . , R(q)
D times

where R(q) is the N × N matrix

S(q)

+

id 

-1

(so that

in the above example only

the two 3 × 3 diagonal blocks of matrix (3.8) would be non-zero). Therefore, if we

indicate the generic element of R(q) with with Rij(q), i, j = 1, . . . N , we have that the elements of metric tensor g can be expressed as

giajb(q) = Rij(q) ab , i, j = 1, . . . , N, a, b = 1, . . . , D
where ab is Kronecker's delta. We can employ analogous notational conventions for the inverse of the metric tensor, namely the elements of g(q)-1 can be written as

giajb(q) = Rij(q) ab ,

i, j = 1, . . . , N, a, b = 1, . . . , D,
32

where

Rij (q)

is

the

generic

element

of

the

inverse

of

R(q).

Since

R(q)-1

=

S(q) +

id 

we

have

that

Rij (q)

=

G(qi, qj)

+

ij 

,

so

that

the

cometric

tensor

becomes:

giajb(q) =

G(qi,

qj)

+

ij 

ab ,

i, j = 1, . . . , N, a, b = 1, . . . , D.

With this notation we may rewrite the first set of differential equations (3.6) as

ND

qi,a =

giajb(q) pj,b ,

j=1 b=1

i = 1, . . . , N, a = 1, . . . , D,

which are formally consistent with (3.4), so that (3.6) are precisely the first set of Hamilton's equations, with n = DN .
The notation introduced above will be especially useful in the computation of curvature for landmarks manifolds, which will be done in Chapter 5. In any case we have that the Hamiltonian function of the system can be expressed as:

H(p, q) =

1 2

pT

g(q)-1p

=

1 2

N

D
giajb(q) pi,a pj,b

i,j=1 a,b=1

=

1 2

N

D

G(qi,

qj)

+

id 

ab pi,a pj,b

=

1 2

N

D

i,j=1 a,b=1

i,j=1 a=1

G(qi,

qj)

+

ij 

pi,a pj,a ,

that is:

(3.9)

H(p, q)

=

1 2

N

G(qi,

qj)

+

ij 

i,j=1

pi, pj RD .

Note that G : RD × RD  R : (, )  G(, ), the chosen Green's function (i.e. the kernel of space V ), is a function of 2D real arguments:

G(, ) = G 1, 2, . . . , D, 1, 2, . . . , D ;

from

now

on

we

shall

indicate

with

G 

its

derivative

with

respect

to

the

th component

of vector   RD. Also, we will indicate with G : RD × RD  RD the row vector:

G(, ) =

G 1

(,

)

G 2

(,

)

···

33

G D

(

,

)

.

As we said in Chapter 2, Green's function G is of the form G(, ) =  || - ||RD , for some  : [0, )  R; if this is the case, then:

(3.10)

G 

(,

)

=



|| - ||RD

 - || - ||RD

,

= 1, . . . , D.

We now have all the machinery to state and prove the following result.

Proposition 3.1. The DN first order ordinary differential equations hold:

(3.11)

N
pi,k = -

G k

(qi,

qj

)

pi, pj

RD ,

j=1

i = 1, . . . , N, k = 1, . . . , D.

Therefore Hamilton's equations for the Riemannian manifold of landmarks are

(3.12)

  qi =

N

G(qi,

qj)

+

ij 

pj

j=1

 pi

=

N
- G(qi, qj) pi, pj RD

j=1

i = 1, . . . , N.

Proof. The first of equations (3.12) is simply given by (3.7), which derives directly from the definition of momenta. The second of Hamilton's equations is:

pi,k

=

-

H qi,k

(p,

q)

=

-

1 2

N

 qi,k

G(qj, q

)

+

id 

j, =1

=

N
-

G k

(qi,

qj

)

pi pj

RD

j=1

pj p RD

for i = 1, . . . , N and k = 1, . . . , D, which coincides with (3.11). Such equations can be written in the compact form given by the second of equations (3.12).

2. Conservation laws
As we mentioned above the flow determined by equations (3.12) is called the cogeodesic flow: the geodesic flow on the manifold I is determined by the solutions qi(·), i = 1, . . . , N of the above equations. The Hamiltonian function is constant along the solutions of (3.12), so that the cogeodesic flow partitions the cotangent bundle into the level sets of H(p, q).
34

The structure of the system of equations (3.12) is such that, in fact, other

quantities are conserved along the flow. Before describing such integrals of mo-

tion we will quickly introduce some more notation. If pi(·), qi(·) , i = 1, . . . , N

are solutions of (3.12), let t : RD  RD be the time-dependent diffeomor-

phism t()

0vt() induced by velocity field vt() =

N i=1

pi(t)

G

, qi(t)

, t  [0, 1],

  RD. We will denote the components of such diffeomorphism and the velocity field

as t() = t1(), . . . , tD() and vt() = vt1(), . . . , vtD() , respectively. Let Dt be the Jacobian matrix of the diffeomorphism, i.e.

(3.13)

Dt()



1t



1 t2 1
...

1t 2

···

t2 2

···

... . . .



1t

D t2 D
...

 .

· · ·Dt
1

Dt 2

Dt D

Note that D0() = id (the D × D identity matrix) for all   RD, since 0() = . The following important result holds.

Proposition 3.2 (Strong Conservation Law). Assume  =  (exact matching problem). Then it is the case that

(3.14)

D

pi,k(t)

tk 

qi(0)

= pi, (0),

k=1

i = 1, . . . , N, = 1, . . . , D

for all t  [0, 1], which may be written in terms of (row) vector and matrix multiplication, as1

(3.15)

pi(t) · Dt qi(0) = pi(0), i = 1, . . . , N

for all t  [0, 1].
1In differential-geometric, coordinate-free notation the conservation law (3.15) may be written as t qi(0) pi(t) = pi(0), where the upper star denotes the pullback map [28] applied to cotangent vector pi(t)  Tqi(t)I.
35

Proof. Since D0 = id the proposition holds for t = 0. We claim that the time derivative of the left-hand side of (3.14) is zero. In fact,

(3.16)

d dt

D

pi,k(t)

tk 

qi(0)

k=1

D
=

pi,k(t)

kt 

qi(0)

+

pi,k(t)

 

tk t

qi(0)

k=1

;

we now want to compute the last term on the right-hand side of the above expression.

Since t(·) is the diffeomorphism induced by the velocity field vt(·) we have that

tk t

()

=

vtk

t()

, k = 1, . . . , D, for all   RD.

Whence by the chain rule

 

kt t

(

)

=

 

vtk t()

=

D

vtk m

t()

tm 

(

),

m=1

  RD.

since vtk(x) =

N j=1

pj,k(t)

G

x, qj(t)

,

x

 RD,

the

above

expression

becomes

 

kt t

()

=

D

N

pj,k(t)

G m

t(), qj(t)

mt 

(

),

m=1 j=1

  RD.

In the case of exact matching t qi(0) = qi(t), so for  = qi(0) we get:

(3.17)

 

kt t

qi(0)

=

D

N

pj,k(t)

G m

qi(t), qj(t)

mt 

qi(0) .

m=1 j=1

On the other hand, by Proposition 3.1,

(3.18)

pi,k(t)

=

D
-
m=1

N j=1

G k

qi(t), qj(t)

pi,m(t) pj,m(t),

for i = 1, . . . , N and k = 1, . . . , D. Inserting equations (3.17) and (3.18) into expression (3.16) finally yields:

d dt

D

pi,k(t)

tk 

qi(0)

k=1

D
=
k=1

D
-

N

G k

qi(t), qj(t)

pi,m(t)

pj,m(t)

kt 

qi(0)

m=1 j=1

D
+ pi,k(t)

N

pj,k(t)

G m

qi(t), qj(t)

tm 

qi(0)

m=1 j=1

 0,

where we have implicitly relabeled some summation indices.

36

Since t is a diffeomorphism for all time t  [0, 1] we have that its Jacobian matrix Dt is invertible for all t, which immediately implies the following result.
Corollary 3.3. Assume  = . If pi(0) = 0 for some index (landmark) i  {1, . . . , N }, then the corresponding momentum is such that pi(t)  0 for all t  [0, 1].
We should also note the strong conservation law for momenta and the system of differential equations (3.12) are, in fact, equivalent; more precisely, the following proposition holds.

Proposition 3.4. Assume  = . If differential equations (3.7), which are equivalent to the definition of momenta, and conservation laws (3.15) hold for all t  [0, 1], then so do differential equations (3.11).

Proof. Differentiating equations (3.14) with respect to time yields:

0

=

d dt

D

pi,k(t)

tk 

qi(0)

k=1

=

D

pi,k(t)

tk 

qi(0)

+

pi,k(t)

 

kt t

qi(0)

k=1

,

i = 1, . . . , N, = 1, . . . , D.

Inserting equation (3.17) from the proof of Proposition 3.2 into the right-hand side of the above expression yields the equations:

D

pi,k(t)

kt 

qi(0)

D
= - pi,k(t)

D

N

pj,k(t)

G m

qi(t), qj(t)

tm 

qi(0)

k=1 k=1 m=1 j=1

D
=-

N

pi(t), pj(t)

RD

G m

qi(t), qj(t)

tm 

qi(0)

m=1 j=1

for i = 1, . . . , N and

= 1, . . . , D.

Indicating

with

t 

the

-th column of Jacobian

matrix (3.13) the above equations may be written in terms of vector multiplications:

pi(t)

·

t 

qi(0)

=-

N

pi(t), pj(t) RD G qi(t), qj(t)

·

t 

qi(0) ,

j=1

37

which again hold for i = 1, . . . , N and = 1, . . . , D. Whence:

N

pi(t) · Dt qi(0) = -

pi(t), pj(t) RD G qi(t), qj(t) · Dt qi(0) ,

j=1

for i = 1, . . . , N ; such equations imply the second set of (3.12), and whence (3.11),

by the invertibility of the Jacobian matrix Dt qi(0) .

At this point one could employ Emmy Noether's Theorem [2, 4, 37] and use the symmetries of the metric tensor (specifically, translation- and rotation-invariance) to prove the conservation of linear momentum and angular momentum. We will prove such conservation laws directly, simply by manipulating differential equations (3.12) and the general form of the kernel G and its partial derivatives (3.10).

Proposition 3.5 (Conservation of Linear Momentum, or First Weak Conserva-

tion Law). For any choice of smoothing parameter , the quantity

(3.19)

P (p)

N
pi ,
i=1

which is a D-dimensional vector, is conserved in time.

Proof. Summing the set of equations (3.11) over index i yields:

(3.20)

N
pi,k

=

N
-

G k

(qi,

qj

)

pi, pj

RD

i=1 i,j=1

=

N
-

G k

(qi

,

qi)

pi

2 RD

-

N

N

G k

(q

i,

qj

)

pi, pj

RD .

i=1 i=1 j=1

j=i

for any k = 1, . . . , D.

Since

G k

(x,

x)

=

0

for

all

x



RD

the

first

summation

in the above expression is identically equal to zero. On the other hand, by (3.10)

we

have

that

G k

(x,

y)

=

-

G k

(y,

x)

for

all

x, y



RD

with

x

=

y,

therefore

the

second summation in (3.20) is also zero since all the terms are pairwise opposite. In

conclusion,

N i=1

pi,k



0,

so

that

NN
pi,k(t) = pi,k(0),
i=1 i=1

k = 1, . . . , D, t  [0, 1].

Writing the above equalities in vector form proves the proposition.

38

Proposition 3.6 (Conservation of Angular Momentum, or Second Weak Conser-

vation Law). For any choice of smoothing parameter , if D  2 the scalar quantities

(3.21)

Lab(p, q)

N
qi,api,b - qi,bpi,a = q(a), p(b) RN - q(b), p(a) RN ,
i=1

defined for a, b = 1, . . . , D, with a < b, are conserved in time.

Proof.

Let

Rij (q)

=

G(qi,

q

j

)

+

ij 

.

Differentiating

(3.21) and

using

(3.12)

yields:

d dt

Lab

=

N

i=1

qi,api,b - qi,bpi,a + qi,api,b - qi,bpi,a

N
=
i=1

N
Rij pj,api,b - pj,bpi,a + qi,api,b - qi,bpi,a
j=1

N
=
i=1

qi,api,b - qi,bpi,a ,

where we have used the symmetry of Rij. Whence

d dt

Lab

=

N

qi,a

N

G b

(qi,

qj

)

pi, pj

RD

- qi,b

N

G a

(qi,

qj

)

pi, pj

RD

i=1 j=1

j=1

=

N

pi, pj RD

qi,a

G b

(q

i,

qj

)

-

qi,b

G a

(qi,

qj

)

,

i,j=1

and by (3.10):

d dt

Lab

=

N pi, pj RD
i,j=1

qi - qj RD qi - qj RD

qi,a qi,b - qj,b - qi,b qi,a - qj,a

=

N pi, pj RD
i,j=1

qi - qj RD qi - qj RD

- qi,aqj,b + qi,bqj,a ,

which is identically equal to zero by the symmetries of the first two factors.

Note that the linear momentum and angular momentum conservation laws consist,

respectively,

of

D

and

D(D-1) 2

scalar

conservation

laws;

taking

into

the

account

the

fact that the Hamiltonian (which is a scalar) is also conserved, the cogeodesic flow,

i.e.

the

dynamics

of

(p,

q),

takes

place

on

a

space

of

dimension

2DN

-

1

-

D

-

D(D-1) 2

.

39

CHAPTER 4
Curvature in terms of the Cometric Tensor
In this chapter we compute a formula for the Riemannian curvature tensor and the sectional curvature for a generic n-dimensional Riemannian manifold M in terms of the elements of the cometric tensor (i.e. the inverse of metric tensor); also, we will show how sectional curvature can be written as a ratio of quadratic forms on the space of alternating 2-forms on TpM, which may also be expressed in terms of the cometric. An accessible text on alternating forms is [21]. Classic references for differential geometry are, for example, [11] and [27] (we shall use the notation introduced in the latter); a modern, more advanced text on the topic is [23].

1. Motivation

We saw in Chapter 2 that when shape is modeled as a labeled N -tuple of land-

marks in D dimensions the corresponding metric tensor, when written as a ma-

trix g, turns out to be the inverse of a positive definite matrix: that is, we may

-1

write g(q) =

diag

S(q)

+

id 

,

.

.

.

,

S

(q)

+

id 

, where the elements of S(q) are

computed by evaluating a given Green's function at different locations.

Under these circumstances calculating sectional curvature in the traditional way,

i.e. by computing Christoffel symbols and their partial derivatives, turns out to be

a formidable task since it involves computing successive derivatives of the inverse of

a tensor. Therefore it would be convenient to have access to a formula expressing

sectional curvature (and, more in general, the Riemannian curvature tensor) in terms

of the derivatives of the inverse of g, that are more easily computed.

The spirit of the current chapter is precisely to express geometric quantities for a

generic Riemannian manifold M of dimension n in as functions of the cometic tensor.

In particular, we will solve the highly non-trivial problem to provide a formula for

40

the Riemannian curvature tensor and the numerator of sectional curvature (see next

section)

in

terms

of

gij ,

 xk

gij ,

and

 x xk

gij ,

with

i, j, k,

= 1, . . . , n. In the last

part of this chapter we will express sectional curvature as the ratio of quadratic forms

on the space of alternating 2-tensors 2(TpM), which will allow usa to formulate the problem of finding bounds for sectional curvature as a generalized eigenvalue

problem. In the next chapter we will apply these formulas to the metric tensor of

the landmarks manifolds. For the sake of notational compactness, from now on we

shall

use

the simple

symbol i

in

lieu of

 xi

,

i = 1, . . . , n.

Moreover

we

will employ

Einstein's summation convention: that is, an index occurring twice in a product is to

be summed from 1 to n; for example, Xii is an abbreviation for

n i=1

X i i .

2. Generalities on the Riemannian Curvature Tensor
Suppose that M is an n-dimensional Riemannian manifold with metric tensor g. If we consider a local chart (U, ) on the manifold with coordinates (x1, . . . , xn) the metric is represented by a positive definite, symmetric matrix

gij (x) i,j=1,...,n where the coefficients depend smoothly on x  (U )  Rn. The product of two tangent vectors X, Y  TpM, with X = Xii and Y = Y ii, is
X, Y p = gij x(p) XiY j ;

in particular, gij(x(p)) = i, j p.

Notation. We shall denote the partial derivatives of the elements of tensor g as

follows: gij,k

 xk

gij

and

gij,k

2 x xk

gij ,

for

i,

j,

k,

= 1, . . . , n.

Indicating with T (M) the space of smooth vector fields on the manifold M, let

 : T (M) × T (M)  T (M) be the Levi-Civita connection of the Riemannian

manifold. The Christoffel symbols are defined by ij = ikjk. It is well known

that they have the form:

ikj

=

1 2

gk

(gi

,j

+

gj

,i

-

gij,

).

The Riemannian

curvature

41

endomorphism is the map R : T (M) × T (M) × T (M)  T (M) defined by

(4.1)

R(X, Y )Z = X Y Z - Y X Z - [X,Y ]Z.

In local coordinates R(i, j)k = Rijk , and

Rijkm R(i, j)k, m = gm Rijk.

The Riemannian curvature tensor acts on vector fields as follows:

(4.2)

R(X, Y, Z, W ) = R(X, Y )Z, W

and in coordinates it is written as R = Rijkmdxi  dxj  dxk  dxm. The Riemannian curvature tensor has a number of symmetries:

(4.3)

Rijk = -Rjik , Rijk = Rk ij ,

Rijk = -Rij k, Rijk + Rjki + Rkij = 0,

the last of which is known as the first Bianchi identity.

With the above conventions, the sectional curvature associated to a pair of non-

parallel tangent vectors X and Y is given by:1

(4.4)

K(X, Y ) = =

R(X, Y, Y, X) X 2 Y 2 - X, Y 2

=

RijkmXiY j Y kXm X 2 Y 2 - X, Y

2

;

R(X, Y )Y, X X 2 Y 2 - X, Y 2

1The notation described above is the one adopted by Lee [27]. Other authors use different sign conventions, however in a way that the definition of sectional curvature eventually agrees in sign with (4.4). For example, Jost [23] defines R(X, Y )Z in the same way as above, but then defines the coefficients of the Riemannian curvature tensor as follows: Rijkm = R(i, j)m, k , i.e. with a sign that is opposite to Lee's convention; however, Jost eventually defines the numerator of sectional curvature as RijkmXiY jXkY m, so that it agrees in sign with (4.4). On the other hand Do Carmo [11] defines the Riemannian curvature endomorphism as follows: R(X, Y )Z = Y X Z - X Y Z + [X,Y ]Z, that is, with a sign that is opposite to (4.1); the coefficients are then defined formally as in (4.2), Rijkm = R(i, j)k, m so that their sign is in fact opposite to our convention (they coincide with Jost's); but then the numerator of K(X, Y ) is set to be equal to RijkmXiY jXkY m, so Do Carmo's definition of sectional curvature is eventually consistent with (4.4).

42

note that the denominator is always positive by the Cauchy-Schwarz inequality. There are different ways of expressing the Riemannian curvature tensor in terms of
the metric tensor g; the following proposition turns out to be useful for our purposes since it provides an expression that does not require to compute derivatives of the Christoffel symbols. The proof that follows is an adaptation from one found in [29].

Proposition 4.1. The following expression holds:

(4.5)

2Rijkm = gik,jm + gjm,ik - gjk,im - gim,jk + 2rikjsmgrs - 2rjkismgrs.

Proof. From the definition of the Christoffel symbols, ij = kijk, 2 i j, m = 2 kijk, m = 2kijgmk = gmkgk (gi ,j + gj ,i - gij, ) = m(gi ,j + gj ,i - gij, ) = gim,j + gjm,i - gij,m ;

an appropriate rearrangement of the indices yields the following expression:

(4.6)

2 j k, m = gjm,k + gkm,j - gjk,m .

By the metric compatibility of the connection we have that

i j k, m = i j k, m + j k, i m , whence, by (4.6),

(4.7)

2 i j k, m + 2 j k, i m = 2i j k, m = i(gjm,k + gkm,j - gjk,m) = gjm,ki + gkm,ji - gjk,mi .

By switching i and j we also have that

(4.8)

2 j i k, m + 2 i k, j m = gim,kj + gkm,ij - gik,mj .

Combining (4.7) and (4.8) yields

2 i j k, m - 2 j i k, m
= gjm,ki - gjk,mi - gim,kj + gik,mj - 2 j k, i m + 2 i k, j m .
43

But by definition R(i, j)k = ij k - j ik, whence 2Rijkm = 2 R(i, j)k, m = 2 ij k, m - 2 j ik, m ,
so we have proven that
(4.9) 2Rijkm = gjm,ki - gjk,mi - gim,kj + gik,mj - 2 j k, i m + 2 i k, j m . By the definition of the Christoffels,
i k, j m = irkr, sjms = irksjmgrs , j k, i m = jrkr, isms = jrkismgrs . Inserting the above expressions into the right-hand side of (4.9) finally yields (4.5).
Notation. For any pair of tangent vectors X, Y  TpM we shall denote with (X, Y ) the following vector in TpM:
(X, Y ) kijXiY jk , where the kij are the Christoffel symbols for metric tensor g.
Given the above notation the numerator (and the sign) of sectional curvature K(X, Y ) may be computed using the following result.
Proposition 4.2. The following expressions hold for any pair X, Y  TpM: 2R(X, Y, Y, X) = -(XiY j - Y iXj)gik,jm(XkY m - Y kXm) + 2 (X, Y ) 2 - 2 (X, X), (Y, Y ) .
Proof. We have that -(XiY j - Y iXj)gik,jm(XkY m - Y kXm) = -XiXkY jY mgik,jm + XiY kY jXmgik,jm + Y iXkXjY mgik,jm - Y iY kXjXmgik,jm = 2XiY kY jXmgik,jm - XiXkY jY mgik,jm - Y iY kXj Xmgik,jm = XiY kY jXmgik,jm + XmY jY kXigmj,ki - XiXmY jY kgim,jk - Y j Y kXiXmgjk,im = X iY j Y kX m gik,jm + gjm,ik - gim,jk - gjk,im .
44

As far as the Christoffel symbols are concerned, grsXiY jY kXmirkjsm = XiY kirkr, Y jXmjsms = (X, Y ), (X, Y ) = (X, Y ) 2,
and grsXiY jY kXmrjkism = XiXmisms, Y jY krjkr = (X, X), (Y, Y ) .
This completes the proof.

3. The dual Riemannian Curvature Tensor

One of the purposes of the current chapter is to provide a formula for the numerator of sectional curvature (4.4) in terms the elements of the cometric tensor and their derivatives gij, giijj,k , and giijj,k , i, j, k, = 1, . . . , n. The key idea is to define a "dual" curvature tensor by raising the indices of the Riemannian curvature tensor defined and described in the previous section. That is, if we define the coefficients of the dual Riemannian curvature tensor as Rursv Rijkm giugjrgksgmv and for an arbitrary pair of tangent vectors X = Xii and Y = Y ii we consider the cotangent vectors X = Xidxi and Y = Yidxi, with Xi = gijXj and Yi = gijY j (the "flat" perator : TpM  TpM lowers the indices of a tangent vector [21, 28]), then the numerator of K(X, Y ) may be rewritten as:

R(X, Y )Y, X = RijkmXiY jY kXm = RijkmgiugjrgksgmvXuYrYsXv

(4.10)

= RursvXuYrYsXv.

In this section we shall factorize the tensor coefficients Rijkm in the following way:

(4.11)

Rijkm = giu gjr gks gmv Rursv,

and express Rursv in terms of gij and its first and second partial derivatives. In the section that follows we will compute the action of the dual tensor on the cotangent vectors (X , Y , Y , X ), which will cause drastic simplifications and provide a surprisingly simple formula for the numerator of sectional curvature.
45

In Proposition 4.1 we proved the following general formula:

(4.12)

2Rijkm = gik,jm + gjm,ik - gjk,im - gim,jk + 2ikjmg - 2jkimg .

The key idea is to try to factorize each term of the above formula in the way that is suggested by (4.11). We will start with the terms that involve the first derivatives of the metric tensor, i.e. the Christoffel symbols on the right-hand side of (4.12).

3.1. First derivatives. If we write the metric tensor as a matrix we have that g = Q-1, so that2 xg = -Q-1 · xQ · Q-1. In index notation the first partial derivative is given by
gjm,k = -gjr grrssk, gsm .
By the above formula we may rewrite the Christoffel symbols in (4.12) in a way that is suitable for our purposes.

2This expression generalizes the fact that for a scalar differentiable function f : R  R of

the form f (x) =

1 g(x)

its

derivative

is

given

by

f

(x)

=

-

g (x) g2 (x)

.

In general, recall the definition

of differential : if  is an open set in Rn,  maps  into Rm, x is in  and there exists a linear

transformation A  L(Rn, Rm) such that |(x + h) - (x) - Ah| = o(|h|), then we say that 

is differentiable at x and we write d(x) = A (see [41] for details). The definition can be easily

extended to matrix-valued functions (and in fact to maps between Banach spaces). If a function f is defined as f : GLn(R)  GLn(R) : A  A-1 (note that GLn(R) is an open subset of Rn×n) then its differential computed at a point A  GLn(R) is the linear operator df (A)  L GLn(R), GLn(R) defined as df (A)B = -A-1BA-1, for all B  GLn(R); in fact it can be proven that f (A + H) - f (A) + A-1HA-1 / H  0 as H  0, for example by using the matrix inversion lemma [25].

If f is composed with a differentiable function h : R  GLn(R), i.e. if we define  = f  h, then the differential of  computed at a generic point z  R is a linear operator d  L R, GLn(R) (simply representable as a matrix) that can be calculated via the chain rule, i.e. d(z) = df (h(z))dh(z). In the case of f (A) = A-1 this yields d(z) = - h(z) -1h (z) h(z) -1.

46

For example,

jk

=

1 2

g

gj ,k + g k,j - gjk,

=

1 2

g

- gjr grrssk, gs - g r grrssj, gsk + gjr grrss, gsk

=

1 2

gjr g

grrss,

gsk - gjr grrssk,

s - r grrssj,

gsk

=

1 2

gjr g

grrss,

gsk - gjr grrk,

- gssj,

gsk

.

We can extract factor gjr gsk from the first of the three terms above, but we need to manipulate the other two in order to be able to do the same with them. We have that grrk, = grr, k = grr, g s gsk and similarly gssj, = gss, j = gss, g rgjr, whence the above may be expressed as

(4.13)

jk

=

1 2

gj

r

g

grrss,

- gs

grr,

- gr

gss,

gsk .

As far as the remaining three Christoffel symbols in (4.12) are concerned, by appro-

priately relabeling the indices we obtain the following:

im

=

1 2

giu

g

guuvv,

- gv

guu,

- gu gvv,

gvm ,

ik

=

1 2

giu

g

guuss,

- gs guu,

- gu gss,

gsk ,

jk

=

1 2

gjr

g

grrvv,

- gv

grr,

- gr

gvv,

gvm .

It is convenient, at this point, to define "anti-Christoffel" symbols, or dual Christoffel symbols, in the following manner:3

(4.14)

urs

1 2

gu

gss,

gr + grr,

gs - grrss,

g

.

Notation. If we also define:

(4.15)

gij,k giijj, gk and gij,k

giijj, gkg ,

3Given the form of expression (4.13), perhaps it would make more sense to add a minus sign

in front of definition (4.14). In any case this is rather irrelevant for our purposes, since on the

right-hand side of (4.12) we have the products of pairs of Christoffel symbols so that, in substituting

the definition of the dual Christoffels in such products, opposite signs would cancel.

47

then the dual symbols assume an aspect that is formally analogous to the traditional definition of Christoffel symbols:

rus =

1 2

gu

gs,r + gr,s - grs,

.

With the above notation and using the obvious fact that g = g gg we may rewrite the last term of the right-hand side of equation (4.12) as follows:

-2 jk

im

g

=

-

1 2

gjr

gks

giu

gmv

grrss, g - grr, gs - gss, gr

g

· g g guuvv, g - guu, gv - gvv, gu

= - giu gjr gks gmv 2 rs uv g,

whereas the second-to-last of the same formula becomes
2 ik jm g = giu gjr gks gmv 2 us rv g.
Note that we have precisely achieved the desired factorization, as in (4.11).
3.2. Second derivatives. If we write the metric tensor as a matrix g = Q-1 its second partial derivative is yxg = Q-1· yQ·Q-1·xQ+xQ·Q-1·yQ-yxQ ·Q-1, or, in index notation,
gjm,ki = gjr grri, gµ gµµvvk, + grrk, gµ gµµvvi, - grrvvk, i gvm ;
some manipulation is in order so to achieve the factorization that we desire. We have that:
gjm,ik = gjrgmv i k grr, gµ gµµvv, + grr, gµ gµµvv, - grrvv,  = gjrgmv giugks gu gs grr, gµ gµµvv, + grr, gµ gµµvv, - grrvv,  = giugjrgksgmv grr, gu gµ gµµvv, gs + grr, gs gµ gµµvv, gu - grrvv,  gugs = giugjrgksgmv gr,ugµ gµv,s + gr,sgµ gµv,u - grv,su ,
48

where we have used definitions (4.15). Note that this is exactly the factorization (4.11) we needed. So the first four terms on the right-hand side of (4.12) may be rewritten, respectively, as follows:
gjm,ki = giugjrgksgmv gr,ugµ gµv,s + gr,sgµ gµv,u - grv,su , gik,jm = giugjrgksgmv gu,vgµ gµs,r + gu,rgµ gµs,v - gsu,rv , -gjk,im = giugjrgksgmv - gr,ugµ gµs,v - gr,vgµ gµs,u + grs,uv , -gim,jk = giugjrgksgmv - gu,rgµ gµv,s - gu,sgµ gµv,r + guv,rs ,
where the last three are obtained just by appropriately rearranging the indices. Again, we have achieved exactly the factorization that we wanted.

3.3. Expressions for the dual Riemannian Curvature Tensor. Inserting the formulas we have computed in the above subsections into the right-hand side of (4.12) and comparing the result with (4.11) yields the following formula:

(4.16)

2Rursv = - grv,us - gus,rv + grs,uv + guv,rs + 2rvusg - 2rsuvg + gr,ugµ gµv,s - gr,ugµ gµs,v + gu,rgµ gµs,v - gu,rgµ gµv,s + gr,sgµ gµv,u + gu,vgµ gµs,r - gr,vgµ gµs,u - gu,sgµ gµv,r.

In other words the structure of Rursv is formally analogous to the one of Rijkm expressed by formula (4.5), except for the eight "correction terms" that appear in the last two lines of (4.16). Note, in particular, that the last four terms could be combined with the products of dual Christoffel symbols that appear in the first line. However, inserting the definitions of the Christoffel symbols so that they can be combined with the last four terms above is not that convenient, since the last four terms in (4.16) do not include any of the derivatives of the type grv,, gus,, grs, or guv,, therefore doing so does not yield any significant simplification: in fact the two products of Christoffel symbols correspond to eighteen more elementary terms, only four of which can be combined with the four terms in the third line of the above expression. Also
49

note that the terms in the second line of (4.16) do not combine with anything else but stand by themselves.
We will now introduce some useful notation which will later ease the computation of sectional curvature in terms of the cometric tensor and its partial derivatives. Define Bu,v g gu,v and consider the cotangent vectors Bu,v = Bu,vdx  TpM; in such expressions indices u and v do not commute. The cometric, i.e. the inner product of cotangent vectors of this type in the cotangent space TpM is given by Bu,v, Bs,r = Bu,vBs,r dx, dx = Bu,vBs,rg = gu,vg gs,r. Similarly, let uv = uv dx  TpM so that uv, sr = uvsr dx, dx = uvsrg. Note that with an abuse of notation we have indicated the cometric with ·, · , i.e. using the same symbol that we had used for the metric in previous sections. Also, for any pair of tangent vectors and the corresponding cotangent vectors X = Xi dxi, Y = Yi dxi in TpM define a new vector B(X , Y )  TpM as follows: B(X , Y ) XuYv Bu,v dx; again, note that in such definition X and Y do not commute. For a given set of dual Christoffel symbols, in an analogous fashion we define: (X , Y ) XuYv uv dx, in which case X and Y do commute.
With the above conventions we have that (4.16) can be rewritten as follows:
(4.17) 2Rursv = -grv,us - gus,rv + grs,uv + guv,rs + 2 rv, us - 2 rs, uv
+ Br,u, Bv,s - Br,u, Bs,v + Bu,r, Bs,v - Bu,r, Bv,s
+ Br,s, Bv,u + Bu,v, Bs,r - Br,v, Bs,u - Bu,s, Bv,r .
Using the above expression one can easily verify that the dual tensor satisfies identities Rrusv = -Rursv, Rurvs = -Rursv, Rsvur = Rursv, and Rursv + Rusvr + Ruvrs = 0 for any choice of the indices u, r, s and v, which are analogous to symmetries (4.3) for the regular Riemannian curvature tensor. Equation (4.17) can be manipulated fairly easily to compute the numerator of sectional curvature (4.4). In fact in the next section we will multiply it by the components of cotangent vectors (X , Y , Y , X ), many simplifications will occur and the numerator of (4.4) will finally take a surprisingly simple and elegant form (in terms of the cometric tensor and its partial
50

derivatives). However, it is actually convenient to have a "full blown" expression for the dual tensor: the reason why this is the case will be made evident is section 5 of the current chapter, where we will find bounds on sectional curvature as the solution of a generalized eigenvalue problem.

Proposition 4.3. The Riemannian curvature tensor with raised indices Rursv may be written in function of the cometric tensor and its derivatives as follows:

(T1) (T2) (T3) (T4) (T5) (T6)

2Rursv = - grv,su + grs,uv - gus,rv + guv,rs

-

1 2

grrss, gguuvv, - grrss,

gu,v + gv,u - guuvv,

gr,s + gs,r

+

1 2

guuss, ggvvrr, - guuss,

gv,r + gr,v

- gvvrr,

gu,s + gs,u

-

1 2

gr,s - gs,r

g

gu,v - gv,u

+

1 2

gu,s - gs,u

g

gr,v - gv,r

+ gu,r - gr,u g gs,v - gv,s ,

where, as usual, gij,k giijj, gk and gij,k giijj, gkg .

Remark. From now on, we shall refer to the six terms in the above proposition as T1, . . . , T6. Before proceeding to the proof we should note that we have achieved expressing the dual Riemannian curvature tensor in terms of the cometric tensor; the metric tensor (with "dummy" lower indices  and ) still appears in terms T4, T5 and T6, which will later reduce to only one in the formula for sectional curvature.

Proof. We will expand and recombine the terms in expression (4.17). Clearly the terms involving second derivatives need no manipulation. We can expand the Christoffel symbols as follows:

2 us, rv

=

1 2

gu,s + gs,u - gus, g g g

gr,v + gv,r - grv, ,

51

that is:

2 us, rv

=

1 2

guuss, ggrrvv, - guuss,

gr,v + gv,r

+

1 2

gu,s + gs,u g gr,v + gv,r

Bu,s + Bs,u, Br,v + Bv,r

- grrvv, .

gu,s + gs,u

We can now combine the inner product on the right-hand side of the above formula with the last two terms of (4.17) to get:

1 2

Bu,s + Bs,u, Br,v + Bv,r

-

Br,v, Bs,u

-

=

1 2

gu,s - gs,u g gr,v - gv,r ,

Bu,s, Bv,r

=

1 2

Bu,s - Bs,u, Br,v - Bv,r

whence we may conclude that

2 us, rv - Br,v, Bs,u - Bu,s, Bv,r = T3 + T5.

In a completely similar fashion one can prove that:

-2 rs, uv + Br,s, Bv,u + Bu,v, Bs,r = T2 + T4.

As far as the remaining four correction terms in the second line of formula (4.17) it is the case that:

Br,u, Bv,s - Br,u, Bs,v + Bu,r, Bs,v - Bu,r, Bv,s = Br,u - Bu,r, Bv,s - Bs,v = gr,u - gu,r g gv,s - gs,v = T6,

and this concludes the proof.

4. Sectional Curvature in terms of the cometric tensor
The numerator of sectional curvature may be computed from the dual Riemannian curvature tensor by employing (4.10). Instead of using the "full-blown" expression provided by Proposition 4.3 we will work on the more compact formula (4.17), which
52

will make the procedure somewhat smoother and more elegant. Multiplying by the components of cotangent vectors (X , Y , Y , X ) yields:

2RursvXuYrYsXv = - YrXvgrv,usXuYs - XuYsgus,rvYrXv + YrYsgrs,uvXuXv + XuXvguv,rsYrYs + 2YrXv rv, us XuYs - 2YrYs rs, uv XuXv + YrXu Br,u, Bv,s XvYs - YrXu Br,u, Bs,v YsXv + XuYr Bu,r, Bs,v YsXv - XuYr Bu,r, Bv,s XvYs + YrYs Br,s, Bv,u XvXu - YrXv Br,v, Bs,u YsXu + XuXv Bu,v, Bs,r YsYr - XuYs Bu,s, Bv,r XvYr,

that is,

2RursvXuYrYsXv = YrYsgrs,uvXuXv + XuXvguv,rsYrYs - 2XuYsgus,rvYrXv + 2YrXv rv, us XuYs - 2YrYs rs, uv XuXv + 2XuXv Bu,v, Bs,r YsYr + 2XuYr Bu,r, Bs,v YsXv - 2XuYs Bu,s, Bv,r XvYr - 2YsXu Bs,u, Br,v YrXv .

Proceeding in a way that is completely analogous to the the proof of Proposition 4.2 we may rewrite the above expression as follows:

(4.19)

2Rursv Xu Yr Ys Xv

= (XuYr - YuXr) gsu,rv(XsYv - YsXv) + 2 (X , Y ) 2 - 2 (X , X ), (Y , Y ) + 2XuXv Bu,v, Bs,r YsYr + 2XuYr Bu,r, Bs,v YsXv - 2XuYs Bu,s, Bv,r XvYr - 2YsXu Bs,u, Br,v YrXv ,

so that the "correction terms" have been reduced in number, with respect to expres-

sions (4.16) and (4.17), from eight to four. No further simplification is possible, unless

we insert the definition of dual Christoffel symbols into the above equation. That is

exactly what we are going to do next; now that the number of terms has almost been

halved, the computation is not going to be unbearably complicated.
53

Theorem 4.4. For an arbitrary pair of vectors X = Xii and Y = Y ii in TpM the numerator of sectional curvature (4.4) at point p may be written as:

2Rursv Xu Yr Ys Xv = XuYr - YuXr

gsu,rv

-

1 4

guuss,

grv,

+ guuss,

gr,v

-

3 2

gu,rg gs,v

XsYv - YsXv ,

where Xi = gijXj, Yi = gijY j and, as usual, gij,k giijj, gk and gij,k giijj, gkg .

Proof. We shall split the right-hand side of (4.19) into three terms,

1 (XuYr - YuXr) gsu,rv(XsYv - YsXv), 2 2 (X , Y ) 2 - 2 (X , X ), (Y , Y ) ,

and

3 2XuXv Bu,v, Bs,r YsYr + 2XuYr Bu,r, Bs,v YsXv - 2XuYs Bu,s, Bv,r XvYr - 2YsXu Bs,u, Br,v YrXv ,

so that the second derivatives of the inverse of the metric tensor are in term 1, the terms that concern the Christoffel symbols are contained in term 2, whereas term 3 consists of the "correction" previously discussed. Obviously we have that 2RursvXuYrYsXv = 1 + 2 + 3. Term 1 is in a form that cannot be further simplified. We shall manipulate the other two terms, 2 and 3, and then combine them; this will yield the surprisingly simple final form for the numerator of sectional curvature as a function of the derivatives of the inverse of the metric tensor reported in the statement of the theorem.
Inserting the definition of the dual Christoffel symbols into 2 yields:

2

=

1 2

XuYr

gu,r + gr,u - gur, g gg

gs,v + gv,s - gsv, YsXv

-

1 2

Xu

Xv

gu,v + gv,u - guv, g gg

gr,s + gs,r - grs, YrYs,

54

that is

(4.20a)

2

=

+

1 2

XuYr

guurr, ggssvv, - guurr,

gs,v + gv,s

- guurr,

gu,r + gr,u

YsXv

(4.20b)

-

1 2

XuXv

guuvv, ggrrss,

- guuvv,

gr,s + gs,r

- grrss,

gu,v + gv,u

Yr Ys

(4.20c)

+

1 2

Xu

Yr

gu,r + gr,u

g

gs,v + gv,s

Xv Ys

(4.20d)

-

1 2

XuXv

gu,v + gv,u

g

gr,s + gs,r

YrYs .

The last two terms of (4.20a) may be written (following the multiplication by

XuYrYsXv) as

XuYrguurr, gs,v + gv,s YsXv + YsXvgssvv, gu,r + gr,u XuYr = 2 XuYrguurr, gs,v + gv,s YsXv ,

whereas the second term of (4.20b) may be manipulated as follows:

XuXv guuvv, gr,s + gs,r YrYs = 2 XuXv guuvv, gr,sYrYs and analogously for the third term of (4.20b):

YrYs grrss, gu,v + gv,u XuXv = 2 YrYs grrss, gu,vXuXv . Furthermore, the multiplication in line (4.20c) can be restated in the following terms:

XuYr gu,r + gr,u g gs,v + gv,s XvYs = XuYr + YuXr gr,ug gs,v XvYs + YvXs ,

and the one in line (4.20d) can be simplified as:

XuXv gu,v + gv,u g gr,s + gs,r YrYs = 4 XuXv gu,vg gr,s YrYs .

So 2 can be re-expressed as follows:

2 = XuYr

1 2

guurr,

g  gssvv,

- guurr,

gs,v + gv,s

YsXv

- XuXv

1 2

guuvv,

g  grrss,

- guuvv, gr,s - grrss, gu,v

Yr Ys

+

1 2

XuYr + YuXr gr,ug gs,v XvYs + YvXs

- 2 XuXv gu,vg gr,s YrYs .

55

Further simplifications are actually possible as far as the first two terms of the above expression are concerned. In fact, first note that:

-

1 4

XuYr - YuXr guuss, ggrrvv,

XsYv - YsXv

=

=

-

1 4

XuYr guuss, ggrrvv, XsYv - YuXr guuss, ggrrvv, XsYv

-XuYr guuss, ggrrvv, YsXv + YuXr guuss, ggrrvv, YsXv

=

-

1 4

XuXs guuss, ggrrvv, YrYv - YuXs guuss, ggrrvv, XrYv

-XuYs guuss, ggrrvv, YrXv + YuYs guuss, ggrrvv, XrXv

=

1 2

XuYr guurr,

g  gssvv,

XsYv

-

1 2

XuXv guuvv,

g  grrss,

YrYs .

On the other hand,

XuYr - YuXr guuss, gr,v XsYv - YsXv = XuYrguuss, gr,vXsYv - YuXrguuss, gr,vXsYv
-XuYrguuss, gr,vYsXv + YuXrguuss, gr,vYsXv = XuXsguuss, gr,vYrYv - YuXsguuss, gr,vXrYv
-XuYsguuss, gr,vYrXv + YuYsguuss, gr,vXrXv = XuYv - guurr, gs,v + gv,s YsXv - XuXv - guuvv, gr,s - grrss, gu,v YrYs ,

so that 2 can finally be written as

2 = XuYr - YuXr

-

1 4

guuss,

grv,

+ guuss,

gr,v

XsYv - YsXv

+

1 2

XuYr + YuXr

gr,ug gs,v

XvYs + YvXs

- 2 XuXv gu,vg gr,s YrYs .

As far as term 3 is concerned, we shall simply rewrite it as

3 = 2XuXvgu,vg gs,rYsYr + 2XuYrgu,rg gs,vYsXv
- 2XuYsgu,sg gv,rXvYr - 2YsXugs,ug gr,vYrXv .
56

Combining such formula with the latest expression for 2 gives:

2 + 3 =

XuYr - YuXr

-

1 4

guuss,

grv,

+

guuss,

gr,v

XsYv - YsXv

+

1 2

XuYr + YuXr

gr,ug gs,v

XvYs + YvXs

+ 2XuYrgu,rg gs,vYsXv

- 2XuYsgu,sg gv,rXvYr - 2YsXugs,ug gr,vYrXv .

Performing the multiplication on the second line of the right-hand side and recombining the resulting terms yields:

2 + 3 =

XuYr - YuXr

-

1 4

guuss,

grv,

+

guuss,

gr,v

XsYv - YsXv

+ 3XuYrgu,rg gs,vYsXv

-

3 2

XuYsgu,sg

g v,r Xv Yr

-

3 2

Ys

Xugs,u

g

g r,v Yr Xv

.

But we have that

-

3 2

XuYr - YuXr

gu,rg gs,v

XsYv - YsXv

=

3Xu Yr g u,r g

g s,v Ys Xv

-

3 2

XuYsgu,sg

g v,r Xv Yr

-

3 2

YsXugs,ug

g r,v Yr Xv

,

therefore:

2RursvXuYrYsXv = 1 + 2 + 3 =

= XuYr - YuXr

gsu,rv

-

1 4

guuss,

grv,

+

guuss,

gr,v

-

3 2

g u,r g

gs,v

XsYv - YsXv ,

which is precisely what we wanted to prove.

Remark. We have expressed the numerator of sectional curvature in terms of the cometric tensor and its derivatives; in the formula provided by Theorem 4.4 the only term in the middle factor that depends on the metric tensor (with lower indices) is the fourth one. We should note that the formula was later verified by professor Peter W. Michor of the University of Vienna, who provided an alternative proof [30] with index-free notation.
57

5. Bounds on Sectional Curvature
In this section we show how sectional curvature for an n-dimensional manifold M can be written as the ratio of quadratic forms on the space of alternating 2-forms 2(TpM). This allows to formulate the the problem of finding bounds for sectional curvature as a generalized eigenvalue problem. In the case of three-dimensional manifolds (such as the manifold of three landmarks in one dimension) these bounds are actually achieved by computable pairs of tangent vectors. Following the spirit of the chapter we will express the results and formulas in terms of the cometric tensor and the dual Riemannian curvature tensor. These results, as well as those achieved in the previous sections, will be used in the next chapter to compute and plot the sectional curvature of landmark manifolds. We will indicate with k(V ) the linear space of alternating k-forms on a linear space V (e.g. 1(V ) = V ), and with k(V ) the set of symmetric k-tensors on space V ; for reference, see [21] and [28].
The following proposition holds:

Proposition 4.5. For an arbitrary pair X, Y  TpM define  = X  Y  2(TpM), i.e.  = u<r(XuYr - YuXr) dxu  dxr. We can write sectional curvature at point p  M as follows:

K (X,

Y

)

=

(, (,

) )

,

where:

· is a symmetric bilinear form on 2(TpM), i.e.  2 2(TpM) , defined as follows:4

(, )

=

- ur

Rursv 4

sv

for any pair ,   2(TpM). In the above definition we intend the following:

ur = 



 xu

,

 xr

, i.e.  =

u<r ur dxu  dxr, and similarly for .

4The minus signs follows from the sign conventions for the Riemannian curvature tensor that we adopted, following Lee's notation [27]; see footnote 1 of this chapter.
58

·  is a symmetric bilinear form on 2(TpM), i.e.   2 2(TpM) , defined

as follows:

(, )

=

ur

Gursv 4

sv

for any pair ,   2(TpM), with Gursv = gusgrv - guvgrs. Note that Gursv has the same symmetries as the dual Riemannian curvature tensor Rursv.

Proof. Sectional curvature associated to the 2-plane spanned by tangent vec-

tors X and Y may be written as (4.4): K(X, Y ) =

.XiY j Rijk Y kX
X 2 Y 2- X,Y 2

We

have

that X = Xudxu and Y = Yrdxr, so that  = X  Y = XuYr dxu  dxr =

u<r(XuYr - XrYu) dxu  dxr, by the skew-symmetry of the wedge product. By

definition,

(,

)

=

-

1 4

ur

Rursv

sv

,

whence:

(,

)

=

-

1 4

(XuYr

-

Xr Yu )Rursv (Xs Yv

-

Xv Ys )

=

-

1 4

XuYrRursvXsYv - XuYrRursvXvYs - XrYuRursvXsYv + XrYuRursvXvYs

=

-

1 4

·

4

Xu Yr Rursv Xs Yv

=

XuYrRursvYsXv ,

where we have used the well-knows symmetries of Rursv multiple times. As far as the denominator is concerned, first note that Gursv = gusgrv - guvgrs has the same symmetries as the dual Riemannian curvature tensor Rursv, since

Grusv = grsguv - grvgus = -Gursv, Gurvs = guvgrs - gusgrv = -Gursv, Gsvur = gsugvr - gsrgvu = Gursv.

By

definition

(, )

=

1 4

ur

Gursv

sv

,

whence:

(, ) =

1 4

(XuYr

-

Xr Yu )Gursv (Xs Yv

-

Xv Ys )

=

Xu Yr Gursv Xs Yv

= XuYr(gusgrv - guvgrs)XsYv = XugusXs YrgrvYv - XuguvYv YrgrsXs

= X 2 Y 2 - X, Y 2,

since we have, for example, that XugusXs = XuguggsXs = XgX = X 2.
59

Proposition 4.6. Bilinear forms and  may be expressed as:

(, ) = - ur Rursv sv and (, ) =

ur Gursv sv ,

u<r s<v

u<r s<v

for any ,   2(TpM).

Proof. It follows from ru = -ur, ru = -ur and the symmetries the two tensors of Gursv and Rursv.

Corollary 4.7. Sectional curvature may be expressed as follows:

(4.21)

K(X, Y ) = -

u<r ur u¯<r¯ u¯r¯

s<v Rursv sv s¯<v¯ Gu¯r¯s¯v¯ s¯v¯

,

where ur = XuYr - XrYu for any pair of indices u, r.

We also introduce the linear operators:

(4.22) and

R : 2(TpM)  2(TpM )

:

sv dxs  dxv 

wur

 xu



 xr

,

s<v u<r

with

wur =

Rursvsv ,

s<v

(4.23)

G : 2(TpM)  2(TpM )

:

sv dxs  dxv 

wur

 xu



 xr

,

s<v u<r

with

wur =

Gursvsv .

s<v

Proposition 4.8. Linear operator G is invertible. In fact, if w = G for some

arbitrary   2(TpM) then sv = u<r Hsvurwur, with Hsvur = gsugvr - gsrgvu.

Proof. The proof consists of the following straightforward computation:

Hs¯v¯ur wur

=

1 2

Hs¯v¯ur

wur

=

1 2

Hs¯v¯ur

Gursv sv

u<r s<v

=

1 4

Hs¯v¯ur

Gursv

sv

=

1 4

(gs¯ugv¯r

-

gs¯r gv¯u )

(gusgrv

-

g uv g rs )

sv

=

1 4

(gs¯u gv¯r g us g rv

-

gs¯u gv¯r g uv g rs

-

gs¯r gv¯u g us g rv

+

gs¯r gv¯u g uv g rs )

sv

=

1 4

(s¯sv¯v

-

s¯v v¯s

-

s¯v v¯s

+

s¯s v¯v )sv

=

1 2

(s¯sv¯v

-

s¯v v¯s )sv

=

1 2

(s¯v¯

-

v¯s¯)

=

s¯v¯,

which, by the arbitrariness of , proves the proposition.

60

With the above machinery, we can formulate the problem of finding bounds on sectional curvature as follows:
if: - s<v Rursvsv =  s<v Gursvsv for some   R, i.e. if -R = G, i.e. if   R is a generalized eigenvalue [26] of the pair (-R, G) with generalized eigenvector ,
then: K(X, Y ) = .

Remark. Since G is invertible by Proposition 4.8 the generalized spectrum of the pair (-R, G) coincides with the ordinary spectrum of the linear transformation 2(TpM)  2(TpM) :   -G-1R .

Given a chart around a point p a basis for 2(TpM) is dxs  dxv : s < v , while a

basis for 2(TpM) is

 xs



 xv

:s<v

; both spaces have, in fact, dimension

n 2

.

We

may express linear transformations R and G with respect to such bases with matrices,

whose elements are given precisely by coefficients Rursv and Gursv, respectively. A

way to write down matrix G Gursv u<r is the following:
s<v



G

=



G1212
G1312 ...
G1n12
G2312 ...
G2n12 ...

G1213
G1313 ...
G1n13
G2313 ...
G2n13 ...

···
··· ...
···
··· ...
··· ...

G121n
G131n ...
G1n1n
G231n ...
G2n1n ...

G1223
G1323 ...
G1n23
G2323 ...
G2n23 ...

···
··· ...
···
··· ...
··· ...

G122n
G132n ...
G1n2n
G232n ...
G2n2n ...



··· ··· ··· ··· ··· ··· ··· ...





R(n2)×(n2);

for example when n = dim M = 3 we get:



G

=



G1212 G1312

G2312

G1213 G1313 G2313



G1223 G1323

 .

G2323

61

Similar arguments hold for matrix -R element of -R is -Rurur = Rurru.

-Rursv u<r. Note that the generic diagonal
s<v

For completeness, we will state and prove the following fairly obvious fact, on the

relationship between operators R, G and the elements of the corresponding tensors.

Proposition 4.9. It is the case that Rijk = R(dxk  dx ) (dxi, dxj)
and Gijk = G(dxk  dx ) (dxi, dxj), for any choice of indices i, j, k and .

Proof. We shall prove the above proposition for Gijk . For the sake of computation, it is convenient to write G, with   2(TpM), as a summation over all indices, as follows:

G =

Gursv sv

 xu



 xr

=

1 2

Gursv sv

 xu



 xr

u<r s<v

u<r

(4.24)

=

1 4

Gursv sv

 xu



 xr

,

where we have used the symmetries of Gursv, the fact that vs = -sv, and the skew-symmetry of the wedge product. For fixed indices k and , if  = dxk  dx then

sv

=

(dxk  dx )

 xs

,

 xv

= skv - svk ,

= dxk

 xs

dx

 xv

- dxk

 xv

dx

 xs

by the definition of the wedge product. Substituting such expression into (4.24) yields:

G(dxk  dx )

=

1 4

Gursv (sk v

-

s vk )

 xu



 xr

=

1 4

Gurk

- Gur k

 xu



 xr

(4.25)

=

1 2

Gurk

 xu



 xr

,

where we have used the symmetries of Gursv. For arbitrary indices i and j it turns

out that

 xu



 xr

(dxi, dxj) = ui rj - uj ri ;

62

combining the above expression with (4.25) finally yields:

G(dxk  dx ) (dxi, dxj)

=

1 2

Gurk

(ui rj - uj ri )

=

1 2

(Gijk

- Gjik )

=

Gijk .

An analogous computation holds for R.

We shall denote by  =

1, . . . , m , m =

n 2

,

the generalized

spectrum (the set

of generalized eigenvalues) of the pair (-R, G), i.e. of the pair of matrices -R, G .

An upper bound and a lower bound for sectional curvature are given by, respec-

tively, max max  and min min .

Remark. Once the set of generalized eigenvalues and eigenvectors is known, one can consider, for example, the eigenvector   2(TpM) that corresponds to the maximum eigenvalue max. Unfortunately since the set of simple (or decomposable5) 2-forms    : ,   TpM is a proper subset 2(TpM) it is not necessarily the case that  = X  Y for some X, Y  TpM. Therefore it may happen that K(X, Y ) is not equal to max for any pair of tangent vectors, and max and min only provide, respectively, an upper and a lower bound for sectional curvature. However in the case of three-dimensional manifolds (such as the manifold of three landmarks in one dimension) the maximum and minimum eigenvalues of the spectrum  are achieved by sectional curvature K(X, Y ) by appropriate choices of the tangent vectors, since it is the case that every 2-form in 2(R3) is decomposable. In fact, if

 = 12 dx1  dx2 + 23 dx2  dx3 + 31 dx3  dx1,

·

when

12

=

0

one

can

pick,

for

example,



=

dx1 -

23 12

dx3

and



=

12 dx2 -

31 dx3. It turns out that  =   .

· when 12 = 0 one may instead choose  = -31 dx1 + 23 dx2 and  = dx3.

Again, it is the case that  =   .

Therefore in the case of a three-dimensional manifold once the generalized eigenvector max that corresponds to the maximum eigenvalue max is known, the above formulas allow to compute the cotangent vectors X , Y  TpM such that max = X  Y .

5A k-form   kV is decomposable if and only if it satisfies the Plu¨cker relations [12].
63

The corresponding pair of tangent vectors X, Y are those for which sectional curvature is maximal, i.e. K(X, Y ) = max. The same holds for the minimum eigenvalue min in the generalized spectrum.

We will conclude this section by showing how the generalized spectrum of the pair (-R, G) is related to the scalar curvature of the manifold. We recall from Differential Geometry [11, 23, 27] that the Ricci tensor
Ric = Rjk dxj  dxk is the covariant 2-tensor field defined as the trace of the Riemannian curvature tensor on its first and last indices; in other words its components are defined as:
Rjk gi Rijk . The scalar curvature is the function S defined as the trace of the Ricci tensor, i.e.:
S gjkRjk , so that we can express it in terms of the dual Riemannian curvature tensor as follows:
S = gi gjkRijk = gi gjk giu gjr gks g v Rursv = u rk gks g v Rursv = guv grs Rursv.
The following proposition holds.

Proposition 4.10. Let {1, . . . , m}, m =

n 2

,

be the

generalized

spectrum

of

the

pair of linear operators (-R, G), defined in (4.22) and (4.23). Then it is the case

that

m

i =

1 2

S.

i=1

Proof. The generalized eigenvalues of the pair (-R, G) are the ordinary eigenvalues of the linear transformation -G-1R : (TpM)  (TpM), since by Proposition 4.8 linear operator G is invertible; the components of inverse G-1 are given by Hsvur = gsu gvr - gsr gvu. An arbitrary two-form   2(TpM), which we can write
64

as  =

s<v sv dxsdxv, gets mapped by R to R =

u<r

wur

 xu



 xr



2(TpM),

with wur = s<v Rursvsv. Therefore if we define two-form   2(TpM) as

 = G-1R  = yz dxy  dxz,
y<z
its components can be written as

with:

yz =

Hyzur wur =

Hyzur Rursv sv =

Lyyzzsv sv ,

u<r u<r s<v

s<v

Lyyzzsv

Hyzur Rursv =

1 2

Hyzur

Rursv

=

1 2

gyugzr - gyrgzu Rursv

u<r

=

1 2

gyugzr Rursv - gyrgzu Rursv

= gyugzr Rursv.

The summation of the ordinary eigenvalues of the linear transformation -G-1R

is given by the ordinary trace of -Lyyzzsv (intended as the summation of its diagonal

elements):

m

i =

syvz

i=1 y<z

- Lyyzzsv

=-

sy vz Lyyzzsv

=

-

1 2

sy

vz

Lyyzzsv

y<z

=

-

1 2

sy

vz

gyu

gzr

Rursv

=

-

1 2

gsu

gvr

Rursv

=

-

1 2

gsu

gvr

Rurvs

=

1 2

S

,

which completes the proof.

65

CHAPTER 5
Curvature of the Landmarks Manifold
In the present chapter, which is central in this thesis, we apply the formulas that we developed in Chapter 4 to the Riemannian manifold of landmarks I introduced in Chapter 2. From now on we make the simplifying assumption that the smoothing parameter  is equal to infinity, i.e. that we are dealing with the exact matching problem. We start with analyzing the simplest but nonetheless very informative case of two landmarks in one dimension, and then move on to the case of three or more landmarks in one dimension. Finally we provide a general formula for sectional curvature for N landmarks in D dimensions. As we did in the previous chapter we adopt Einstein's summation convention. In some computations the rules of such convention are broken, e.g. the summation index may appear three times in the same factor; in such cases we write the summation symbol explicitly. In any case in most of the present chapter we denote summation symbols with Greek letters (, , , , . . .). In the next chapter we will study the effect of curvature on the qualitative dynamics of landmarks, for which we derived the differential equations in Chapter 3.
We start by computing the dual Riemannian curvature tensor for N one-dimensional landmarks, and then use the result for calculating sectional curvature for two onedimensional and three one-dimensional landmarks. This is followed by the computation of the general expression for sectional curvature of N landmarks in D dimensions by means of the formula provided by Theorem 4.4.
1. The dual curvature tensor for one-dimensional landmarks
We shall use Proposition 4.3 on the general form of the dual Riemannian curvature tensor from the previous chapter, which we repeat here for our convenience.
66

Proposition 5.1. The Riemannian curvature tensor with raised indices Rursv may be written in function of the cometric tensor and its derivatives as follows:

(T1) (T2) (T3) (T4) (T5) (T6)

2Rursv = - grv,su + grs,uv - gus,rv + guv,rs

-

1 2

grrss, gguuvv, - grrss,

gu,v + gv,u - guuvv,

gr,s + gs,r

+

1 2

guuss, ggvvrr, - guuss,

gv,r + gr,v

- gvvrr,

gu,s + gs,u

-

1 2

gr,s - gs,r

g

gu,v - gv,u

+

1 2

gu,s - gs,u

g

gr,v - gv,r

+ gu,r - gr,u g gs,v - gv,s ,

where, as usual, gij,k giijj, gk and gij,k giijj, gkg .

When D = 1, expression (2.15) and differential equation (2.16) provided in Chap-

ter 2 respectively take the forms:

(5.2)

(

)=

1

2k-

1 2



1 2

(k

-

1)!

1 a

a

Kk-

1 2

k-

1 2

a

,

and

(5.3)



=

2k - 2 

+

1 a2

,

where k and a2 are the parameters of differential operator L = (id - a2)k. We

should also note that the most remarkable difference between one-dimesional and Ddimensional landmark manifolds is topological in nature, in that in the former case the manifold is not connected since the ordering of landmarks cannot change.

1.1. Generic elements of the dual curvature tensor. In the case of one-

dimensional landmarks the cometric tensor g-1(q) is a N × N matrix whose generic

element gij(q) = G(qi, qj) only depends on two of the N variables; the diagonal

elements are actually constant. Therefore, for a fixed index k, the matrix of partial

derivatives

giijj,k

N i,j=1

will

have

only

one

nonzero

row

and

one

nonzero

column,

namely

the k-th ones. Similarly, for fixed k and m, with k = m, the the matrix of second

67

partial derivatives

giijj,km

N i,j=1

will

have

only

two

nonzero

elements,

namely

those

in

positions (k, m) and (m, k). We shall return on this after proving of the following

result.

Lemma 5.2. Let  : [0, +)  R be the function such that G(x, y) = (|x - y|) is the kernel of admissible space V . Then the first and second partial derivatives of the cometric tensor for N one-dimensional landmarks are respectively given by:

(5.4)

giijj,k (q) = (ki - kj )  ( ij) sgn(qi - qj)

and

(5.5)

giijj,km (q) = (ki - kj ) (mi - mj )  ( ij) ,

where ij |qi - qj| and sgn is the sign function.

Proof. We have that gij(q) = ( ij), where ij = |qi - qj|. Therefore



giijj,k

(q) =

 qk

gij (q)

=

 

0

 qi



(

 qj



(

ij ) ij )

for k = i, k = j

for k = i

.

for k = j

Now choose k = i without loss of generality. By the chain rule we have that

 qi



(

ij )

=

(

ij

)

 qi

|qi

-

qj|

=

(

ij

)

qi |qi

- -

qj qj

|

=  ( ij) sgn(qi - qj) .

Analogously,

 qj

(

ij) =  (

ij) sgn(qj

- qi) = - (

ij) sgn(qi - qj) .

Combining

the

above formulas we finally have that:

giijj,k (q) = ki  ( ij) sgn(qi - qj) - kj  ( ij) sgn(qi - qj) = (ki - kj ) ( ij) sgn(qi - qj).

Let us now compute the second derivatives:

giijj,km (q)

=

 qm

giijj,k

(q)

=

 qm

(ki

-

kj )



(

ij) sgn(qi - qj)

= (ki - kj )

 qm

(

ij )

sgn(qi - qj) +  (

ij )

 qm

sgn(qi

-

qj)

(5.6)

=

(ki - kj )

 qm



(

ij )

sgn(qi - qj) .

68

The derivative in square brackets above may be rewritten as:



(5.7)

 qm



(

 ij) = 

0

 qi



(

 qj



(

ij ) ij )

for m = i, m = j

for m = i

.

for m = j

Again, without loss of generality choose m = i. By the chain rule,

 qi



(

ij )

=



(

ij

)

 qi

ij

=



(

ij )

 qi

|qi

-

qj|

=



(

ij )

qi |qi

- -

qj qj|

=



(

ij) sgn(qi - qj)

and analogously

 qj



(

ij) = 

(

ij) sgn(qj - qi) = -

(

ij) sgn(qi - qj) .

Therefore we may write (5.7) in the following compact form:

 qm



(

ij) = (mi - mj ) 

(

ij) sgn(qi - qj) .

Inserting such expression into (5.6) finally yields:

giijj,km (q) = (ki - kj ) (mi - mj )  ( ij) sgn(qi - qj) 2,

that is: giijj,km (q) = (ki - kj ) (mi - mj )  ( ij) ,
which is precisely what we wanted to prove.

Remark. Some comments about the expressions provided by the above lemma

are in order. Consider matrix S(q), whose generic element is given by gij. We have

that gij depends only on two out of the N variables (q1, . . . , qN ), namely qi and qj.

Therefore

in

matrix

 qk

S

(q)

only

the

k-th

row

and

the

k-th

column

are

nonzero

(with

the notable exception of the element that lies on the diagonal, which must be zero).

This fact is reflected in the right-hand side of expression (5.4), where the presence

of factor (ki - kj ) implies that giijj,k is nonzero only when i = k or j = k (again,

note that when i = j then ki - kj = 0 so that all the elements on the diagonal of

matrix

 qk

S

(q

)

are

zero,

for

all

k).

For

a

fixed

value

of

index

k,

matrix

 qk

S

(q)

turns

69

Figure 5.1. Typical shape of function f : R  R.

out to be skew-symmetric. As far as the second partial derivatives are concerned,

since each of the "surviving" elements giijj,k

of

matrix

 qk

S

(q)

depends

only

on

the

two variables qi and qj, the following holds:

·

if

m

=

k

then

matrix



2 qmqk

S

(q)

will

have only

two

nonzero

elements,

namely

those in positions (k, m) and (m, k). This is reflected by the right-hand side

of (5.5), which is nonzero only when either i = k and j = m, or i = m and

j = k. If i = j (diagonal elements) the right-hand side of (5.5) is zero.

·

if

m

=

k

then

only

the

k-th

row

and

the

k-th

column

of

matrix

2 (qk

)2

S

(q

)

are

nonzero (with the usual exception of the diagonal element). Note that when

m = k expression (5.5) takes the form: giijj,kk (q) = (ki - kj )2  ( ij), which

is nonzero when either i = k or j = k, once again with the exception i = j.

In

any

case,

matrix



2 qmqk

S

(q

)

is

symmetric

for

any

choice

of

indices

k

and

m.

Definition 5.3. Let f : R  R be the map x   (|x|) sgn(x). Define:

f (x, y) f (x - y) =  (|x - y|) sgn(x - y), for x, y  R.

The above function is such that f (x, y) = -f (y, x) and f (x, x) = 0. Also, f 2(x, y) =  (|x - y|) 2. The typical shape of function f (x) is shown in Figure 5.1. With the above definition we may write
giijj,k (q) = (ki - kj ) f (qi, qj)
by the first part of Lemma 5.2. The proposition that follows provides the expression for the generic element of the dual Riemannian curvature tensor for one-dimensional landmarks, as a function of  and its derivatives.
70

Proposition 5.4. In the case of one-dimensional landmarks, the six terms of the dual Riemannian curvature tensor listed in Proposition 5.1 take the following form:

T1 = - ( ru) - ( vu) ( rs) - ( vs)  ( rv) + ( ru) - ( su) ( rv) - ( sv)  ( rs)

- ( ur) - ( sr) ( uv) - ( sv)  ( us)

+ ( ur) - ( vr) ( us) - ( vs)  ( uv) ,

T2 + T3 =

1 2

( ru) - ( uv) - ( sr) + ( sv) f (qu, qs) f (qr, qv)

- ( ru) - ( rv) - ( su) + ( sv) f (qr, qs) f (qu, qv)

+ ( uv) - ( rv) f (qs, qu) f (qu, qr) - f (qs, qr) f (qs, qu) + f (qu, qr)

+ ( rs) - ( us) f (qv, qr) f (qr, qu) - f (qv, qu) f (qv, qr) + f (qr, qu)

- ( su) - ( vu) f (qr, qs) f (qs, qv) - f (qr, qv) f (qr, qs) + f (qs, qv)

- ( vr) - ( sr) f (qu, qv) f (qv, qs) - f (qu, qs) f (qu, qv) + f (qv, qs)

T4 =

-

1 2



( rs) - ( s) f (qr, q) - ( rs) - ( r) f (qs, q)

· g f (q, qu) ( v) - ( uv) - f (q, qv) ( u) - ( uv) ,

T5 =

1 2



( us) - ( s) f (qu, q) - ( us) - ( u) f (qs, q)

· g f (q, qr) ( v) - ( rv) - f (q, qv) ( r) - ( vr) ,

T6 =

( ur) - ( r) f (qu, q) - ( ru) - ( u) f (qr, q)



· g f (q, qs) ( v) - ( sv) - f (q, qv) ( s) - ( vs) .

,

Remark. As we anticipated at the beginning of the chapter we have written the summation symbols (such as ) explicitly where the rules of Einstein's summation conventions are broken, for example when the summation index appears more than
71

twice in a product. In any case, in the above expressions and in the proof that follows Greek letters are used for summation indices.

Proof of Proposition 5.4. We will compute the six terms one by one. We have that
grv,su = grrvv,  gsgu = (r - v) (r - v)  ( rv) ( s) ( u) = ( sr) - ( sv) ( ur) - ( uv)  ( rv);

by appropriately rearranging the labels one can get analogous expressions for grs,uv, gus,rv, and guv,rs; the expression for T1 follows immediately. As far as terms T2 and T3 are concerned, it is the case that:

grrss, gguuvv, = (r - s) f (qr, qs) ( ) (u - v ) f (qu, qv) = (ru - rv - su + sv ) ( ) f (qr, qs) f (qu, qv) = ( ru) - ( rv) - ( su) + ( sv) f (qr, qs) f (qu, qv).

By appropriately relabeling the indices, we can use the above formula to express the

summation of the first terms of T1 and T2:

(5.8)

-

1 2

grrss, gguuvv, - guuss, ggvvrr,

=

1 2

guuss, ggvvrr, - grrss, gguuvv,

=

1 2

( ru) - ( uv) - ( sr) + ( sv) f (qu, qs) f (qr, qv)

- ( ru) - ( rv) - ( su) + ( sv) f (qr, qs) f (qu, qv) .

On the other hand,

grrss, gu,v + gv,u

= grrss, guu, gv + gvv, gu

= (r - s ) f (qr, qs) ( - u) f (q, qu) ( v) + ( - v ) f (q, qv) ( u)


= (r - s ) f (qr, qs)


( v) - ( uv) f (q, qu) + ( u) - ( vu) f (q, qv) ,
72

so that we can finally write
grrss, gu,v + gv,u = f (qr, qs) ( rv) - ( uv) f (qr, qu) + ( ru) - ( vu) f (qr, qv) - ( sv) - ( uv) f (qs, qu) - ( su) - ( vu) f (qs, qv) .

We can use such expression to write the summation of the last two terms of both T1

and

T2

as

follows

(modulo

the

multiplication

by

1 2

):

( ) grrss, gu,v + gv,u + guuvv, gr,s + gs,r

- guuss, gv,r + gr,v - gvvrr, gu,s + gs,u

(5.9a)

= + f (qr, qs) ( rv) - ( uv) f (qr, qu) + ( ru) - ( vu) f (qr, qv)

(5.9b)

- ( sv) - ( uv) f (qs, qu) - ( su) - ( vu) f (qs, qv)

(5.9c)

+ f (qu, qv) ( us) - ( rs) f (qu, qr) + ( ru) - ( sr) f (qu, qs)

(5.9d)

- ( sv) - ( rs) f (qv, qr) - ( vr) - ( sr) f (qv, qs)

(5.9e)

- f (qu, qs) ( uv) - ( rv) f (qu, qr) + ( ru) - ( vr) f (qu, qv)

(5.9f)

- ( sv) - ( rv) f (qs, qr) - ( sr) - ( vr) f (qs, qv)

(5.9g)

- f (qr, qv) ( rs) - ( us) f (qr, qu) + ( ru) - ( su) f (qr, qs)

(5.9h)

- ( sv) - ( us) f (qv, qu) - ( vu) - ( su) f (qv, qs) ;

the underlined terms in the above expression cancel two by two: precisely, (5.9a) cancels with (5.9g), (5.9b) with (5.9f), (5.9c) with (5.9e), and (5.9d) with (5.9h); in some cases the antisymmetry of function f is used. By recombining the surviving
73

terms in the square brackets two by two yields:

( ) = + f (qr, qs) ( rv) - ( uv) f (qr, qu) - ( su) - ( vu) f (qs, qv)

(5.10a)

- ( rv) - ( uv) f (qs, qu)

+ f (qu, qv) ( us) - ( rs) f (qu, qr) - ( vr) - ( sr) f (qv, qs)

(5.10b)

- ( us) - ( rs) f (qv, qr)

- f (qu, qs) ( uv) - ( rv) f (qu, qr) - ( sr) - ( vr) f (qs, qv)

(5.10c)

+ ( rs) - ( rv) f (qu, qv)

- f (qr, qv) ( rs) - ( us) f (qr, qu) - ( vu) - ( su) f (qv, qs)

(5.10d)

+ ( uv) - ( us) f (qr, qs) ,

where we have underlined the terms deriving from the recombinations: term (5.10a) derives from combining the surviving terms in the square brackets in (5.9b) and in (5.9f), term (5.10b) from (5.9d) and (5.9h), term (5.10c) from (5.9e) and (5.9c), and term (5.10d) from (5.9g) and (5.9a). Two terms in each pair of curly brackets can be factorized as:

()= + f (qr, qs) ( uv) - ( rv) f (qu, qr) + f (qs, qu) - ( su) - ( vu) f (qs, qv) + f (qu, qv) ( rs) - ( us) f (qr, qu) + f (qv, qr) - ( vr) - ( sr) f (qv, qs) - f (qu, qs) ( uv) - ( rv) f (qu, qr) + ( rs) - ( rv) f (qu, qv) + f (qv, qs) - f (qr, qv) ( rs) - ( us) f (qr, qu) + ( uv) - ( us) f (qr, qs) + f (qs, qv) ,
74

so that we can finally write ( ) as the summation of four terms:
( ) = + ( uv) - ( rv) f (qs, qu) f (qu, qr) - f (qs, qr) f (qs, qu) + f (qu, qr) + ( rs) - ( us) f (qv, qr) f (qr, qu) - f (qv, qu) f (qv, qr) + f (qr, qu) - ( us) - ( uv) f (qr, qs) f (qs, qv) - f (qr, qv) f (qr, qs) + f (qs, qv) - ( rv) - ( rs) f (qu, qv) f (qv, qs) - f (qu, qs) f (qu, qv) + f (qv, qs) ,
which coincide precisely with the last four terms of T2 + T3. Moving on to terms T4, T5, and T6 we have that, for example,
(5.11) gu,s = guu, gs = ( - u) f (q, qu) ( s) = ( s) - ( us) f (q, qu),
so that
(5.12) gu,s - gs,u = ( s) - ( us) f (q, qu) - ( u) - ( su) f (q, qs) ,
while
gr,v - gv,r = ( v) - ( rv) f (q, qr) - ( r) - ( vr) f (q, qv) .
The expression for T5 follows immediately from the antisymmetry of function f , whereas those for T4 and T6 are obtained in a completely similar manner.
1.2. Diagonal elements of the tensor. One may be interested in the general form of the diagonal elements of the dual Riemannian curvature tensor; for example, in the simple case of two one-dimensional landmarks the Riemannian curvature tensor consists of only one element. The following result holds.
75

Proposition 5.5. The diagonal elements of the Riemannian curvature tensor are

given

by

Rursv

s=u v=r

=

Rurur

=

1 2

6 i=1

Ti,

with:

T1 = -2 (0) - ( ur) 2  ( ur) , T2 + T3 = (0) - ( ru) ·  ( ru) 2,

T5 = 0 ,

T4 + T6

=

3 2



· g

( ur) - ( r) f (qu, q) - ( ur) - ( u) f (qr, q) ( ur) - ( r) f (qu, q) - ( ur) - ( u) f (qr, q) .

Remark. Of the three nonzero terms in the expression for 2Rurur provided by Proposition 5.5 the last two, T2 and T4 + T6, are always positive for any landmark configuration, whereas the sign of T1 is determined by the sign of function - ( ur).

Proof of Proposition 5.5. Setting s = u and v = r in term T1 yields:

T1 s=u = - 0 + ( ru) - (0) (0) - ( ur)  ( ur)
v=r
- 0 + ( ur) - (0) (0) - ( ru)  ( ur)
= - 2 (0) - ( ru) 2 ( ur).

We now note that the first line of the expression for term T2 + T3 provided by Proposition 5.4 is equal to zero when s = u and v = r; the remaining five lines of the same term become:

(T2

+

T3)

s=u v=r

=

1 2

- 2 (0) - ( ru)  ( ru) 2

- (0) - ( ru) -  ( ru) 2 - (0) - ( ru)

-  ( ru) 2

- (0) - ( ru) -  ( ru) 2 - (0) - ( rv) -  ( ru) 2

= (0) - ( ru)  ( ru) 2.
76

As far as terms T4, T5 and T6 are concerned it is convenient to turn directly to the expressions provided by Proposition 5.1; we have that:

T4

s=u v=r

=

-

1 2

gr,u - gu,r

g

gu,r - gr,u

=

1 2

gu,r - gr,u

g

gu,r - gr,u

,

which, with the notation introduced in subsection 3.3 of Chapter 4, we may also write

as

T4

s=u v=r

=

1 2

Bu,r - Br,u

2 where the "sharp" operator raises the indices of a

cotangent vector, i.e. : TII  TII : Xidxi  (gijXj)i, and · is the norm

induced by the metric. It is easy to verify that T5 s=u = 0, while
v=r

T6 s=u = gu,r - gr,u g gu,r - gr,u = Bu,r - Br,u 2,
v=r

so

that

(T4

+

T6)

s=u v=r

=

3 2

Bu,r - Br,u

2; but by expression (5.12) we have

gu,r - gr,u = ( r) - ( ur) f (q, qu) - ( u) - ( ru) f (q, qr) ,

so that

(T4

+ T6)

s=u v=r

=

3 2

Bu,r - Br,u

2

= ( r) - ( ur) f (q, qu) - ( u) - ( ru) f (q, qr)



· g ( r) - ( ur) f (q, qu) - ( u) - ( ru) f (q, qr) ,

which completes the proof.

2. Sectional curvature for two one-dimensional landmarks

In the case of just two one-dimensional landmarks (q1, q2) matrices G and -R introduced in section 5 of Chapter 4 are just scalars, since 2(R2) R. For example, when the smoothing parameter  is set to be equal to infinity (exact matching):

(5.13)

G = G1212 = gusgrv - guvgrs u=s=1 = g11g22 - g12g21
r=v=2
= 2(0) - 2( 12) = (0) + ( 12) (0) - ( 12) ,

which is always positive since (0) > ( 12). Similarly it is the case that -R = -R1212 = R1221, whose expression can be computed by means of Proposition 5.5; more precisely the following result holds.
77

Proposition 5.6. In the case of two one-dimensional landmarks term T4 + T6 of 2R1212 provided by Proposition 5.5 takes the following form, for a generic value of

smoothing parameter :

T4 + T6 = 3

(0) - ( (0) + (

12) 12)

2

·

(

12) 2,

so that the only element of matrix -R = R1221 can be expressed as

R1221

=

-R1212

=

-

1 2

6 i=1

Ti

s=u=1 v=r=2

=

(0) - (

12) 2

(

12) -

(0) - (

12)

2(0) - ( 12) (0) + ( 12)

(

12) 2.

Remark. Of the three terms in the expression for R1221 provided by the above proposition the last two are always negative, whereas the sign of the first one is determined by the sign of function  ( 12).

Proof of Proposition 5.6. The first two terms of the expression for R1221 =

-R1212

derive

directly

form

terms

T1

and

T2 +T3

(multiplied

by

1 2

)

for

Rurur

provided

by Proposition 5.5. As far as the last term is concerned, we note that in the case of

two landmarks





g-1 =  (0) ( 12)  ( 12) (0)



(5.14)

=

g=

1 2(0) - 2(

 12)

(0) -( 12)


-( 12)  . (0)

By the proof of Proposition 5.5 we have that term T4 + T6 can be written as

(T4

+ T6)

s=u=1 v=r=2

=

3 2

B1,2 - B2,1

2

=

3 2

g1,2 - g2,1

g

g1,2 - g2,1

,

which by the Einstein summation convention expands out to

(T4

+

T6)

s=u=1 v=r=2

=

3 2

g11,2 - g12,1 g11 g11,2 - g12,1 + g11,2 - g12,1 g12 g21,2 - g22,1

+ g21,2 - g22,1 g21 g11,2 - g12,1 + g21,2 - g22,1 g22 g21,2 - g22,1 ;

78

but g11,2 = 0, g22,1 = 0, g11 = g22 and g12 = g21, so the above expression reduces to:

(5.15)

(T4

+ T6)

s=u=1 v=r=2

=

3 2

g11

g12,1 2 + g21,2 2 - 2g12 g12,1g21,2

.

From equation (5.11) we have that

g12,1 = (0) - ( 12) f (q1, q2) and g21,2 = (0) - ( 12) f (q2, q1) = -g12,1,

so that:

g12,1 2 = g12,1 2 = (0) - ( 12) 2  ( 12) 2 and g12,1g21,2 = - (0) - ( 12)  ( 12) 2 = - g12,1 2;

on the other hand, by expression (5.14) we have

g11 =

(0) 2(0) - 2(

12) ,

g12

=

-



2

( (0) -

12) 2(

12) .

Whence we may rewrite (5.15) as:

(T4 + T6) s=u=1 = 3 g12,1)2 g11 + g12
v=r=2

=3

(0) - (

12)

2

(

12)

2 (0) - ( 12) 2(0) - 2( 12)

=3

(0) - ( 12) 2 (0) + ( 12)

 ( 12) 2;

Summing

the

above

to

the

other

terms

(and

multiplying

by

-

1 2

)

yields

R1221 = (0) - ( 12) 2 ( 12)

-

1 2

(0) - ( 12)

(

12)

2

-

3 2

(0) - ( 12) 2 (0) + ( 12)

(

12)

2

= (0) - ( 12) 2 ( 12)

-

1 2

(0) - (

12)

(0) + ( 12) + 3 (0) - ( 12) (0) + ( 12)

 ( 12) 2

= ( 12) - (0) 2 ( 12) -

(0) - (

12)

2(0) - ( 12) (0) + ( 12)

(

12)

2,

which completes the proof.

79

The problem of computing the generalized eigenvalues of the pair (-R, G) is at

this point trivial: equation -R =  G (with  = 12 dq1  dx2) can simply be

written

as

-R121212

=



G121212,

whose

only

solution

is

obviously



=

,R1221
G1212

which

is the sectional curvature of the two-dimentional landmarks manifold I at the point

of coordinates (q1, q2). In fact such result can also be obtained directly by applying

formula (4.21) of the previous chapter:

(5.16)

K(X, Y ) = -

u<r ur u¯<r¯ u¯r¯

s<v Rursv sv s¯<v¯ Gu¯r¯s¯v¯ s¯v¯

=

-12 R1212 12 12 G1212 12

=

R1221 G1212

,

which is only a function of 12 = |q1 - q2|; we will denote it with ( 12). By (5.13)

and Proposition 5.5 we can finally compute the expression for sectional curvature for

two one-dimensional landmarks.

Corollary 5.7. Sectional curvature for two landmarks in one dimension (5.16) has the following expression for  =  (exact matching):

(5.17)

(

12) =

(0) - ( (0) + (

12) 12)



(

12) -

2(0) - ( 12) (0) + ( 12) 2

 ( 12) 2,

where we have merged the two terms with factor  ( 12) 2 into one.

Proof. It suffices to divide R1221, provided by Proposition 5.6, by G1212, given by equation (5.13).

We implemented the above equations in the case of a Gaussian kernel,

(5.18)

( ) =  1 exp 22

-

1 2

2
2

,

with 2 = 1. The shape of sectional curvature ( 12), provided by equation (5.17), is plotted in Figure 5.2. It turns out that  has a minimum, a zero (other than the one at 12 = 0) and a maximum at points:

m = 0.953, ( m) = -0.1594,

z = 1.534, ( z) = 0,
80

M = 2.198, ( M) = 0.1786,

(12)

0.2

0.15

0.1

0.05

0

-0.05

-0.1

-0.15

-0.2

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

12

=

q -q
21

Figure 5.2. Sectional curvature ( 12) for the Gaussian kernel.
respectively. So we see that when the two landmarks are close to each other curvature is negative, it is positive for higher values of the mutual distance of the landmarks, and finally converges to zero from above as 12  . Figure 5.2 refers to the Gaussian kernel (5.18) but if fact it turns out that graph of sectional curvature ( ) is qualitatively similar to the one above for a wide class of Kernels. The following proposition is an adaptation of a result by Fran¸cois-Xavier Vialard [44].

Proposition 5.8. Consider function ( ), > 0, given by (5.17), i.e. the sectional curvature for two one-dimensional landmarks in the case of exact matching. If  (0) = 0 (which is verified when the kernel is bell-shaped) then:

(5.19)

(

)

=

-

1 2

 (0) 2 (0)

2 + o(

2)

as  0,

so that ( ) is negative in a neighborhood of zero. Under the following condition on the behavior of function  at infinity:

(5.20)

 ( ) 2 = o  ( ) as  ,

it is the case that

( ) =  ( ) 1 + o(1)
81

as  ,

therefore, since  ( ) > 0 for large , curvature  is "convex at infinity", i.e. it converges to zero from above as  .

Proof. First of all note that function (5.17) can be written as follows:

(

)=

( ) (0) + (

),

where

( )

(0) - (

)



(

)-

2(0) - ( ) (0) + ( )

 ( 12) 2.

Since (0) + ( ) -1 is strictly greater than zero for all > 0 and it converges

to 2(0) -1 as  0+, in order to prove (5.19) it is sufficient to study the properties

of ( ) in a neighborhood of zero. First note that since  (0) = 0 the Taylor expansion

of  near the origin is given by:

(

)

=

(0)

+

1 2



(0)

2 + o(

2);

therefore we may write the first term of ( ) as:

(5.21)

(0) - ( )  (

)=

-

1 2



(0)

2 + o(

2)

 (0) + o(1)

=

-

1 2



(0)

2

2 + o(

2)

in an neighborhood of zero. As far as the second term of ( ) is concerned, we first note that  ( ) =  (0) + o( ), whence  ( ) 2 =  (0) 2 2 + o( 2); consequently,

- 2(0) - ( )

(

)

2=-

(0) -

1 2



(0)

2 + o(

2)

= -(0)  (0) 2 2 + o( 2),

 (0) 2 2 + o( 2)

whence

(5.22)

-

2(0) - ( (0) + (

) )

(

)

2=

1 2(0)

+

o(1)

- (0)  (0) 2 2 + o( 2)

=

-

1 2



(0)

2

2 + o(

2),

as  0. Summing (5.21) and (5.22) yields

( ) = -  (0) 2 2 + o( 2),
82

so that we finally have

(

)=

1 (0) + (

) (

)=

1 2(0)

+

o(1)

=

-

1 2

 (0) 2 (0)

2 + o(

2).

-  (0) 2 2 + o( 2)

which proves the first part of the proposition.

Now assume now that (5.20) holds. We may rewrite (5.17) in a neighborhood of

infinity as:

( 12)  ( 12)

=

(0) - ( (0) + (

12) 12)

-

2(0) - ( 12) (0) + ( 12) 2

1 + o(1)

2 (0)

+

o(1)

 ( 12) 2  ( 12) = 1 + o(1)
o(1)

as  , which concludes the proof since  ( ) > 0 for large values of .

We will now verify the validity of condition (5.20) for three families of kernels.

Example 1 (Gaussian kernels). As we mentioned in Chapter (2) the Gaussian

kernel

(

)=

1 22

exp

-

1 2

2
2

is such that equations (2.19) hold, i.e.:

 ( ) = -2 ( )

and



(

)=

1 2

2 - 1 ,

therefore which converges to zero as

[ ( )]2 ()

= (

)

2
2 - 2

 ; whence (5.21) is satisfied.

Example 2 (Sobolev kernels). With the notation introduced in Appendix B, i.e.:

k,D

1

2k+

D 2

-1



D 2

(k)

1

ak+

D 2

,

function (2.15) may be rewritten as:

( ) = k,D

Kk-

D 2

k-

D 2

a

,

while its derivative is provided by Corollary B.2:

(

)

=

-k,D

1 a

Kk-

D 2

k-

D 2

-1

a

.

83

We will use the following property [1, §9.7.2] of modified Bessel functions in a neighborhood of infinity:

(5.23) K(z) 

 2z

e-z

1+

µ

- 8z

1

+

(µ

- 1)(µ - 2!(8z)2

9)

+

(µ

-

1)(µ - 9)(µ 3!(8z)3

-

25)

+.

.

.

for

| arg z| <

3 2

,

where

µ()

=

42.

In

our

case

D

=1

and

we

shall

also

assume

for

simplicity a = 1; furthermore 

k

-

D 2

=

k

-

1 2

.

Function  satisfies differential

equation (5.3) with a = 1, which we rewrite for convenience:

 = 2k - 2  - ;

hence the second derivative of  can be written, in a neighborhood of infinity, as

 = (2k - 2) -1 - 

(5.24)

= -k,1(2k - 2) -1K-1( ) + k,1  K ( )

= -k,1(2k - 2) -1

 2

e-

1

+

(2k

- 3)2 8

-

1

+

o

1

+ k,1 

 2

e-

1

+

(2k

- 1)2 8

-

1

+

o

1

= k,1

-

1 2

 2

e-

1+

(2k

- 3)2 8

-

1

-

(2k

-

2)

1 +o

1

,

since µ() = 4

k

-

1 2

2 = (2k - 1)2 and µ( - 1) = 4( - 1)2 = 4

k

-

3 2

2 = (2k - 3)2.

On the other hand,

 ( ) 2 = k2,1 2 K2-1( )

 k2,1

2-1

 2

e-2

1

+

2

(2k

- 3)2 8

-

1

1

+

o

1

.

Comparing (5.24) with the above expression one concludes that

( ) 2  ( ) 0

as  ; whence  ( ) 2 = o  ( ) , which is exactly (5.20).
84

Example 3 (Cauchy kernels). Again, as we mentioned in Chapter (2) the Cauchy-

type

kernel

(

)=

1 1+a2

2

is

such

that

equations

(2.20)

hold,

i.e.:

 ( ) = -2a2 2( ) and  ( ) = 8a4 23( ) - 2a22( ),

therefore [ ( )]2 = 4a4 24( ) and

[ ( )]2 ()

=

8a2

4a2 a2 2( ) 3( ) a2 2( ) 2( ) - 2a22(

)

= (

)4

2 a2 2( a2 2( )

) -

1

,

which converges to zero as   since a2 2( )  1; whence (5.20) is satisfied.

3. Sectional curvature for three one-dimensional landmarks
In this section we analyze sectional curvature for different configurations of three landmarks on the real line. We will use the techniques developed in section 5 of the previous chapter, motivated by the fact that in this case the shape manifold I has dimension 3 and that 2(TII) R3 is indeed decomposable. That is, for any   2(TII) there exists a pair (X, Y )  TII × TII such that  = X  Y ; so the maximum and minimum generalized eigenvalues of the pair of linear maps (-R, G) indeed provide the maximum and minimum sectional curvatures over possible choice of tangent 2-planes at the point I (landmark shape) under consideration.
Assuming the three one-dimensional landmarks are such that q1 < q2 < q3 at all times, let 12 = |q1 - q2| and 23 = |q2 - q3|. We have computed numerically the dual Riemannian curvature tensor Rursv and tensor Gursv using the formulas provided by Proposition 5.4 and equation (5.13), respectively, for N = 3 using the Gaussian kernel (5.18) with unit variance: maximum, median and minimum generalized eigenvalues were also computed numerically for ( 12, 23)  (0, 5) × (0, 5).
Figure 5.3 represents the maximum generalized eigenvalue: it is positive for any choice of 12 and 23; for ( 12, 23)  0 the maximum generalized eigenvalue converges to some finite, positive limit. Figure 5.4 represents the minimum generalized eigenvalue, for different values of 12 and 23: it is negative for any choice of such parameters; note that for ( 12, 23)  0 (i.e. when the three landmarks are close to each other) the minimum generalized eigenvalue converges to some finite, negative
85

MAXIMUM EIGENVALUE

0.1

0.08

0.06

0.04

0.02

0 5

45

34

2 1

3 2 1

23 0 0

12

Figure 5.3. Maximum generalized eigenvalue (i.e. maximum sectional

curvature) for three landmarks in one dimension, as a function of distances 12 and 23.

limit. Figure 5.5 represents the median generalized eigenvalue (out of three): it has

positive and negative values for different choices of 12 and 23; for ( 12, 23)  0 the

median generalized eigenvalue converges to the same finite, positive limit to which

the maximum eigenvalue converges.

Finally, Figure 5.6 shows the generalized trace, i.e. the summation of the three

generalized generalized eigenvalues: we proved in Proposition 4.10 that this number

is

actually

equal

to

(

1 2

times)

the

scalar

curvature

of

the

manifold

at

a

point;

again,

it has positive and negative values for different choices of 12 and 23. Note, in

particular, that for small values of distances 12 and 23 it is negative and it has

a positive maximum when 12 = 23 2.2. Also, note that when one of the two

landmarks is "far away"--say, when 23 is very large, the profile of the graph as a

function of 12 only is the same one that we got in the case of two one-dimensional

landmarks (see Figure 5.2): curvature converges to zero as 12  0, then it has a

86

MINIMUM EIGENVALUE

0

-0.1 -0.2

-0.3 -0.4

-0.5 -0.6

-0.7 5

45

34

2 1

3 2 1

23 0 0

12

Figure 5.4. Minimum generalized eigenvalue (i.e. minimum sectional

curvature) for three landmarks in one dimension, as a function of distances 12 and 23.

negative bump, followed by a positive bump, and finally flattens again to zero (from above) as 12 diverges.
Figure 5.7 compares the generalized eigenvalues along the line 12 = 23 (symmetric landmark configurations); as anticipated above, for  0 along such line the maximum and median eigenvalues converge to the same positive limit. Also, we may note that the maximum and minimum eigenvalues are always, respectively, positive and negative, the median one has both positive and negative values. Also, the trace converges to zero from above as   as it was the case for two one-dimensional landmarks--see Figure 5.2.
Table 5.1 shows possible choices of tangent vectors X and Y that achieve maximum and minimum curvature along the line 12 = 23; they were computed using the techniques described at the end of the previous chapter. It is interesting to note that along the line 12 = 23 the tangent plane of maximum curvature is the same i.e. it is spanned by the same vectors. On the other hand, the tangent
87

MEDIAN EIGENVALUE

0.1

0.08

0.06

0.04

0.02

0

-0.02 5

45

34

2 1

3 2 1

23 0 0

12

Figure 5.5. Median generalized eigenvalue for three landmarks in one dimension, as a function of distances 12 and 23.

TRACE (SCALAR CURVATURE)

0.2

0.1

0

-0.1

-0.2

-0.3

-0.4

-0.5 5

45

34

2 1

3 2 1

23 0 0

12

Figure

5.6.

Trace

(i.e.

1 2

times

scalar

curvature)

for

three

landmarks

in one dimension, as a function of distances 12 and 23.

88

EIGENVALUES ALONG THE DIAGONAL 12=23 0.2

0.1

0

-0.1

-0.2

-0.3

-0.4

-0.5

MAXIMUM EIGENVALUE MEDIAN EIGENVALUE

MINIMUM EIGENVALUE

TRACE (SCALAR CURVATURE)

-0.6 0 0.5 1 1.5 2 2.5 3 3.5

12=23

Figure 5.7. Generalized eigenvalues of (-R, G) for three landmarks in one dimension of the quadratic form along the line 12 = 23.

plane of minimum curvature changes; one of the two tangent vectors can actually be

fixed, Y = (-1, 0, 1) while the other tangent vector can always be chosen to be of the

form X = X1( ), 1, 0 , where X1 is a decreasing function of

12 = 23.

Finally, Table 5.2 shows possible choices of tangent vectors that achieve maxi-

mum and minimum curvature along a "ridge" of the graph for scalar curvature (the

summation

of

the

generalized

eigenvalues,

times

1 2

):

the

locations

are

shown

in

Fig-

ure 5.8 with different symbols, that also appear in Table 5.2. It is certainly interest-

ing to follow the "evolution" along the ridge of the tangent plane that corresponds,

for example, to the maximum eigenvalue (sectional curvature). In the position de-

noted by a square, that corresponds to the central local maximum of scalar curvature

( 12 = 23 = 2.225), the two tangent vectors that maximize sectional curvature

are X = (0, 1, 0) and Y = (1, 0, 1): moving along these directions makes the central

89

Position

Eigenvalues

12 = 0.025 23 = 0.025

max = 4.99 · 10-2 min = -5.48 · 10-1

12 1.15 23 1.15

max = 2.28 · 10-2

min = -2.94 · 10-1

Eigenvectors are  = X  Y , with:

· ·- ·

X = (0, 1, 0)

· - · · - Y = (1, 0, 1)

· -· · ·
· ··- ·

· ·-
· ·-

X (2, 1, 0) Y = (-1, 0, 1)
X = (0, 1, 0) Y = (1, 0, 1)

·- ·- · · · ·-

X = (1.03, 1, 0) Y = (-1, 0, 1)

12 = 2.15 23 = 2.15

max = 9.38 · 10-2

· ·- · ·- · ·-

X = (0, 1, 0) Y = (1, 0, 1)

maximum of
max along min = -3.95 · 10-3
12 = 23

12 = 3.5 23 = 3.5

max = 9.73 · 10-3

··

·- · · ·-

· ·- · ·- · ·-

X = (0.198, 1, 0) Y = (-1, 0, 1)
X = (0, 1, 0) Y = (1, 0, 1)

large distances

min = -1.02 · 10-7

··

·- · · ·-

X (, 0, -1) Y = (-1, 0, 1)

Table 5.1. Eigenvalues and pairs (X, Y ) that achieve them, along 12 = 23;  denotes a very small (but nonzero) number.

landmark closer to the other two, which on the other hand do not change their relative positions. On the other end of the path, in the position denoted by a circle (we are close to the boundary of the manifold, when two landmarks almost coincide), the two tangent vectors that maximize sectional curvature are close to X = (1, 1, 0) and Y = (0, 0, 1), "as if" the two close landmarks were actually clustered into one.
90

Position

Eigenvalues

12 = 2.225 23 = 2.225
maximum of trace along
12 = 23

max = 9.27 · 10-2 min = -2.51 · 10-3

12 = 1.525 23 = 2.30

max = 8.79 · 10-2

Eigenvectors are  = X  Y , with:

· ·- ·

X = (0, 1, 0)

· - · · - Y = (1, 0, 1)

··

··

·- · ·- ·

· ·-
· ·-

X = (0.168, 1, 0) Y = (-1, 0, 1)
X = (0.316, 1, 0) Y = (0.039, 0, 1)

·- · · ·min = -2.51 · 10-2 

· ·-

X = (0.445, 1, 0) Y = (-2.12, 0, 1)

12 = 0.825 23 = 2.45

max = 8.18 · 10-2

·- · - ·

X = (0.620, 1, 0)

· ·

·-

Y = (-0.084, 0, 1)

min = -9.40 · 10-2

12 = 0.425 23 = 2.65

max = 7.84 · 10-2

· -· · ·
·-· · ·

· ·-
· ·-

X = (1.040, 1, 0) Y = (-1.519, 0, 1)
X = (0.807, 1, 0) Y = (-0.122, 0, 1)

min = -7.00 · 10-2

12 = 0.025 23 = 2.875

max = 7.89 · 10-2

·- · · ·
· -· · ·-

· ·-
· ·-

X = (0.318, 1, 0) Y = (-1.532, 0, 1)
X (1 - , 1, 0) Y (0, , 1)



min = -5.75 · 10-2

· -· - ·

X (1 + , 1, 0)

· ·

· - Y (-, 0, 1)

Table 5.2. Eigenvalues and pairs (X, Y ) that achieve them, in selected locations of along the ridge of scalar curvature, shown in Figure 5.8;  denotes a very small (but nonzero) number.

4. Sectional curvature for N one-dimensional landmarks
In the previous chapter we computed the following formula for the numerator of sectional curvature of an n-dimensional Riemannian manifold in terms of the cometric
91

3.5 3
2.5 2
1.5 1
0.5

0.5 1 1.5 2 2.5 3 3.5

Figure 5.8. Locations along the "ridge" of scalar curvature for Table 5.2.

tensor gij and its partial derivatives giijj,k and giijj,k :

(5.25)

2Rursv Xu Yr Ys Xv = XuYr - YuXr

gsu,rv

-

1 4

guuss,

grv,

+ guuss,

gr,v

-

3 2

gu,rg gs,v

· XsYv - YsXv

= XuYr - YuXr

·

grgssuu, 

gv

-

1 4

guuss,

g  grrvv,

+ guuss,

grr,

gv

-

3 2

grguu,

g

gss,

gv

· XsYv - YsXv .

Our notation is such that the sign of the above quantity the same as the sign of sectional curvature K(X, Y ). Our objective in this section is to provide a formula for sectional curvature in the case of N landmarks in one dimension; we will achieve this be inserting the expression for the partial derivative of the cometric, which are provided by Lemma 5.2, into the right-hand-side of expression (5.25). We will first "process" separately the four terms in the middle factor of (5.25). We should note that
92

the dimension of the shape manifold I is in this case n = N ; since 2(TII) R(N2 ) is not decomposable for N  3 the method illustrated in section 5 of the previous chapter would only provide upper and lower bounds for sectional curvature at a point, not necessarily achievable at a pair of tangent vectors.

4.1. First term. An appropriate relabeling of the indices in (5.5) yields gssuu,  = (s - u) (s - u)  ( su) ,
so that the first term in the middle factor of (5.25) can be expressed as grgssuu,  gv = (s - u) (s - u)  ( su) ( r) ( v) = ( rs) - ( ru) ( sv) - ( uv)  ( su).

Further simplifications can be derived after the multiplication by the components of the cotangent vectors. In fact we have that

(5.26)

grgssuu,  gv = ( rs) - ( ru) ( sv) - ( uv)  ( su) = ( rs)( sv) - ( rs)( uv) - ( ru)( sv) + ( ru)( uv)  ( su);

but appropriately relabeling the indices (u  s, s  u, r  v, v  r) yields:

(XuYr - YuXr ( ru)( uv) ( su) (XsYv - YsXv
u
= (XsYv - YsXv ( vs)( sr) ( us) (XuYr - YuXr ,
s
so that the first and fourth terms within the square brackets of (5.26) can be combined.
Note that we are summing over all four indices u, r, s and v; however, we write the
summation symbols u and s because indices u and s break the rules of Einstein's summation convention, since they appear three times within the same term. In
conclusion, we may write:

(XuYr - YuXr grgssuu,  gv(XsYv - YsXv =

(XuYr - YuXr ·

su

· 2( rs)( sv) - ( rs)( uv) - ( ru)( sv)  ( su) (XsYv - YsXv .

93

4.2. Second term. First note that following auxiliary identity holds:

( )(u - s )(r - v ) = ( )u - ( )s (r - v ) = ( u) - ( s) (r - v ) = ( u) - ( s) r - ( u) - ( s) v = ( ur) - ( sr) - ( uv) + ( sv),

so that the second term of the middle factor of (5.25) can be rewritten as:

-

1 4

guuss,

g  grrvv,

=

-

1 4

(u

-

s ) f (qu, qs) (

) (r - v ) f (qr, qv)

=

-

1 4

(

ur) - (

sr) - (

uv) + (

sv )

f (qu, qs) f (qr, qv).

Simplifications occur after multiplying by the cotangent vector components. Relabeling the indices (u  s, s  u, r  v, v  r) yields:

(XuYr - YuXr ( sv)f (qu, qs)f (qr, qv) (XsYv - YsXv
sv
= (XsYv - YsXv ( ur)f (qs, qu)f (qv, qr) (XuYr - YuXr
ur
= (XsYv - YsXv ( ur)f (qu, qs)f (qr, qv) (XuYr - YuXr
ur
(we have also used the antisymmetry of function f ) and

(XuYr - YuXr ( uv)f (qu, qs)f (qr, qv) (XsYv - YsXv
uv
= (XsYv - YsXv ( sr)f (qs, qu)f (qv, qr) (XuYr - YuXr
sr
= (XsYv - YsXv ( sr)f (qu, qs)f (qr, qv) (XuYr - YuXr .
sr
In conclusion, we may write the second term as follows:

(XuYr - YuXr

-

1 4

guuss,

g  grrvv,

(XsYv - YsXv

= (XuYr - YuXr
urs

-

1 2

(

ur) - (

sr) f (qu, qs) f (qr, qv)

(XsYv - YsXv

.

94

4.3. Third term. The following holds (we're summing over both  and ):

guuss, grr, gv =

(u - s ) f (qu, qs) ( - r ) f (q, qr) ( v) = Aursv f (qu, qs),



with:

Aursv

(u - s ) ( - r ) f (q, qr) ( v)


= u f (q, qr) ( v) - ur f (q, qr) ( v)


- s  f (q, qr) ( v) + s r f (q, qr) ( v)


= f (qu, qr) ( uv) - f (qu, qr) ( rv) - f (qs, qr) ( sv) + f (qs, qr) ( rv)

= f (qu, qr) ( uv) - ( rv) + f (qs, qr) ( rv) - ( sv) .

Whence the third term takes the form:

guuss, grr, gv = f (qu, qr) ( uv) - ( rv) + f (qs, qr) ( rv) - ( sv) f (qu, qs).

4.4.

Fourth

term.

We need to compute:

-

3 2

grguu,

g

gss,

gv.

Note that:

grguu, = ( r) (u - ) f (qu, q) = ( ru) - ( r) f (qu, q),

and analogously gvgss, = ( v) - ( vs) f (q, qs). Therefore:

-

3 2

grguu,

g

gss,

gv

=

-

3 2

( ru) - ( r) f (qu, q) g f (x, qs) ( v) - ( vs) .



Remark. Let Z XuYr - YuXr grguu, . Then

XuYr - YuXr

-

3 2

grguu,

g gss,

gv

XsYv - YsXv

=

-

3 2

Z  g

Z

<

0,

since the metric tensor g is positive definite. Whence the fourth term provides a negative contribution to the numerator of sectional curvature, for any choice of tangent vectors X = qii and Y = Y jj in TII.
95

4.5. Summation of four terms. The above discussion boils down to the following way of rewriting formula (5.25):

2RursvXuYrYsXv =

XuYr - YuXr ·

rsu

· 2( rs)( sv) - ( rs)( uv) - ( ru)( sv)  ( su) + f (qu, qs)·

·

f (qu, qr) (

uv) - (

rv)

+ f (qs, qr) (

rv) - (

sv )

-

1 2

f

(qr

,

qv

)

(

ur) - (

sr )

-

3 2

( ru) - ( r) f (qu, q) g f (x, qs) ( v) - ( vs)



XsYv - YsXv ;

in the next section we will extend the above formula to the D-dimensional case.

5. Sectional curvature for N D-dimensional landmarks
As we discussed in Chapter 3 in the case of landmarks in D  2 dimensions it is convenient to introduce a metric tensor and a cometric tensor with "double indices", one that refers to the landmark index and the other that refers to the dimensional component of that specific landmark. Given the block-diagonal nature of the metric tensor we can write its generic element as follows:

(5.27)

giajb(q) = hij(q) ab, i, j = 1, . . . , N, a, b = 1, . . . , D

where (in the case of exact matching,  = ) hij(q) = G(qi, qj) =  qi - qj RD . The following result is the D-dimensional counterpart of Lemma 5.2.

Lemma 5.9. Let  : [0, +)  R be such that G(x, y) =  x - y RD is the kernel of admissible space V . Then the first and second partial derivatives of the cometric tensor for N one-dimensional landmarks are respectively given by:

(5.28)

giiaajjbbk, c

=

 qkc

giajb

=

(ki - kj )  (

ij )

qic

- qjc
ij

ab,

96

and

giiaajjbbk, c d

=

 q

d

giiaajjbbk, c

= (ki - kj ) (i - j) ab

 ( ij)

qic - qjc qid - qjd
ij 2

(5.29)

+



( ij)
ij

cd -

qic - qjc qid - qjd
ij 2

,

where ij qi - qj RD .

Proof. We have that giiaajjbbk, c

=

 qkc

hij

ab, where



 qkc

hij (q)

=

 qkc

(

 ij) = 

0

 qic



(

 qjc



(

ij ) ij )

for k = i, k = j for k = i for k = j

By the chain rule

 qic

(

ij )

=

(

ij )

 qic

ij =  ( ij)

qic - qjc qi - qj RD

,

hence



giiaajjbbk, c

=

 

 ( ij) - ( ij)

0

qic - qjc qi - qj RD

ab

qic - qjc qi - qj RD

ab

which we may write in the compact form

for k = i, k = j for k = i for k = j

(5.30)

giiaajjbbk, c

=

(ki - kj )  (

ij )

qic

- qjc
ij

ab,

which is precisely (5.28). We can use such expression to write:

(5.31)

giiaajjbbk, c d

=

 q

d giiaajjbbk, c

=

(ki

-

kj )

 q

d

(

ij )

qic

- qjc
ij

ab

= (ki - kj )

qic - qjc
ij

 q

d



(

ij )

+



( ij)
ij

 q

d

(qic

-

qjc)

+



(

ij )

qic - qjc

 q d

1
ij

ab;

we will now compute the three derivatives inside the curly brackets.
97

In a way that is analogous to how (5.30) was computed we can prove that:

(5.32)

 q

d



(

ij) =

(i - j) 

(

ij )

qid

- qjd
ij

.

Also,

 q d

qic - qjc





0 0

= 

 qic  qic

qic - qjc qic - qjc

=1 = -1

which may be expressed compactly as

if = i and = j if c = d if = i and d = c if = j and d = c

(5.33)

 q d

qic - qjc

= idc - jdc = (i - j)dc .

We should now note that



 q d

ij

=

 q d

 

qi - qj

RD = 

qid 

qjd

0

ij

=

qid

- qjd
ij

ij

=

qjd

- qid
ij

that is,

 q d

ij

=

(i

-

j)

qid

- qjd
ij

;

whence we can finally compute

if = i and = i if = i if = j

(5.34)

 q d

1
ij

=

 q

d

ij -1 = -

1 ij 2 q d

ij

=

-(i

-

j

)

qid

-
ij

qjd
3

.

Inserting the right-hand sides of equations (5.32), (5.33) and (5.34) into the right-hand side of (5.31) finally yields (5.29), thus completing the proof of the lemma.

Remark. We should note that, as expected, in the case D = 1 equations (5.28)

and (5.29) reduce, respectively, to equations (5.4) and (5.5) provided by Lemma 5.2.

In fact in this case we have that a = b = c = d = 1, whence

qic

- qjc
ij

=

sgn(qi1

- qj1),

qic - qjc qid - qjd

qi1 - qj1 2

ij 2 = ij 2 = 1

98

0.25 0.2
0.15 0.1
0.05 0
-0.05 -0.1
-0.15 -0.2
-0.25

3

2

1

0

-1

-2 -3

3

2

1

0

-1 -2 -3

uv

Figure 5.9. Typical shape of function f1(x), x = (v, u), for D = 2; and obviously ab = cd = 1.

Definition 5.10. For notational convenience, for a fixed index a  {1, . . . , D}

we will introduce function fa : RD  R : x  

x RD

xa x RD

and define:

fa(x, y)

fa(x - y) = 

x - y RD

xa - x-y

ya
RD

,

where xa and ya are the a-th components of points x, y  RD.

As we had for function f introduced in Definition 5.3, it is the case that fa(x, y) = -fa(y, x) and fa(x, x) = 0, for any choice of index a  {1, . . . , D}. Figure 5.9 shows the typical shape of function f1 : RD  R in the case D = 2; compare it with the one-dimensional counterpart shown in Figure 5.1. With the above notation, equation (5.28) can be simply written as
giiaajjbbk, c = (ki - kj ) fc(qi, qj) ab.
We are now going to apply the results of Lemma 5.9 to Theorem 4.4 so to compute the general formula for sectional curvature for the Riemannian manifold of N
99

landmarks in D dimensions. In order to do that, we first need to rewrite the formula provided by Theorem 4.4 in terms of the "double index" notation introduced in Chapter 3. We are going to use u, r, s, v for the indices concerning the landmark label, and a, b, c, d for those regarding the component of a specific landmark; as far as summation indices are concerned, we are going to use , , ,  and , , ,  for the two types of indices, respectively. We have:

2RuarbscvdXuaYrbYscXvd =

XuaYrb - YuaXrb

gscua,rbvd

-

1 4

guuaasscc, 

grbvd,

+ guuaasscc, 

grb,vd

-

3 2

gua,rbg

gsc,vd

XscYvd - YscXvd ,

with u, r, s, v = 1, . . . , N and a, b, c, d = 1, . . . , D. As we did in section 4 we are going to analyze the four terms in the central factor of the right-hand side of the above equation one by one.

5.1. First term. We can use formula (5.29) from Lemma 5.9 to compute:

gscua,rbvd gssccuuaa,  grbgvd

= (s - u) (s - u) ca

 ( su)

qs - qu qs - qu
su 2

+



( su)
su

 -

qs - qu qs - qu
su 2

( r) b ( v) d,

that is, summing over indices , ,  and ,

gscua,rbvd =

( sr) - ( ur)

( sv) - ( uv) ac

 ( su)

qsb - qub qsd - qud
su 2

+



( su)
su

bd -

qsb - qub qsd - qud
su 2

,

that is,

gscua,rbvd = ( sr)( sv) - ( sr)( uv) - ( ur)( sv) + ( ur)( uv) ac

·

 ( su)

qsb - qub qsd - qud
su 2

+



( su)
su

bd -

qsb - qub qsd - qud
su 2

100

.

After multiplying by the components of the contangent vectors a simplification occurs, in the same way that they occurred in the one-dimensional case: that is, the two underlined terms in the above equation actually combine. The final result is:

XuaYrb - YuaXrb gscua,rbvd XscYvd - YscXvd

= XuaYrb - YuaXrb
su

2( sr)( sv) - ( sr)( uv) - ( ur)( sv) ac

·

 ( su)

qsb - qub qsd - qud
su 2

+



( su)
su

bd -

qsb - qub qsd - qud
su 2

· XscYvd - YscXvd ;

as usual, we have written the summation symbols explicitly only for those indices that break the rules of Einstein's summation convention.

5.2. Second term. This time we need formula (5.28) from Lemma 5.9:

-

1 4

guuaasscc, 

grbvd,

=

-

1 4

guuaasscc, 

grrbbvvdd, 

g

=

-

1 4

(u

-

s )



(

us)

qu

- qs
us

ac

(r

-

v )



(

rv)

qr

- qv
rv

bd

(

) 

=

-

1 4



ac

bd

(

ur) - (

uv) - (

sr) + (

sv )

f(qu, qs)f(qr, qv)

=

-

1 4



ac

bd

(

ur) - (

uv) - (

sr) + (

sv )

D
f(qu, qs) f(qr, qv).

=1

Once again, multiplying by the components of the cotangent vectors causes some simplifications: the two underlined and and the two doubly underlined terms combine. The final result is:

XuaYrb - YuaXrb gscua,rbvd XscYvd - YscXvd

= XuaYrb - YuaXrb
su

-

1 2

ac

bd

(

ur) - (

sr )

D
f(qu, qs) f(qr, qv)

=1

· XscYvd - YscXvd .

101

5.3. Third term. Once again, by formula (5.28) from Lemma 5.9:
guuaasscc,  grb,vd = guuaasscc,  grrbb,  gvd = (u - s ) f(qu, qs) ac ( - r ) f(q, qr) b ( v) d

= u f d(q, qr) ( v) - ur f d(q, qr) ( v)

- s  f d(q, qr) ( v) + s r f d(q, qr) ( v) f b(qu, qs) ac

= f d(qu, qr) ( uv) - f d(qu, qr) ( rv) - f d(qs, qr) ( sv) + f d(qs, qr) ( rv) f b(qu, qs) ac
= ( uv) - ( rv) f d(qu, qr) + ( rv) - ( sv) f d(qs, qr) f b(qu, qs) ac,
where we have (only notationally) raised the indices in functions f d and f b to make them consistent with the left-hand side, e.g. defining f b bf.

5.4. Fourth term. We have:

-

3 2

gua,rb

g

gsc,vd

=

-

3 2

guuaa, 

grb

g

gsscc, 

gvd

=

-

3 2

(u - ) f(qu, q) a ( r)b g ( - s) f(q, qs) c ( v)d



=

-

3 2

( ur) - ( r) f b(qu, q) h f d(q, qs) ( v) - ( sv) ac,



where hij(q) is the inverse tensor of hij(q) = G(qi, qj), defined in (5.27): it is in fact the case that g a c = h  a c = h ac.
102

5.5. Summation of four terms. The discussion above finally leads to:

2RuarbscvdXuaYrbYscXvd =

XuaYrb - YuaXrb XscYvd - YscXvd ac·

rsu

· 2( sr)( sv) - ( sr)( uv) - ( ur)( sv)

·

 ( su)

qsb - qub qsd - qud
su 2

+



( su)
su

bd -

qsb - qub qsd - qud
su 2

-

1 2

bd

(

ur) - (

sr )

D
f(qu, qs) f(qr, qv)

=1

+ ( uv) - ( rv) f d(qu, qr) + ( rv) - ( sv) f d(qs, qr) f b(qu, qs)

-

3 2

( ur) - ( r) f b(qu, q) h f d(q, qs) ( v) - ( sv) ,



where, as usual, we have written the summation symbols explicitly for the indices

for which the rules of Einstein's summation conventions are broken, i.e. when the

summation index appears more than twice in a product.

Remark. Once again, one can easily verify that the formula computed above for sectional curvature in the general case for N landmarks in D dimensions simplify to the one that we had computed for N one-dimensional landmarks reported at the end of section 4, simply by setting a = b = c = d = 1.

6. Conclusions
In this chapter we have provided explicit formulas for the dual Riemannian curvature tensor in the case of N one-dimensional landmarks and for sectional curvature in the case of N landmarks in one or D  2 dimensions; in particular, we have have also analyzed in detail the graphs of sectional curvature for two and three landmarks on the real line. The formulas are expressed in terms of the function  that defines the kernel G(x, y) =  x - y RD , and its first and second derivatives. For specific choices of  its derivatives are related to it, e.g. by second order differential equation (2.15) in the case of Sobolev-type kernels or by equations (2.19) and (2.20) for
103

the Gaussian and Cauchy kernels, respectively; using such expressions the formulas for sectional curvature could be made analytically more explicit, although we chose to leave them in their most general form--which is still numerically implementable.
In the next chapter we will use some of the formulas we worked out in the present one to investigate the effects of curvature on the qualitative dynamics of landmarks, i.e. the geodesic flow determined by the Hamiltonian system discussed in Chapter 3.
104

CHAPTER 6
The Qualitative Dynamics of Landmarks
In this chapter we explore the qualitative dynamics of geodesics for landmarks manifolds and analyze how such dynamics are influenced by curvature, which we studied in the previous chapter.

1. Introduction

Geodesics are determined by the Euler-Lagrange equations for the Riemannian

energy that was introduced in Chapter 2. The geodesic flow on the tangent bundle

can also be obtained from the cogeodesic flow determined by Hamilton's equations:

(6.1)

  qi =

N

G(qi,

qj)

+

ij 

pj

j=1

 pi

=

N
- G(qi, qj) pi, pj RD

j=1

i = 1, . . . , N.

which we derived in Chapter 3. Having studied curvature in the previous chapter we will analyze the effect that it has on the qualitative dynamics of landmarks, e.g. by verifying the existence of conjugate points (that is, points on the manifold that are connected by distinct geodesic curves) in regions of positive curvature, or by verifying the divergence of geodesics in regions of negative curvature.
Before proceeding we will express the conservation of the Hamiltonian for landmarks, whose expression is

(6.2)

H(p, q)

=

1 2

N

G(qi,

qj)

+

ij 

i,j=1

pi, pj RD ,

in a way that will be useful for our study. As usual, we assume that the kernel G of admissible Hilbert space V has the form G(x, y) =  x - y RD for some function  : [0, )  R.
105

Proposition 6.1. For any choice of the smoothing parameter , the following scalar quantity is conserved:

M (p, q) where ij = qi - qj RD .

(0)

+

1 

-

(

ij )

pi, pj RD ,

1i<jN

Proof. We can manipulate the expression for the Hamiltonian as follows:

H(p, q)

=

1 2

N

(0)

+

1 

i=1

pi, pi RD + 2 ( ij) pi, pj RD
i<j

=

1 2

(0)

+

1 

N
pi, pi RD + 2

pi, pj RD

i=1 i<j

-2

(0)

+

1 

pi, pj RD + 2

( ij) pi, pj RD

i<j i<j

=

1 2

(0)

+

1 

NN
pi, pj
i=1 j=1

-
RD i<j

(0) +

1 

-

(

ij )

pi, pj RD ;

but the first term on the right-hand side is conserved by the conservation of linear

momentum. Since the Hamiltonian is conserved, so in the second term of the above

expression and this completes the proof.

Remark. We have not proven a "new" conservation law. The above proposition is a consequence of the conservation of the Hamiltonian function (6.2) and the conservation of linear momentum (Proposition 3.5).

For now on we shall assume, like we did in the previous chapter, that  = .

2. Dynamics of two one-dimensional landmarks
In the case of two landmarks on the real line Proposition 6.1 immediately implies the following result.
Corollary 6.2. For  =  (exact matching), in the case of two one-dimensional landmarks the scalar quantity (0) - ( 12) p1p2 is conserved.
106

The conservation of linear momentum and the above result allow as to write the following expressions for the sum and product of momenta p1 and p2:

(6.3) (6.4)

p1(t) + p2(t) = p1(0) + p2(0), (0) -  12(0)
p1(t) p2(t) = (0) -  12(t) p1(0) p2(0) ,

for all time t. Thanks to the above equations the evolution of momenta can be completely solved in function of the evolution of the mutual distance 12(t) between the two landmarks and the initial distance 12(0); in particular, when the asymptotic behavior of 12(t) for t   is known, equations (6.3) and (6.4) allow one to infer the asymptotic behavior of the momenta, as a function of the initial distance 12(0).
Hamilton's equations (6.1) provided by Proposition 3.1 simplify to the following:

(6.5a) (6.5b)

q1 = (0) p1 + ( 12) p2 q2 = ( 12) p1 + (0) p2 p1 = -f q1, q2 p1p2 p2 = -f q2, q1 p1p2 = -p1

with 12(t) = |q1(t) - q2(t)| and f (x, y) =  (|x - y|) sgn(x - y) (see Definition 5.3). If we assume, as we do in the following, that q1 < q2 at all time, then f (q1, q2) = - ( 12) and the last two equations above can be rewritten as follows:

(6.5c) (6.5d)

p1 =  12 p1p2 p2 = - 12 p1p2 .

Note also that the strong conservation law for momenta (Proposition 3.2) becomes:

(6.6)

t 

qi(0)

pi(t) = pi(0),

t  [0, 1], i = 1, 2.

Since D = 1 there is no conservation of angular momentum, whence from now on in this section by "weak conservation law" we will always mean the conservation of linear
107

Case # 1.

Initial momenta p1(0), p2(0)

· -·

p1 > 0, p2 = 0

2. · - ·-

0 < p2 < p1

3. · - · - 0 < p1 = p2

4. ·- · - 0 < p1 < p2

5.

· ·-

p1 = 0, p2 > 0

6.

· - ·

p1 > 0, p2 < 0, with p1 = |p2|

7.

· - ·

p1 > 0, p2 < 0, with p1 > |p2|

8.

·

· - p1 < 0, p2 > 0, with |p1| = p2

9. · · - p1 < 0, p2 > 0, with |p1| < p2
Table 6.1. The nine cases of initial momenta p1(0), p2(0) .

momentum (6.3). We also note that since q2 > q1 for all t we have that 12 = q2 - q1, whence the distance between landmarks satisfies the ordinary differential equation:

(6.7)

d dt

12 = q2 - q1 =

(0) - ( 12) (p2 - p1),

by (6.5a) and (6.5b). As far as the dynamics of equations (6.5a)÷(6.5d) are concerned, we shall analyze
the different cases listed in Table 6.1 (which are characterized by different initial
108

(12)

0.2

0.15

0.1

0.05

0

-0.05

-0.1

-0.15

-0.2

0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5

12

=

q -q
21

Figure 6.1. Sectional curvature ( 12) for the Gaussian kernel.
values of the momenta p1 and p2) in various regions of the manifold, i.e. in areas with positive or negative curvature. From now on, we shall always assume that q1 < q2 (and since we assume that  =  such order cannot change in time). The qualitative behavior of the dynamical system in other cases not listed in Table 6.1 (e.g. p1 = 0, p2 < 0) can be inferred, by symmetry, from those listed.
We remind the reader that for the manifold of two one-dimensional landmarks sectional curvature , given by formula (5.17), only depends on 12 and is plotted again for convenience in Figure 6.1 in the case of the Gaussian kernel (5.18) with unit variance. As we saw in the previous chapter function  has a minimum, a zero (other than the one at 12 = 0) and a maximum at points:

m = 0.953, ( m) = -0.1594,

z = 1.534, ( z) = 0,

M = 2.198, ( M) = 0.1786,

respectively. We have implemented numerically differential equations (6.5a)÷(6.5d) precisely in the case of the Gaussian kernel with unit variance.
In the several figures that follow, where q1(t) is plotted against q2(t), the thick diagonal line has equation q1 = q2 (or 12 = 0). Since we assume that q2 > q1 the dynamics of the system take place above such line (see, for example, Figure 6.2: the
109

details regarding such Figure will be discussed later; note also that the scale may change from figure to figure). Proceeding from bottom to top, the next (dashed) diagonal line represents the points where q2 - q1 = m, i.e. the points where curvature has its minimum; the next (continuous) diagonal line represents the points where q2 - q1 = z, i.e. the points where curvature has a zero; finally, the next (dash-dotted) diagonal line represents the points where q2 - q1 = M, i.e. the points where curvature has its maximum; above the latter line curvature is positive, and converges to zero from above as q2 - q1  +. We shall now analyze the nine cases listed in Table 6.1 in some detail.

Remark. Before proceeding, we should note some immediate consequences of

the conservation laws that hold for all cases listed in Table 6.1. For example, when

either one of the initial momenta is zero then by the strong conservation law (6.6)

such momentum remains equal to zero for all time; if this is the case, then the other

momentum is constant in time by the weak conservation law (6.3).

Also,

note

that

for

any

t

the

map





t()

is

a

diffeomorphism,

whence

t 

(

)

=

0

for

all

pairs

(t, );

but

for

any



the

map

t



t 

(

)

is

continuous

and

t 

t=0

=

1,

therefore

t 

(

)

>

0

for

all

pairs

(t, ).

Whence

by

the

strong

conservation

law

(6.6)

if pi(0) = 0 then pi(t) never changes sign in finite time and in particular never becomes

zero. This implies, for example, that if the two landmarks collide into one another

with opposite initial velocities then they will not "bounce" and escape to infinity in

opposite directions, since this would imply a change of sign for both momenta; we

shall provide the details of this instance later on (Case 6).

Case 1 (p1 > 0, p2 = 0). By the strong conservation law (6.6) we have p2(t)  0 for all t  [0, 1]; a direct consequence of this, together with the weak conservation law (6.3), is that p1(t)  p1(0) for all t  [0, 1]. By equations (6.5a) and (6.5b) the first landmark moves to the right with constant speed q1(t) = (0)p1(0) and "pushes" the second landmark, whose speed increases as 12 decreases since q2(t) = ( 12)p1(0) and  is monotone decreasing. The whole picture is provided by the following result.
110

q2(t)

10 9 8 7 6 5 4 3 2 1 0 0 1 2 3 4 5 6 7 8 9 10 q1(t)
Figure 6.2. Six trajectories in Case 1: q1(0), q2(0) = (0, 1), (0, 2), . . . , (0, 6) and, in all six cases, p1(0), p2(0) = (10, 0).
Proposition 6.3. Under the hypotheses of Case 1, i.e. p1(0) > 0 and p2(0) = 0, we have that p1(t)  p1(0), p2(t)  0, q1(t)   and q2(t)   with 12(t)  0 as t  . Also, q1(t)  (0)p1(0) for all t and q2(t)  (0)p1(0) as t  .

Proof. Equation (6.7) becomes

d dt

12 = - (0) - (

12)

p1(0) < 0,

so 12(t) is a monotone decreasing and positive function; whence it converges. This

implies

that

d dt

12(t)  0 as t  , so that, by the above equation, 

12(t)  (0);

therefore 12(t)  0 by the monotonicity of function . The rest of the proof descends

directly from the equations (6.5a) and (6.5b).

Typical trajectories in the (q1, q2) plane are shown in Figure 6.2.

Case 2 (0 < p2 < p1). In this case both landmarks initially move to the right, with the first one moving faster than the second one and therefore approaching it. It is not the case anymore that either p1(t) or p2(t) remain constant, but by the weak
111

conservation law their summation p1(t) + p2(t) does. The interesting phenomenon that happens is that the second landmark "bounces" off the first one, and the two momenta are eventually "swapped" between the two; we will later provide a rigorous justification of such a behavior. This is illustrated in Figure 6.3: the top graph shows the time evolution of q1(t) and q2(t), whereas the bottom portion illustrates the corresponding time evolution of momenta p1(t) and p2(t); note that p1(t) + p2(t) is constant in time. Figure 6.4 shows the same trajectory in the (q1, q2) plane; since initial velocities are eventually swapped the final slope of the curve is the inverse of the initial slope. The following result holds.

Proposition 6.4. Under the hypotheses of Case 2, i.e. 0 < p2(0) < p1(0), we have that q1(t)  , q2(t)   and 12(t)   as t  . Also,

lim
t

p1(t)

=

lim
t-

p2(t),

i.e. the two momenta are swapped.

lim
t

p2(t)

=

lim
t-

p1(t),

Proof. Differential equation (6.7) holds for the mutual distance 12:

d dt

12 =

(0) - 

12

(p2 - p1).

Factor [(0)-( 12)] is always positive, so that the sign of the right-hand side of (6.7)

depends only on the difference p2 - p1, and is initially negative; whence 12(t) initially decreases. By the strong conservation law momenta p1(t) and p2(t) are always positive in finite time therefore

p1 =  12 p1p2 < 0, p2 = - 12 p1p2 > 0,

i.e. p1(t) and p2(t) are respectively monotone decreasing and increasing. But we have that p1(t) > 0, so it will converge so some positive value p1(); on the other hand p2(t) < p1(0) + p2(0) so it will also converge to some positive value p2().
We now claim that there exists a finite time t such that p1(t) = p2(t). We will reason by contradiction, assuming that p1(t) > p2(t) for all t > 0; in particular,
112

16 14 12 10
8 6 4 2 0
0 0.5 1 1.5 2 2.5 3 3.5 4 Time
10 9 8 7 6 5 4 3 2 1 0 0 0.5 1 1.5 2 2.5 3 3.5 4 Time
Figure 6.3. Trajectory in Case 2: q1(0), q2(0)) = (0, 1), p1(0), p2(0) = (9, 1). The top and bottom graphs represent, respectively, the evolution of positions and momenta versus time. Note that the second landmark (dashed line) bounces off the first one (continuous line) and eventually the two momenta are swapped.
we assume that p1()  p2() > 0. If this is true 12(t) is a monotone decreasing function for t  0 by (6.7) and it must necessarily be the case that 12(t)  0 as t  ; in fact if 12(t)  D, for some D > 0, then p1(t)   (D) p1() p2() < 0 and p2(t)  - (D) p1() p2() > 0 as t  , which would imply that the graphs of p1 and p2 cross, immediately reaching a contradiction. So our hypothesis implies that 12(t)  0.
113

q2(t)

14 12 10
8 6 4 2 0
0 2 4 6 8 10 12 14 q1(t)
Figure 6.4. The same trajectory of Figure 6.3 drawn in the (q1, q2) plane.
Let us study the convexity of function p2(t). Differentiating equation (6.5d) and subsequently inserting equations (6.7), (6.5a) and (6.5b) yields:

p¨2 = - = -
(6.8) = 

12 12 p1p2 -  12 p1p2 -  12 p1p2 12 (0) -  12 (p2 - p1)p1p2 -  12 2p1p22 +  12 (0) -  12 +  12 2 p1p2(p1 - p2).

12 2p12p2

By our hypothesis it must be the case that p1p2(p1 - p2) > 0, so that the sign of p¨2 is determined by the factor in the curly braces; note that the first term in the braces is negative near zero and positive away from zero (this is determined by the sign of  ) while the second term is always positive. However, since 12(t)  0 as t  , we
114

are allowed to consider the following approximations:

(0) -  

12

=

-

1 2



(0)

12 =  (0) + o

12 2 + o
12

12 2

 12 =  (0) 12 + o 12

 12 2 =  (0) 2 12 2 + o 12 2 .

since  (0) = 0, since  (0) = 0, since  (0) = 0,

Inserting the above into the expression in curly braces in (6.8) yields:

 12 (0) -  12 +  12 2

=

-

1 2



(0)

2

12 2 + o

12 2 +  (0) 2

=

1 2



(0)

2

12 2 + o

12 2 ,

12 2 + o

12 2

so that we may conclude that p¨2 > 0 (and p¨1 = -p¨2 < 0) once 12 reaches a neighborhood of zero. This implies that from that time onwards p2(t) is convex (and p1(t) is concave); in particular it cannot be that p2(t) converges to a finite limit (nor can p1(t)), which is a contradiction.
The time t defined above is the "crossing point" of Figure 6.3; when this occurs by equation (6.7) the time derivative 12 changes sign, so that the distance between the landmarks starts increasing (in the (q1, q2) plane, the angle between the tangent vector to the trajectory and the q1 axis reaches 45, and keeps increasing). We should now note that the evolution of p1(t) and p2(t) depends on positions q1(t) and q2(t) only through their difference 12 = q2 -q1, i.e. if one is interested only in the evolution of momenta it is sufficient to consider (6.5c) and (6.5d) in conjunction with ordinary differential equation (6.7), with the appropriate initial conditions. We will now reverse
115

time by defining ~12(s) = 12(-s), p~1(s) = p1(-s), p~2(s) = p2(-s). We have that

d ds

p~1(s)

=

-

dp1 dt

t=-s

= -

12(-s) p1(-s) p2(-s) = - ~12(s) p~1(s) p~2(s),

d ds

p~2(s)

=

-

dp2 dt

t=-s

= +

12(-s) p1(-s) p2(-s) = + ~12(s) p~1(s) p~2(s),

d ds

~12(s)

=

-

d 12 dt

t=-s

=-

(0) - 

12(-s)

p2(-s) - p1(-s)

= (0) -  ~12(s) p~1(s) - p~2(s) ,

so that the evolution of ~12, p~1 and p~1 is determined by the following system of ordinary differential equations:

~12 = (0) -  ~12 (p~1 - p~2), p~1 = - ~12 p~1p~2 , p~2 =  ~12 p~1p~2 ,

which are the same as (6.7), (6.5c) and (6.5d), except that the roles of p1 and p2 are exchanged . This implies that starting from the same initial conditions at the "crossing point" of Figure 6.3 the evolution of p~1(s), s > 0 will be the same as that of p2(t), t > 0 and the evolution of p~2(s), s > 0 will be the same as that of p1(t), t > 0; that is, the evolution in the past of p1 will be the same as the evolution in the future of p2, and vice versa. In conclusion, p1(-) = p2() and p2(-) = p1(), so that momenta are eventually swapped between the two landmarks.

It is especially interesting in this case to study trajectories in different regions of the (q1, q2) plane; specifically, in regions of positive and negative curvature. It should first be noted that the behavior described above (the "bouncing" and swapping of momenta) is common to all regions, therefore, independently of where the trajectory originates, since 12   the point q1(t), q2(t) will eventually end up in the region of positive curvature (characterized by q2 - q1 > z). However, it turns out that trajectories that originate at a common point in the region of positive curvature may exhibit conjugate points, as illustrated in Figure 6.5. Note that a trajectory that originates at a point in the region of positive curvature may enter the region of negative
116

q2(t)

10
9
8
7
6
5
4
3
2
1
0 0 1 2 3 4 5 6 7 8 9 10 q1(t)
Figure 6.5. Conjugate points for trajectories that originate at a common point in the region of positive curvature (Case 2).
curvature (if, for example, p1 p2 > 0) and then "bounce back" in the region of positive curvature, where it could have a conjugate point with another trajectory that originated at the same point. On the other hand, as illustrated in Figure 6.6, trajectories that originate at a common point in the region of negative curvature, never cross again within such region; however, they may meet again, i.e. have conjugate points, once they enter the region of positive curvature (Figure 6.7).
Case 3 (0 < p1 = p2). The graphs and trajectories relative to this case can be inferred from those of Case 2. In fact, with reference to Figure 6.3, the trajectories start from the point where the momenta are the same (the "crossing point" of the bottom graph) and then are completely the same as in Case 2, with the two momenta settling to two final values p2 > p1 > 0 and both landmarks diverging (the second one faster than the first one).
For a fixed pair of (equal) initial momenta, the values of the final momenta depend on the starting point on the (q1, q2) plane, i.e. on the initial distance between the landmarks. More precisely, the following result holds.
117

8

7

6

5

q2(t)

4

3

2

1

0 012345678 q1(t)
Figure 6.6. Trajectories that originate at the same point in the region
of negative curvature (Case 2).

Proposition 6.5. Under the hypotheses of Case 3, i.e. 0 < p2(0) = p1(0), we have that q1(t)  , q2(t)   with 12(t)   as t  . Also,

p1()

lim
t

p1

(t)

=

p1(0)

1-

 12(0) (0)

< p1(0)

and

p2()

 12(0)

lim
t

p2(t)

=

p1(0)

1+

(0)

> p2(0).

In particular if 12(0) 0 we have that p1() 0 and p2() 2p1(0), i.e. the transfer of momentum between the landmarks is almost complete.

Proof. By the strong conservation law momenta must be positive for all time,

whence by equations (6.5c) and (6.5d) we must have p1 < 0 and p2 > 0. So p1(t) increases and p2(t) decreases with time; consequently p2 - p1 > 0 for t > 0. The following equation holds:

d dt

12 =

(0) - ( 12) (p2 - p1) > 0;

118

30

25

20

q2(t)

15

10

5

0 0 5 10 15 20 25 30 q1(t)
Figure 6.7. Trajectories that originate at the same point in the region of negative curvature and meet again in the region of positive curvature (Case 2). Dashed trajectory: q1(0), q2(0) = (0, 1.3), p1(0), p2(0) = (7, 3). Continuous trajectory: q1(0), q2(0) = (0, 1.3), p1(0), p2(0) = (5.01, 4.99).

since both factors on the right-hand side increase in time it must be the case that 12   as t  . By (6.3) and (6.4) it is the case that

(6.9)

p1() + p2() = 2p1(0),

 12(0) p1() p2() = 1 - (0)

p21(0) ,

since lim  ( ) = 0. Combining the above equations implies

p21() - 2p1(0)p1() +

1- 

12(0) (0)

p12(0) = 0,

which in turn yields

p1() = p1(0) 1 ±

 12(0) (0)

;

the minus sign must be picked since p1(t) is a decreasing function. The result

for p2() follows immediately from (6.9).

119

q2(t)

20
18
16
14
12
10
8
6
4
2
0 0 2 4 6 8 10 12 14 16 18 20 q1(t)
Figure 6.8. Trajectories with initial momenta p1(0), p2(0) = (5, 5) but different initial positions (Case 3). Figure 6.8 shows different landmark trajectories in the (q1, q2) plane which all have common initial momenta p1(0), p2(0) = (5, 5) but different starting points q1(0), q2(0) = (0, k · 0.12), k = 1, 2, . . . , 35.

Case 4 (0 < p1 < p2). Most of the relevant information on this case can be inferred from the previous graphs. For example, momenta evolve in time as in Figure 6.3, except that only the portion of the graph relative to some time after the "crossing point" of momenta should be considered. We should note that since p2 > p1 > 0 the initial tangent vectors to trajectories in the (q1, q2) plane form an angle with the q1 axis that is greater than 45.

Proposition 6.6. Under the hypotheses of Case 4, i.e. 0 < p1(0) < p2(0), we have that q1(t)  , q2(t)   with 12(t)   as t  . Also

lim
t

p1(t)

=

p1(0) + p2(0) 2

1-

1-4

1- 

12(0) (0)

p1(0)p2(0) [p1(0) + p2(0)]2

120

and

lim
t

p2(t)

=

p1(0) + p2(0) 2

1+

 12(0) 1 - 4 1 - (0)

p1(0)p2(0) [p1(0) + p2(0)]2

.

Note that setting p1(0) = p2(0) yields the result of Proposition 6.5.

Proof. The fact that 12(t)   as t   is proven exactly as in Proposition 6.5. As far as momenta are concerned, we have that

p1() + p2() = p1(0) + p2(0),  12(0)
p1() p2() = 1 - (0)

p1(0)p2(0) ,

since lim  ( ) = 0. Combining the above equations implies:

p12() -

p1(0) + p2(0) p1() +

 1-

12(0) (0)

p1(0)p2(0) = 0.

Solving the above quadratic equation yields the result.

Figure 6.9 shows two sets of eight trajectories. The two sets start from points q1(0), q2(0) = (0, 1) and (0, 5) respectively, and within each set the eight initial momenta are p1(0), p2(0) = (4.5, 5.5), (4, 6), (3.5, 6.5), (3, 7), (2.5, 7.5), (2, 8), (1.5, 8.5), and (1, 9), for both sets.

Case 5 (p1 = 0, p2 > 0). As in Case 1, since one of the two momenta is initially equal to zero the conservation laws imply that both momenta remain constant at all time; whence p1(t)  0 and p2(t)  p2(0) for all t. What happens is that if the two landmarks are initially close then the first one is "dragged" by the second one for a while, until the latter detaches itself and escapes to infinity, leaving the former virtually still. More precisely, the following holds.
Proposition 6.7. Under the hypotheses of Case 5, i.e. p1(0) = 0 and p2(0) > 0, we have that p1(t)  0, p2(t)  p2(0), q2(t)  (0)p2(0) and q1(t)  0 as t  . That is, q1(t) converges and q2(t)   as t  .
121

q2(t)

10 9 8 7 6 5 4 3 2 1 0 0 1 2 3 4 5 6 7 8 9 10 q1(t)
Figure 6.9. Two sets of trajectories for Case 4, which share common initial momenta but have two different starting positions.
12
10
8
6
4
2
0 0 2 4 6 8 10 12 q1(t)
Figure 6.10. Trajectories for Case 5, all with initial momenta p1(0), p2(0) = (0, 10) but different initial positions.
122

q2(t)

Proof. Equations (6.5a) and (6.5b) become, respectively, q1 = ( 12)p2(0) and q2 = (0)p2(0); the latter velocity is constant and positive, therefore q2(t)  + as t diverges. As far as the mutual distance 12 is concerned, the ordinary differential

equation

d dt

12 = q2 - q1 =

(0) - 

12

p2(0) > 0

holds; since the right-hand side is always positive function 12(t) is monotone in-

creasing. Whence q1 is monotone decreasing by (6.5a), i.e. the first landmark

slows down in time; we will now argue that it comes to a virtual stop. In fact

d dt

12(t) =

(0) - ( 12(t)) p2(0) >

(0) - 

12(0)

p2(0) for all t because 12(t) is

monotone increasing, which implies, by integration, that

12(t) > 12(0) + (0) - ( 12(0)) p2(0) t ,

whence 12(t) diverges as t  . When 12 becomes large enough we have ( 12) 0, therefore the dragging effect stops and the first landmark comes to a halt while the second diverges to infinity with constant speed.

Figure 6.10 shows some typical trajectories for this case, with initial momenta all equal to p1(0), p2(0) = (0, 10) and initial positions q1(0), q2(0) = (0, k · 0.2), k = 1, . . . , 12; note that all trajectories eventually become virtually vertical.

Case 6 (p1 > 0, p2 < 0, with p1 = |p2|). What qualitatively happens in this case is that the two landmarks q1(t) and q2(t) converge towards each other without bouncing back, as we mentioned in a previous remark, while their momenta p1(t) and p2(t) diverge to plus and minus infinity, respectively.

Proposition 6.8. Under the hypotheses of Case 6, i.e. 0 < p1(0) = -p2(0), it

is

the

case

that

qi(t)



q1(0)+q2 2

(0)

,

for

i

=

1, 2,

and

12(t)  0 as t  . Also,

p1(t)   and p2(t)  - as t  .

Proof. Assuming p1(0) + p2(0) = 0, we have by the weak conservation law that p2(t) = -p1(t) for all t. Therefore ordinary differential equations (6.5a)
123

4 3.5
3 2.5
2 1.5
1 0.5
0 0

0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 Time

2

150

100

50

0

-50

-100

-150 0

0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 Time

2

Figure 6.11. Evolution of positions (top) and momenta (bottom) ver-

sus time in Case 6. The continuous lines represent q1(t) and p1(t), while the dashed lines represent q2(t) and p2(t).

and (6.5b) may be written as:

(6.10a) (6.10b)

q1 = (0) - ( 12) p1(t), q2 = ( 12) - (0) p1(t);

in particular, we note that q2(t) = -q2(t) at all time. As far as the differential equations for momenta (6.5c) and (6.5d) are concerned, we have

(6.10c) (6.10d)

p1 = - ( 12) p21(t) > 0, p2 =  ( 12) p22(t) < 0;
124

therefore p1(t) and p2(t) are monotone increasing and decreasing, respectively. Combining (6.10a) and (6.10b) yields the ordinary differential equation

(6.11)

d dt

12 = q2 - q1 = 2 ( 12) - (0) p1(t);

the right-hand side is always negative since ( 12) < (0), p1(0) > 0 and p1(t) is monotone increasing by (6.10c). This implies that the mutual distance 12(t) is a monotone

decreasing, continuously differentiable, lower bounded function;

hence

d dt

12(t)  0

as t  . Since p1(t) is strictly positive and monotone increasing, by (6.11) we have

that that  12(t)  (0), i.e., by the monotonicity of function , that 12(t)  0

as t  . In order to prove the divergence of the momenta we will use the formula

on the product of momenta (6.3); since p1(t) = -p2(t) at all time we have that

p1(t) =

(0) -  (0) - 

12(0) 12(t)

p1(0),

whence p1(t)  + (and p2(t)  -) as t  .

Figure 6.11 shows exactly this behavior for initial positions q1(0), q2(0) = (0, 4) and momenta p1(0), p2(0) = (5, -5).

Case 7 (p1 > 0, p2 < 0, with p1 > |p2|). This case is similar to the previous one except that, since p1 is initially larger (in absolute value) than p2, when the collision occurs the "stronger" landmark prevails and the two eventually diverge together to +, with their mutual distance 12(t) quickly converging to zero (see Figure 6.13). Even though the second landmark eventually travels toward + its momentum never changes sign from negative to positive (by the strong conservation law) and in fact diverges to -; p1(t) also diverges (to +), but by the weak conservation law it is always the case that p1(t) maintains "the edge" against p2(t) (exactly by the difference p1(0) - |p2(0)|) so that the two landmarks finally travel together, at virtually constant positive speed.

Proposition 6.9. Under the hypotheses of Case 7, i.e. p1(0) > 0, p2(0) < 0 with p1(0) > |p2(0)|, it is the case that q1(t)  , q2(t)   with 12(t)  0
125

as t  . Also, p1(t)  , p2(t)  - and qi(t)  (0)[p1(0) + p2(0)], i = 1, 2, as t  .

Proof. Let p p1(t) + p2(t) = p1(0) + p2(0) > 0; we can write

d dt

12 =

(0) - 

12

(p2 - p1)

(6.12)

= 2 (0) -  12 p2 +  12 - (0) p.

Since p > 0 and p2(t) < 0 for all t both terms on the right-hand side of the above equation are always negative, therefore 12(t) is a monotone decreasing, continuously

differentiable

function

bounded

from

below,

so

that

d dt

12(t)  0 as t  ; whence

both terms on the right-hand side of (6.12) must converge to zero as t  . In

particular  12(t)  (0) so that, by the monotonicity of , it must be the case

that 12(t)  0. Now, combining equations (6.3) and (6.4) yields

p12(t)

-

p

p1(t)

+

(0) (0)

- -

 

12(0) 12(t) p1(0) p2(0) = 0,

where we have used p2 = p - p1, which yields:

p1(t)

=

p 2

±

p 2

2 (0) -  - (0) - 

12(0) 12(t) p1(0) p2(0);

the plus sign must be chosen since p1(t) is an increasing function. Analogously,

p2(t)

=

p 2

-

p 2

2 - (0) -  (0) - 

12(0) 12(t)

p1(0) p2(0).

Taking limits for t   proves the divergence of momenta. Finally, note that we

can rewrite ordinary differential equation (6.5a) as follows:

q1 = (0) p - (0) - 

12

p2 = (0) p - (0) - 

12(0) p1

p1(0)p2(0) ,

where we have used (6.4). Since p1(t)   as t   we also have q1(t)  (0)p.

A similar reasoning holds for q2(t).

The situation described above is illustrated in Figure 6.12, where a the evolution of positions and momenta is shown for initial conditions q1(0), q2(0) = (0, 4) and p1(0), p2(0) = (8, -5). Note that in this particular instance the two landmarks are
126

5 4.5
4 3.5
3 2.5
2 1.5
1 0.5
0 0 0.5 1 1.5 2 2.5 Time
2000 1500 1000
500 0
-500 -1000 -1500 -2000
0 0.5 1 1.5 2 2.5 Time
Figure 6.12. A typical trajectory for Case 7, plotted against time. Top: positions; bottom: momenta. Continuous line: first landmark; dashed line: second landmark.
initially relatively far, so that they initially travel at virtually constant speeds q1 (0)p1(0) > 0 and q2 (0)p2(0) < 0, with |q2| < q1; as they get closer they start feeling each other's influence, and eventually both move linearly together with positive speed. Figure 6.13 shows three sets of eight trajectories in the (q1, q2) plane. The three sets start at initial positions q1(0), q2(0) = (0, 0.75), (0, 2), and (0, 4) respectively; within each set, the eight trajectories have initial momenta p1(0), p2(0) = (5.5, -5), (6, -5), (6.5, -5), (7, -5), (7.5, -5), (8, -5), (8.5, -5), and (9, -5). The farther away the two landmarks start from each other, the straighter are the trajectories initially; all trajectories eventually converge to the q1 = q2 diagonal line. It is perhaps useful
127

q2(t)

5 4.5
4 3.5
3 2.5
2 1.5
1 0.5
0 0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5 q1(t)
Figure 6.13. Three sets of trajectories in Case 7.
to remark that if it were the case that p2(0) = -p1(0) < 0 (Case 6) the trajectory in the (q1, q2) plane would be a straight line perpendicular to the q1 = q2 diagonal line.

Case 8 (p1 < 0, p2 > 0, with |p1| = p2). In this situation the two landmarks are pulling away from each other, with equal (in absolute value) but opposite initial momenta. When the two landmarks are finally far away from each other, they break free and diverge with constant speed in opposite directions, having exchanged a certain amount of momentum prior to this.

Proposition 6.10. Under the hypotheses of Case 8, i.e. p2(0) = -p1(0) > 0, it is the case that q1(t)  - and q2(t)  + as t  . Also,

 12(0)

lim
t

pi(t)

=

pi(0)

1-

(0) ,

i = 1, 2.

Proof. Since p1(0) + p2(0) = 0, by the weak conservation law we will have that p1(t) + p2(t) = 0 for all t. By the strong law p1(t) < 0 and p2(t) > 0 for all time.
128

Equations (6.5a) and (6.5b) become, respectively:

q1 = ( 12) - (0) p2 < 0, q2 = (0) - ( 12) p2 = -q1 > 0,

so

that

d dt

12 = q2 - q1 = 2 (0) - 

12

p2 > 0. Therefore 12(t) is an increasing

function of time; we claim that 12(t)  .

Since 12(t) > 12(0) and (·) is monotone decreasing, we have

(6.13)

d dt

12(t) = 2 (0) - 

12(t)

p2(t) > 2 (0) - 

12(0)

p2(t);

but by (6.4) and the fact that p1(t) = -p2(t) we also have

p22(t)

=

p22(0)

(0) (0)

- -

 

12(0) 12(t)

,

that is

(6.14)

(0) -  12(0) p2(t) = p2(0) (0) -  12(t)

 12(0) > p2(0) 1 - (0) .

Therefore (6.13) becomes

d dt

12(t) > 2 (0) - 

12(0)

p2(0)

1- 

12(0) (0)

;

the right-hand side is a positive number that does not depend on time, therefore 12(t)   as t  . Finally, expression (6.14) implies

 12(0)

lim
t

p2(t)

=

p2(0)

1-

(0) ;

the result for p1(t) follows from p1(t) = -p2(t).

The situation is illustrated in Figure 6.14 for initial conditions q1(0), q2(0) = (-0.15, 0.15), p1(0), p2(0) = (-5, 5).

129

1.5
1
0.5
0
-0.5
-1
-1.5 0 0.5 1 1.5 2 2.5 3 3.5 4 Time
5 4 3 2 1 0 -1 -2 -3 -4 -5
0 0.5 1 1.5 2 2.5 3 3.5 4 Time
Figure 6.14. A typical trajectory for Case 8, plotted against time. Top: positions; bottom: momenta. Continuous line: first landmark; dashed line: second landmark. Note the exchange of momentum that occurs in the first part of the trajectory, when the two landmarks are relatively close.
Case 9 (p1 < 0, p2 > 0, with |p1| < p2). This case is similar to the previous one, except that the second landmark "pulls to the right" more than the first one "pulls to the left", thus if the two start close enough to each other the former initially drags the latter to the right for a while, until the two eventually detach from each other. In the process some momentum is exchanged, as shown in Figure 6.15, which refers to the initial data q1(0), q2(0) = (-0.1, 0.1) and p1(0), p2(0) = (-5; 9).
130

30 25 20 15 10
5 0 -5
0 2 4 6 8 10 12 14 16 Time
10

5

0

-5 0 2 4 6 8 10 12 14 16 Time
Figure 6.15. A typical trajectory for Case 9, plotted against time. Top: positions; bottom: momenta. Continuous line: first landmark; dashed line: second landmark.

Proposition 6.11. Under the hypotheses of Case 9, i.e. p1(0) < 0, p2(0) > 0 with |p1(0)| < p2(0), it is the case that q1(t)  - and q2(t)   as t  . Also,

lim
t

p1

(t)

=

p 2

+

p 2

2
-

1- 

12(0) (0)

p1(0) p2(0)

and

lim
t

p2(t)

=

p 2

-

p 2

2
-

1- 

12(0) (0)

p1(0) p2(0),

where p p1(0) + p2(0) = p2(0) - |p1(0)| > 0.

131

Proof. We have that p1(0) + p2(0) = p > 0. By the weak conservation law p2(t) = p - p1(t) for all t. Equations (6.5a) and (6.5b) can be written as:

q1 = (0) p1 + ( 12) (p - p1) = (0) -  12 p1 +  12 p

q2 = ( 12) p1 + (0) (p - p2) =  12 - (0) p1 + (0) p

so

that

d dt

12 = 2 

12 - (0) p1 + (0) - 

12

p > 0; in fact, both terms on

the right-hand side are positive; since 12(t) is monotone increasing,

d dt

12 

(0) - 

12(t)

p  (0) - 

12(0)

p,

so that 12(t)  12(0) + (0) -  12(0) p · t, i.e. 12(t)   as t  . Manipulating equations (6.3) and (6.4) yields

p22(t)

-

p

p2(t)

+

(0) (0)

- -

 

12(0) 12(t) p1(0) p2(0) = 0,

whose solution is

p2(t)

=

p 2

+

p 2

2 (0) -  - (0) - 

12(0) 12(t) p1(0) p2(0);

taking the limit for t   completes the proof.

Figure 6.16 shows three sets of eight trajectories in the (q1, q2) plane. The three sets start at initial positions q1(0), q2(0) = (-0.1, 0.1), (-0.5, 0.5), (-2.5, 2.5) respectively; within each set, the eight trajectories have initial momenta p1(0), p2(0) = (-5, 5.5), (-5, 6), (-5, 6.5), (-5, 7), (-5, 7.5), (-5, 8), (-5, 8.5), and (-5, 9). Once again, the farther away the two landmarks start from each other, the straighter are the trajectories initially. In any case, all trajectories eventually straighten as the two landmarks get farther away from each other.

Remark. After having analyzed in detail all nine cases listed in Table 6.1 we should note that we have implicitly shown that in the case of two landmarks in one dimension the dynamical system 6.1 admits no closed orbits. Franc¸ois-Xavier Vialard provides an alternative and elegant short proof of this fact [44]. However, it
132

q2(t)

5 4 3 2 1 0 -1 -2 -3 -4 -5 -5 -4 -3 -2 -1 0 1 2 3 4 5
q1(t)
Figure 6.16. Three sets of trajectories for Case 9. is currently not known weather such result can be extended to landmarks in D  2 dimensions.
3. Dynamics of three one-dimensional landmarks In this brief section we show the qualitative behavior of three one-dimensional landmarks for some sets of initial conditions and draw some comparison with the case of two landmarks in one dimension, which was thoroughly analyzed in the previous section. Hamilton's equations for three one dimensional landmarks are:
q1 = (0) p1 + ( 12) p2 + ( 13) p3 q2 = ( 12) p1 + (0) p2 + ( 23) p3 q3 = ( 13) p1 + ( 23) p2 + (0) p3 p1 = + 12 p1p2 +  13 p1p3 p2 = - 12 p1p2 +  23 p2p3 p3 = - 13 p1p3 -  23 p2p3 ;
133

POSITIONS 14
12
10
8
6
4
2 q1 q2 q3
0 0 0.5 1 1.5 Time
Figure 6.17. Positions and momenta versus time for Example 1 (p1(0) > 0, p2(0) = p3(0) = 0). Landmark 1: thin line; Landmark 2: thick line; Landmark 3: thick dashed line. we shall limit ourselves to illustrating three possible combinations of initial conditions for positions and momenta.
Example 1. (p1(0) > 0, p2(0) = p3(0) = 0) In this case, by the strong law, the momenta for the second and third landmarks are identically equal to zero in time and consequently p1(t)  p1(0) by the weak law. Therefore the velocity of the first landmark is constant it time, q1 = (0)p1(0), and the remaining two landmarks are "pushed" to + by the first one, without bouncing off; this type of behavior is completely analogous to the one of the two landmarks in one dimension of Case 1; see Figure 6.17.
Example 2. (p1(0) p2(0) = p3(0) > 0) In this case all three landmarks have strictly positive momenta, so that "transfer" of momentum among them is possible, as it happened in Case 2 for two one-dimensional landmarks. The first landmark is initially much faster than the other two, and eventually bumps into the second one;
134

120 100
80 60 40 20
0 0

POSITIONS

q1 q2 q3

5 10 15 20 25 Time

MOMENTA 12
10

p1 p2 p3

8

6

4

2

0 0 5 10 15 20 25 Time
Figure 6.18. Positions and momenta versus time for Example 2 (p1(0) p2(0) = p3(0) > 0); large initial mutual distances. Landmark 1: thin line; Landmark 2: thick line; Landmark 3: dashed line.

momentum is swapped between the first and the second one, and later between the second one and the third one. Eventually the latter escapes to infinity at great speed, leaving the first and second one behind (at nonzero positive speed). Figures 6.18 and 6.19 refer, respectively, to the cases of large and small initial mutual distances; in the latter case the second landmark never gains "full" momentum, since this is transferred directly to the third one in an intermediate phase when all three landmarks travel closely to each other.

135

120 100
80 60 40 20
0 0

POSITIONS

q1 q2 q3

5 10 15 20 25 Time

MOMENTA 12
10

p1 p2 p3

8

6

4

2

0 0 5 10 15 20 25 Time
Figure 6.19. Positions and momenta versus time for Example 2 (p1(0) p2(0) = p3(0) > 0); small initial mutual distances. Landmark 1: thin line; Landmark 2: thick line; Landmark 3: dashed line.

Example 3. (p1(0) > 0, p2(0) < 0, p3(0) < 0, with p1(0) > |p2(0) + p3(0)|) This case is analogous to Case 7 for two one-dimensional landmarks. The first landmark collides into the other two, which initially travel in the opposite direction. Since p1(0) > |p2(0) + p3(0)| the three eventually travel together towards +; note that the three momenta diverge, to +, - and - respectively. See Figure 6.20.
136

POSITIONS 4
3.5
3

q1 q2 q3

2.5

2

1.5

1

0.5

0 0 0.5 1 1.5 2 2.5 Time

1500 1000

MOMENTA

p1 p2 p3

500

0

-500

-1000

-1500 0 0.5 1 1.5 2 2.5 Time
Figure 6.20. Positions and momenta versus time for Example 3 (p1(0) > 0, p2(0) < 0, p3(0) < 0, with p1(0) > |p2(0) + p3(0)|). Landmark 1: thin line; Landmark 2: thick line; Landmark 3: dashed line.
4. Dynamics of two two-dimensional landmarks

In this section we briefly analyze the qualitative behavior of two landmarks interacting with each other. We should say right away that while the dynamics of two landmarks are fully understood, it is not the case for two landmarks in two dimensions. Further research is needed, and here we shall limit ourselves to describe the observed qualitative phenomena.
If the two landmarks have initial momenta that lie on the same line, i.e. p1(0) = kp2(0) for some k  R, then the problem is reduced to the one-dimensional case that
137

was fully explored in section 2. For example, if

(6.15)

p2(0) = -p1(0)

and the momenta point "towards" each other, we are exactly in the situation described in Case 6 for two landmarks in one dimension. Since we are in two dimensions we are allowed to modify the angle of collision. For example Figure 6.21 shows the trajectories of two landmarks in two dimensions with initial positions

q1(0) = (1, 0),

q2(0) = (-1, 0),

and initial momenta

p1(0) = (-10, 8.6),

p2(0) = (10, -8.6)

(as usual, we are using a Gaussian kernel with unit variance); that is, situation (6.15) is perturbed by adding "opposite angles" to each of the initial momenta. As in case (6.15) the two landmarks eventually collide (in infinite time) by spinning around one another a countably infinite number of times. Figure 6.22 is a zoomed-in version of Figure 6.21 around the origin (note the different scale on the axes). As far as momenta are concerned, it is still the case that both p1(t) and p2(t) diverge as t  .

Remark. We should remind the reader that the landmark trajectories illustrated in Figures 6.21 and 6.22, despite being apparently complicated around the origin, are in fact generated by flows of diffeomorphisms of the plane. Such diffeomorphisms can be computed from the trajectories by implementing the techniques discussed in Chapter 2.

If we increase the value of the angle between the initial momenta beyond a certain threshold we have a bifurcation in the qualitative behavior of trajectories. This is illustrated in Figure 6.23 for initial positions

q1(0) = (1, 0),

q2(0) = (-1, 0),
138

Landmark Trajectories 1

0.8

0.6

0.4

0.2

0

-0.2

-0.4

-0.6

-0.8

p1(0) = (-10,8.6) p2(0) = (10,-8.6)

-1 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1

Figure 6.21. Converging trajectories for two landmarks in 2D.

0.02

Landmark Trajectories

0.015

0.01

0.005

0

-0.005

-0.01

-0.015

p1(0) = (-10,8.6) p2(0) = (10,-8.6)

-0.02 -0.02 -0.015 -0.01 -0.005 0 0.005 0.01 0.015 0.02

Figure 6.22. Converging trajectories for two landmarks in 2D--detail. and initial momenta

p1(0) = (-10, 9),

p2(0) = (10, -9).

139

Landmark Trajectories 1

0.8

0.6

0.4

0.2

0

-0.2

-0.4

-0.6

-0.8

p1(0) = (-10,9) p2(0) = (10,-9)

-1 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8 1

Figure 6.23. Diverging trajectories for two landmarks in 2D.

We observe that the two landmarks still spin around one another for a while, but eventually escape to infinity in opposite directions. The corresponding momenta (graphs not shown) eventually converge to finite values (p1() + p2() = 0 by the conservation of linear momentum) that determine the escape velocities of landmarks.

A similar behavioral pattern is observed when initial condition (6.15) is perturbed by adding an angle to each initial momentum "in the same direction"; this is depicted in Figure 6.24, which refers to initial positions

q1(0) = (2, -4),

q2(0) = (-2, -4),

and initial momenta

p1(0) = (-12, 10),

p2(0) = (12, 10);

in this case the two landmarks still converge and collide in infinite time. However, if the angle between the initial momenta is further increased beyond a certain threshold,
140

Landmark Trajectories 6

4

2

0

-2

-4 p1(0) = (-12,10) p2(0) = (12,10)
-6 -6 -4 -2 0 2 4 6
Figure 6.24. Converging trajectories for two landmarks in 2D.
e.g. if the initial momenta are chosen to be

p1(0) = (-7, 10),

p2(0) = (7, 10)

with the same initial positions, then the qualitative behavior of Figure 6.25 is observed: the landmark trajectories eventually diverge.
As we mentioned at the beginning of this section we have not yet developed a rigorous explanation for the qualitative behavior of the dynamics of two landmarks in two dimensions. In particular, it would be of interest to find an analytical expression for the threshold "collision angle" beyond which the two landmarks eventually diverge, expressed in terms of the initial positions and the function  that determines the kernel. Also, the question of whether periodic orbits exist in two dimensions is still an open one. The conservation of angular momentum is probably key to answering all these questions.
We conclude this section, and the chapter, by observing the effects of curvature on the qualitative dynamics of two landmarks on the plane: Figure 6.26 illustrates
141

Landmark Trajectories 6

4

2

0

-2

-4
p1(0) = (-7,10) p2(0) = (7,10) -6 -6 -4 -2 0 2 4 6

Figure 6.25. Diverging trajectories for two landmarks in 2D.

Landmark Trajectories - Conjugate Points 5 4 3 2 1 0 -1 -2 -3 -4 -5 -5 -4 -3 -2 -1 0 1 2 3 4 5

Figure 6.26. Existence of conjugate points for two landmarks in 2D. the existence of conjugate points for trajectories originating at points

q1(0) = (2, -4),

q2(0) = (-2, -4)
142

with different initial momenta, namely

p1(0) = (-7 - k, 10),

p2(0) = (7 + k, 10),

for k = 1, 2, . . . , 7 (the thicker line corresponds to the choice of k = 1). The above conditions correspond to positive sectional curvature at the point in question, and the existence of conjugate points is evident. The next chapter, which concludes this thesis, briefly illustrates the possible effects of the existence of conjugate points in the statistical analysis on shape spaces.

143

CHAPTER 7
Conclusions
1. Results
In this thesis we have endowed the set of N landmark points in D dimensions with the structure of Riemannian manifold: such structure derives directly from the notion that the distance between two shapes can be computed as the square root of the minimal energy that is necessary to match the first shape to the second one by means of a fluid flow. The metric tensor of the resulting DN -dimensional Riemannian manifold was made explicit, as well as the ordinary differential equations that determine the cogeodesic flow. Conservation laws, that follow from the translation-invariance and rotation-invariance of the metric tensor, were also explored.
Once the metric tensor of a generic Riemannian manifold is known, in principle one can compute the Riemannian curvature tensor by taking first and second partial derivatives of the elements of the metric and combining them. In our case following this procedure was unfeasible since the metric tensor is given by the inverse of a matrix; on the other hand, the structure of the matrix of partial derivatives of the cometric tensor happens to be very sparse, since each element of such tensor only depends on 2D out of the n = DN coordinates. This suggested solving the problem of finding formulas for the Riemannian curvature tensor and sectional curvature that depend on the first and second derivatives of the elements of the cometric.
We then applied these formulas to computing the general expression of sectional curvature for landmark manifolds, both in one and D dimensions. In particular, we explored in great detail the simple but nonetheless very informative examples of two and three one dimensional landmarks: in the latter case we also identified the tangent 2-planes that correspond to maximum and minimum curvature in a number of different landmark configurations.
144

Last, but not least, we analyzed the effects that curvature has on the qualitative dynamics of landmarks. In particular, we verified the divergence of geodesics in regions of negative sectional curvature and the existence of conjugate points in regions of positive sectional curvature. These facts have important consequences in applications, as we will briefly discuss in the next section.

2. Applications and Future Work
Model (2.3) introduced in Chapter 2 and analogous ones are currently in use in the emerging discipline of computational anatomy [10, 14, 15, 18, 22, 34, 35, 46], specifically in analyzing Magnetic Resonance Imaging (MRI) data of the human brain. In such field one has the interest in building templates from data, i.e. models for a typically healthy brain and for a brain that is at a certain stage of a pathology, such as Alzheimer's disease, that modifies its geometry and structure in a characteristic manner. The ultimate goal of this exercise is the creation of diagnostic software.
Typically, statistical analysis on a data set B = {J1, . . . , JM }  I is performed as follows. First of all the so-called intrinsic (or Karcher's) mean [38] is computed:

(7.1)

m := arg min d(I, J)2,
I I J B

where d(·, ·) is the geodesic distance. Then vectors wi  TmI, i = 1, . . . , M are found such that, for all i, expm(wi) = Ji (the mean m is "shot" with initial velocity wi "evolves" along a geodesic curve into datum Ji in unit time). At this point statistical analysis is done on the tangent space, for example by performing Principal Component

Analysis (PCA, see [5]) on vectors (w1, . . . , wm) in the linear space TmI; equivalently, PCA can be performed on the cotangent vectors (w1, . . . , wm). in Tm I. Note that statistical analysis should be ideally performed on the manifold itself using Principal

Geodesic Analysis (PGA, see [14, 15]), which is however computationally unfeasible,

whence such analysis is approximated with linear PCA on the tangent space at m.

Several remarks are in order. First of all, when the manifold is non-negatively

curved and the data is not localized enough Karcher's mean (7.1) may not be unique
145

(for example, the sphere has constant positive curvature and if the "data" happen to be precisely two opposite poles then any point on the corresponding equator solves the above minimization problem).
Also, conjugate points may exist in regions of positive curvature: in fact in the previous chapter we verified that this is precisely the case for landmark manifolds eve in low-dimensional settings. A consequence is that if the data points in B are not localized enough the vectors wi  TmI such that expm(wi) = Ji may not be well defined themselves (non-uniqueness).
Last, but not least, even when the Karcher mean is unique and the tangent vectors wi  TmI are well defined, curvature causes distortion in the statistical analysis. For example geodesics that originate at the Karcher mean m with initial velocities X, Y  TmI locally diverge if K(X, Y ) < 0, whereas they locally converge if K(X, Y ) > 0. In any case, distortion is generated by the process of representing the data points on the tangent space at m: that is, in case of negative curvature two data points J1 and J2, whose corresponding vectors, respectively w1 and w2, appear close on TmI, may be far on the manifold I in terms of actual geodesic distance; on the other hand, in case of positive curvature the tangent vectors w1 and w2 could appear far on TmI when in reality J1 and J2 are close on the manifold. Situations like these can potentially lead to inaccuracies in the statistical analysis.
Our current and future work aims precisely at estimating this distortion in the case of landmark shapes deriving from MRI databases of left and right hippocampi of three groups of patients: healthy patients, patients with Mild Cognitive Impairment (MCI, that corresponds to a Clinical Dementia Rating, or CDR, of approximately 0.5), and patients with Alzheimer's disease1 (AD). For each of the three classes of patients the Karcher mean m is computed together with the tangent vectors wi  TmI that correspond to the data, and PCA is performed on the tangent space. Now that a formula
1The three-dimensional landmark sets, which are hand-picked and hand-labeled from MRI images of the brain, are provided by the Center for Imaging Science at Johns Hopkins University.
146

for the sectional curvature of landmarks manifolds is known (see Chapter 5), we intend to compute sectional curvature for each pair of tangent vectors wi, wj  TmI and perform a study of the local distortion. Also, since the whole computation depends on the choice of the kernel (i.e. of the admissible Hilbert space V ), quantifying how the choice of the kernel's parameters (e.g. the scaling factor) influence the distortion in the statistical analysis will certainly be of interest.
147

APPENDIX A

Admissible Hilbert Spaces and Reproducing Kernels

In this Appendix we will concisely summarize the properties of admissible Hilbert spaces and their reproducing kernels. We refer the reader to [47] for more details; we should note that Reproducing Kernel Hilbert Spaces (RKHS) were first introduced in [3], while [45] provides a modern and concise introduction.
We denote with C00(RD, RD) or simply with C0(RD, RD) the linear space of continuous functions u : RD  RD that vanish at infinity (that is, such that for every  > 0 the set x : u(x) RD   is compact; see [16]) which is Banach with the norm:

Also, we define

u

max
xRD

u(x) RD .

C0k(RD, RD) u  Ck(RD, RD) : u  C0(RD, RD) for ||  k ,

where Ck(RD, RD) is the linear space of functions RD  RD which are continuously differentiable k times; in the above definition we have used the multi-index notation for partial derivatives [13, 16]. C0k is a Banach space with the Ck (or W k,) norm

u k,

max
xRD

u(x) RD .

||k

In particular C01(RD, RD) is the linear space of continuously differentiable functions u : RD  RD that vanish at infinity with their first partial derivatives, which is Banach with the norm:

u

1,

=

max
xRD

D

u(x)

RD +

i=1

max
xRD

u xi

(x)

.
RD

Admissible Hilbert spaces are defined as follows.
148

Definition A.1. A Hilbert space (V, ·, · V ) of functions RD  RD is said to be admissible if the following conditions hold:

(1) V is continuously embedded in C01(RD, RD), i.e. there exists a positive con-

stant C such that u 1,  C u V , for all u  V ;

(2) for any positive integer M , if x1, . . . , xN  RD and 1, . . . , N  RD are such

that, for all u  V ,

N i=1

i, u(xi) RD = 0, then 1 = . . . = N = 0.

We should note that property (2) establishes a certain "richness" of functions in

space V . In fact it can be rewritten as follows: for fixed points x1, . . . , xN  RD,

if there exist vectors 1, . . . , N  RD of which at least one is non-zero, then there

exists at least a function v  V such that

N i=1

i, u(xi) RD = 0.

Example. As we do in Chapter 2, V can be chosen to be Sobolev space Hk(RD, RD)

with its norm:

||u||2V

RD Lu(x), u(x) RD dx;

in the above expression L = (id - a2)k is a self-adjoint spatial differential operator

(a  R, k  N and  is the Laplacian) that is applied to each of the D components

of vector field u. By the Sobolev Embedding Theorem [16] we have in fact that if

k>

D 2

+

1

then

V

is embedded in C01(RD, RD).

Property (2) of Definition A.1 is also

satisfied by Hk(RD, RD) (in fact, for any value of k).

We will now prove the existence of so-called reproducing kernels for admissible Hilbert spaces, which is a consequence of property (1) of Definition A.1. For a fixed point x  RD and a fixed vector   RD consider the evaluation functional

(A.1)

x : V  R : u  , u(x) RD .

Note that:

· functional x is linear, since for all u, v  V ,

x(u + v) = =

, (u + v)(x) RD = , u(x) + v(x) RD , u(x) RD + , v(x) RD = x(u) + x(v);
149

· functional x is also bounded, since for all u  V ,

|x(u)| = 

, u(x) RD   RD u(x) RD  RD u 1,  C  RD u V ,

where we have used the Schwartz inequality, the definition of ·  and property (1) of Definition A.1.

Therefore, by the Riesz Representation Theorem for Hilbert Spaces [16] there exists a unique function Kx(·)  V such that

(A.2)

Kx, u V = , u(x) RD ,

for all u  V . Such function is called the representer of evaluation functional (A.1), and relation (A.2) is referred to the reproducing property of function Kx(·).

Remark. In order for V to have a reproducing kernel we could loosen the requirements in the definition of admissible Hilbert space. In fact the existence of a constant C such that u   C u V , for all u  V would imply the boundedness of functional x; in other words, the continuous embedding of V in C00(RD, RD) would be sufficient. However we require that V is continuously embedded in C01(RD, RD) so that the flow generated by time dependent vector fields v  L1 [0, 1], V , used in Chapter 2, are actually diffeomorphism from RD to RD, i.e. continuously differentiable and invertible with continuously differentiable inverse.

Remark. The Hilbert space L2(R, R) of square integrable functions, with inner
product f, g = R f g dx, does not have a reproducing kernel (indeed, it is not embedded in C00(R, R)); formally, only the Dirac delta function, which is not an element of the space, has the reproducing property.

Let V be an admissible Hilbert space. Note that the map RD  V :   Kx(·) is linear in ; in fact, for all x  RD, ,   RD, and u  V ,

Kx+, u V = =

 + , u(x) RD = , u(x) RD + , u(x) RD
Kx, u V + Kx, u V = Kx + Kx, u V ;
150

whence Kx+ = Kx + Kx by the uniqueness of the representer. In particular, for any point y  RD we have that Kx+(y) = Kx(y) + Kx(y); so for an arpitrary pair of points x, y  RD there exists a D × D matrix K(y, x)  RD×D such that, for all   RD, Kx(y) = K(y, x) (here we are treating  as a column vector). Such matrix-valued function K : RD × RD  RD is called the reproducing kernel of Hilbert
space V (whence the name of reproducing kernel Hilbert spaces). By the reproducing property (A.2) we have that, for any pair of points x, y  RD
and any pair of vectors ,   RD,

but also

Kx, Ky V = , Ky(x) RD = , K(x, y) RD = T K(x, y),

Ky, Kx V = , Kx(y) RD = , K(y, x) RD = T K(y, x) = T K(y, x)T  ,
so that by the arbitrariness of  and  we have the symmetry: K(x, y) = K(y, x)T . We will now use property (2) in Definition A.1 of admissible Hilbert spaces to prove positive-definiteness of the kernel.

Proposition A.2. For any positive integer M , any points x1, . . . , xN  RD and vectors 1, . . . , N  RD the following holds:
M
iT K(xi, xj)j  0
i,j=1
with equality if and only if 1 = . . . = M = 0.

Proof. By the reproducing property of the representer function:

M
Kxii
i=1

2 V

MM

M

=

Kxii ,

Kxjj

=

Kxii , Kxjj V

i=1 j=1 V i,j=1

MM

=

i, Kxjj (xi) RD =

i, K(xi, xj)j RD

i,j=1

i,j=1

M
= iT K(xi, xj)j ,
i,j=1

151

so that

M i,j=1

iT

K

(xi,

xj

)j



0,

with

equality

if

and

only

if

when, for all v  V ,

M i=1

Kxii

=

0,

that

is

M
Kxii, v = 0 ,
i=1 V

i.e.

M
i, v(xi) RD = 0 ;
i=1

but by condition (2) in Definition A.1 the above relations holds if and only if i = 0

for all i = 1, . . . , N .

Proposition A.3. When the admissible Hilbert space is of the Sobolev type, V = Hk(RD, RD), with inner product:

u, v V = RD Lu(x), v(x) RD dx where L is a self-adjoint differential operator that acts on each of the components

of u, the reproducing kernel has the form:



K(x, y)

=

G(x, y) · id

=



G(x, y)
0 ...

0
G(x, y) ...

···
··· ...

0
0 ...

 ,

0 0 · · · G(x, y)

where id is the D × D identity matrix and G(x, y) is the (scalar) Green's function1,

or fundamental solution, of differential operator L.

Proof. For any point x  RD, vector   RD, and function u  V , by the reproducing property (A.2) we have that

, u(x) RD = Kx, u V = RD Kx(y), Lu(y) RD dy

=

RD K(y, x), Lu(y) RD dy =

T K(y, x)T Lu(y) dy
RD

= T K(x, y) Lu(y) dy = , K(x, y) Lu(y) dy ,
RD RD RD
1By definition, the Green's function of a differential operator L is the solution of partial differ-

ential equation Lu = , where  is Dirac's delta function. The solution to equation Lv = f is v(x) =

G(x, y)f (y) dy, therefore the Green's function has the property that v(x) = G(x, y) Lv(y) dy for

any function v in the appropriate function space. See [13] for more details.

152

where we have treated Lu(y) as a column vector. By the arbitrariness of   RD we have that

(A.3)

u(x) = K(x, y) Lu(y) dy .
RD

So if we indicate with ui the i-th component of vector u and with Kij the element of

matrix (reproducing kernel) K in position (i, j), expression (A.3) can be written as

D

ui(x) =

Kij(x, y) Luj(y) dy ,

RD j=1

i = 1, . . . , D;

function u  V is also arbitrary, so if we choose a function whose only nonzero

component is u1 the above integral yields

u1(x) = K11(x, y) Lu1(y) dy ,
RD
so we may conclude, by the arbitrariness of u1, that K11(x, y) = G(x, y), i.e. the
Green's function, or fundamental solution, of differential operator L. In the same way we can prove that all the remaining diagonal elements Kii(x, y) are equal to G(x, y),
for i = 2, . . . , D. On the other hand, if we choose again a function u  V whose only nonzero component is u1 we also get

uk(x) = 0 = Kk1(x, y) Lu1(y) dy ,
RD

k = 2, . . . , D,

so that, by the arbitrariness of u1, it must be the case that Kk1(x, y)  0. In a

completely similar way one can prove that all the remaining off-diagonal elements of

the reproducing kernel K are identically equal to zero.

In the case of admissible Hilbert spaces of the Sobolev type we sometimes say, with abuse of terminology, that scalar function G is the kernel of V .

Corollary A.4. Under the hypotheses of Proposition A.3,

G(·, x), v V = , v(x) RD
for any point x  RD, any vector x  RD, and any function v  V .
153

Proof. In fact, by the reproducing property:

, v(x) RD = Kx, v V = K(·, x), v V = G(·, x) id , v V = G(·, x), v V .

Corollary A.5. Under the hypotheses of Proposition A.3, for any choice of
points x1, . . . , xM  RD and for any vector (a1, . . . , aM )  RM it is the case that
M
G(xi, xj) aiaj  0 ,
i,j=1
with equality if and only if a1 = . . . = aM = 0.

Proof. It is sufficient to apply Proposition A.2 to vectors i =

ai D

,

.

.

.

,

ai D



RD, for i = 1, . . . , M .

154

APPENDIX B

Properties of Bessel Kernels

1. Introduction

When performing regularized landmark matching between the two labeled sets I = (x1, . . . , xN ) and I = (y1, . . . , yN ), one's objective is to minimize the functional:

E[v, q]

1 1N
0 RD Lvt, vt RD dx dt +  0 i=1

dqi dt

(t)

-

vt

qi(t)

2
dt

with respect to time-dependent velocity v  L2([0, T ], V ), where V is an appropriate

Hilbert space embedded in C01(RD, RD), and to landmark trajectories qi : [0, T ]  RD that satisfy the boundary conditions qi(0) = xi and qi(1) = yi, for i = 1, . . . , N . In

the first term of the right-hand side of the above equation L is a spatial differential

operator which typically has the form L = (id - a2)k, where  is the Laplacian

operator and a2 is just a scaling factor; exponent k is generally a positive integer,

although the theory can be extended to the case of positive real values of k (pseudo-

differential operators). It turns out that the Green's function of operator L plays a fundamental role in

both the solution of the above minimization problem and in the study of the Riemannian curvature tensor of landmark-based shape manifolds. When the differential operator is in fact L = (id - a2)k such Green's function G : RD × RD  R takes

the form G(x, y) =  x - y RD , with  : [0, )  R given by:

(B.1)

(

)=

1

2k+

D 2

-1

D 2

(k)

1 aD

a

Kk-

D 2

k-

D 2

a

,

where K is a modified Bessel function [1, Chap. 9] whereas  is the gamma function [1, Chap. 6]. Note that  and its derivatives are defined at zero by continuity. Reference [20] provides a table of fundamental solutions for different differential operators, from which (B.1) can be computed. Function (B.1) depends on both D, the
155

dimension of the ambient space for landmarks, and k, the exponent of differential

operator L. Function  is C in the open set (0, ) while its regularity in the origin

depends

on



=

k-

D 2

:

its

smoothness

at

zero

in

fact

increases

with

parameter

.

We

shall explore the asymptotic behavior of  at zero later on in this appendix.

For notational convenience let us define, for a fixed value of scaling factor a:

k,D

1

2k+

D 2

-1



D 2

(k)

1

ak+

D 2

,

so that (B.1) can simply be written as

(B.2)

with



=

k

-

D 2

.

( ) = k,D K a ,

2. Differential equation

It is well known that modified Bessel function K(z) is a solution to the following second order differential equation [1]:

(B.3)

z2

d2w dz2

+

z

dw dz

-

(z2

+

2)w

=

0;

note that K(z) is a holomorphic function of z throughout the complex plane cut along the negative real axis, and for fixed z it is an entire function of . For our purposes, we are interested in K(z) when z  R+ and   R.
Function ( ), which is defined in terms of a modified Bessel function, also satisfies a second order differential equation which will differ from (B.3) due to factor k-D/2 in (B.1). In fact the following result holds.

Proposition B.1. Function  defined in (B.1) satisfies the following second order differential equation:

(B.4)



=

2 - 1 

+

1 a2



,

where



=

k

-

D 2

.

156

Proof. Perhaps the most straightforward way of proving the proposition is taking successive derivatives of the expression provided by (B.1), recombining the resulting terms and and then using differential equation (B.3). However we shall pursue a different path, which will also yield a useful expression for the first derivative of ( ).
Differentiation of (B.2) yields the following expression:

(B.5)

 ( ) = k,D  -1K

a

+

1 a

 K

a

.

We will use an important property of the modified Bessel functions of our interest. Namely, the following formulas hold [1, §9.6.26] for any value of parameter µ:

(B.6) (B.7)

Zµ(z)

=

Zµ-1(z)

-

µ z

Zµ+1(z)

,

Zµ(z)

=

Zµ+1(z)

+

µ z

Zµ(z)

,

where

Zµ(z) =

eµiKµ(z).

Identity

(B.6)

implies

that

Kµ(z)

= -Kµ-1(z) -

µ z

Kµ(z

)

for all µ, so that, fixing µ = ,

(B.8)

K a = -K-1 a - a K a ;

the

second

one

(B.7)

implies

that

Kµ(z)

=

-Kµ+1(z) +

µ z

Kµ(z),

whence

for

µ

=



-

1

(B.9)

K-1 a = -K a + a ( - 1)K-1 a .

Inserting (B.8) into the right-hand side of (B.5) yields:

(B.10)

( )

=

k,D  -1K

a

+

1 a



- K-1 a

- a K

a

=

-k,D

1 a

 K-1

a

.

157

Differentiating the above function gives:

()

=

-k,D

1 a



-1K-1

a

+

1 a2

 K-1 a

(=)

-k,D

1 a



-1K-1

a

+

1 a2



- K

a

+ a ( - 1)K-1 a

=

-k,D

2

-

1

1 a



-1K-1

a

-

1 a2

 K

a

=

2 - 1

-

k,D

1 a

 K-1

a

+

1 a2

k,D

 K

a

=

2 - 1  (

)

+

1 a2

(

),

which is equation (B.4); note that we have used expression (B.9) in step ().

A by-product of the above proof is the following result.

Corollary B.2. The first derivative of function  may be expressed ad follows:

(

)

=

-

2k+

D 2

1 -1

D 2

(k)

1 aD+1

a

Kk-

D 2

k-

D 2

-1

a

=

-k,D

1 a

Kk-

D 2

k-

D 2

-1

a

.

Proof. The result follows immediately from expression (B.10).

3. Asymptotic behavior at zero

We shall now study the behavior of function ( ) in a neighborhood of zero.

We will need the following properties of modified Bessel functions [1, §9.6.8, §9.6.9]:

when z  0, K0  - ln z, while for a fixed value of paramenter µ with µ > 0 we

have that Kµ(z) 

1 2

(µ)

1 2

z

-µ.

In other words,

lim
z0

K0(z) ln z

=

-1

and

(B.11) for µ > 0.

lim
z0

zµKµ(z)

=

2µ-1(µ)

158

Proposition B.3. It is the case that:

lim ( ) =
0

1 2a

D



k

-

D 2

(k)

,

provided

that

k-

D 2

>

0.

Otherwise,

when

k-

D 2



0

the

above

limit

diverges

to

+.

Proof.

The

case

k

>

D 2

follows

directly

from

applying

property

(B.11)

to

ex-

pression (B.1). The other case follows form the facts that Kµ(x)  + as x  0+

for any value of parameter µ, and that xµ  + as x  0+ for µ < 0.

Proposition B.4. The first derivative of function  is such that:

lim  (
0

)

=

-1 2D+1aD+2

D 2



k

-

D 2

-

1

(k)

,

provided

that

k

-

D 2

-

1

>

0.

Proof. It follows from Corollary B.2 that

(

)

=

-

2k+

D 2

1 -1

D 2

(k)

1 aD+2

a

Kk-

D 2

-1

k-

D 2

-1

a

,

which,

provided

that

k

-

D 2

-

1

>

0,

by

(B.11)

converges

to

lim  (
0

)

=-

1

2k+

D 2

-1



D 2

(k)

1 aD+2

2k-

D 2

-2



k

-

D 2

-

2

=

-

1 2D+1aD+2

D 2



k

-

D 2

-

1

(k)

,

which is precisely what we wanted to prove.

Proposition B.5. The second derivative of function  is such that:

lim 
0

(

)

=

-1 2D+1aD+2

D 2



k

-

D 2

-

1

(k)

,

provided

that

k-

D 2

-1

>

0.

If

k

-

D 2

-1



0,

the

above

limit

diverges

to

+.

Proof. In order to compute the above limit we shall use differential equa-

tion (B.4) and the results provided by Propositions B.3 and B.4, which both hold

since

k-

D 2

-1

>

0.

By

Proposition

B.3

we

have

that

lim
0

1 a2

(

)=

k

-

D 2

-

1

2D

aD+2



D 2



k

-

D 2

-

1

(k)

,

159

where we have used the property of the gamma function: (z + 1) = z(z). On the

other hand by Proposition B.3 it is the case that

lim 2 - 1  (
0

)

=

-

2k - D - 1

2D+1aD+2



D 2



k

-

D 2

-

1

(k)

,

where

we

have

fixed



=

k

-

D 2

.

Combining the above limits with equation (B.4)

finally yields

lim  ( )
0

=

lim
0

2 - 1  (

)+

1 a2

(

)

=

-

2k - D - 1

2D+1

aD+2



D 2



k

-

D 2

-

1

(k)

+

2k - D - 2

2D+1aD+2



D 2



k

-

D 2

-

1

(k)

=

-

2D+1

1 aD+2



D 2



k

-

D 2

-

1

(k)

,

as we wanted to prove.

Remark. Out of curiosity, note that: lim  ( ) = lim  ( ) .
0 0

160

Bibliography
[1] M. Abramowitz and I. A. Stegun. Handbook of Mathematical Functions. Dover Publications, New York, 1964.
[2] V. I. Arnold. Mathematical Methods of Classical Mechanics, volume 60 of Graduate Texts in Mathematics. Springer, New York, second edition, 1989.
[3] N. Aronszajn. Theory of reproducing kernels. Transactions of the American Mathematical Society, 68(3):337­404, May 1950.
[4] G. Benettin, L. Galgani, and A. Giorgilli. Appunti di Meccanica Razionale. Edizioni Libreria Progetto, Padova, Italy, 1991.
[5] C. M. Bishop. Pattern Recognition and Machine Learning. Information Science and Statistics. Springer, 2006.
[6] K. W. Brodlie. Unconstrained minimization. In The State of the Art in Numerical Analysis, pages 229­268. Academic Press, London, Apr. 1977.
[7] C. Chicone. Ordinary Differential Equations and Applications, volume 34 of Texts in Applied Mathematics. Springer, 1999.
[8] G. E. Christensen, R. Rabbitt, and M. I. Miller. 3D brain mapping using a deformable neuroanatomy. Physics in Medicine and Biology, 39:609­618, 1994.
[9] G. E. Christensen, R. Rabbitt, and M. I. Miller. Deformable templates using large deformation kinematics. IEEE Transactions on Image Processing, 5(10):1435­1447, Oct. 1994.
[10] J. G. Csernansky, S. Joshi, L. Wang, J. W. Haller, M. Gado, J. P. Miller, U. Grenander, and M. I. Miller. Hippocampal morphometry in schizophrenia by high dimensional brain mapping. Proc. Natl. Acad. Sci. USA, Neurobiology, 95:11406­11411, Sept. 1998.
[11] M. P. Do Carmo. Riemannian Geometry. Birkh¨auser, Boston, 1992. [12] M. G. Eastwood and P. W. Michor. Some remarks on the Plu¨cker relations. Rendiconti del
Circolo Matematico di Palermo, 63:85­88, 2000. [13] L. C. Evans. Partial Differential Equations, volume 19 of Graduate Studies in Mathematics.
American Mathematical Society, Providence, Rhode Island, 1998.
161

[14] P. T. Fletcher and S. Joshi. Principal Geodesic Analysis on symmetric spaces: Statistics of diffusion tensors. In Computer Vision - ECCV 2004, volume 3024 of Lecture Notes in Computer Science. Springer-Verlag, Prague, Czech Republic, May 2004.
[15] P. T. Fletcher, C. Lu, S. M. Pizer, and S. Joshi. Principal Geodesic Analysis for the Study of Nonlinear Statistics of Shape. IEEE Transactions on Medical Imaging, 23(8):995­1005, Aug. 2004.
[16] G. B. Folland. Real Analysis: Modern Techniques and Their Applications. John Wiley & Sons, second edition, 1999.
[17] J. Glaun`es. Transport par diff´eomorphismes de points, de mesures et de courants pour la comparaison de formes et l'anatomie num´erique. PhD thesis, Universit´e Paris 13, France, Sept. 2005.
[18] U. Grenander and M. I. Miller. Computational anatomy: an emerging discipline. Quarterly of Applied Mathematics, 56(3):617­694, Sept. 1998.
[19] B. K. P. Horn. Robot vision. The MIT Press, Cambridge, Massachusetts, 1986. [20] K. It^o, editor. Encyclopedic Dictionary of Mathematics. MIT Press, Cambridge, Massachusetts,
USA, second edition, 1993. Prepared by the Mathematical Society of Japan. [21] K. J¨anich. Vector Analysis. Undergraduate Texts in Mathematics. Springer-Verlag, New York,
2001. [22] S. C. Joshi and M. I. Miller. Landmark matching via large deformation diffeomorphisms. IEEE
Transactions on Image Processing, 9(8):1357­1370, Aug. 2000. [23] J. Jost. Riemannian Geometry and Geometric Analysis. Springer-Verlag, New York, third edi-
tion, 2002. [24] E. Kalssen, A. Srivastava, W. Mio, and S. Joshi. Analysis of planar shapes using geodesic paths
on shape spaces. IEEE Transactions on Pattern Analysis and Machine Intelligence, 26(3):372­ 383, Mar. 2004. [25] P. R. Kumar and P. Varaiya. Stochastic Systems: Estimation, Identification, and Adaptive Control. Prentice Hall, Englewood Cliffs, New Jersey, 1986. [26] A. J. Laub. Matrix Analysis for Scientists and Engineers. SIAM, 2004. [27] J. M. Lee. Riemannian Manifolds: an Introduction to Curvature, volume 176 of Graduate Texts in Mathematics. Springer, New York, 1997. [28] J. M. Lee. Introduction to Smooth Manifolds, volume 218 of Graduate Texts in Mathematics. Springer, New York, 2003. [29] P. W. Michor. Topics in Differential Geometry. Lecture Notes, University of Vienna, 2006.
162

[30] P. W. Michor. Curvature, covariantly expressed. Unpublished technical report, University of Vienna, July 2007.
[31] P. W. Michor and D. B. Mumford. Vanishing geodesic distance on spaces of submanifolds and diffeomorphisms. Documenta Mathematica, 10:217­245, 2005.
[32] P. W. Michor and D. B. Mumford. Riemannian geometries on spaces of plane curves. Journal of the European Mathematical Society, 8:1­48, 2006.
[33] P. W. Michor and D. B. Mumford. An overview of the Riemannian metrics on spaces of curves using the Hamiltonian approach. Applied and Computational Harmonic Analysis, 23:74­113, 2007.
[34] M. I. Miller, A. Trouv´e, and L. Younes. On the metrics and Euler-Lagrange equations of computational anatomy. Annual Review of Biomedical Engineering, 4:375­405, 2002.
[35] M. I. Miller, A. Trouv´e, and L. Younes. Geodesic shooting for computational anatomy. Journal of Mathematical Imaging and Vision, 24(2):209­228, Mar. 2006.
[36] M. I. Miller and L. Younes. Group actions, homeomorphisms, and matching: A general framework. International Journal of Computer Vision, 41(1/2):61­84, 2001.
[37] C. Ovidiu and D.-C. Chang. Geometric Mechanics on Riemannian Manifolds. Applications to Partial Differential Equations. Birkh¨auser, Boston, 2005.
[38] X. Pennec. Probabilities and Statistics on Riemannian Manifolds: a Geometric Approach. Research Report 5093, INRIA, January 2004.
[39] E. Polak. Computational Methods in Optimization: a Unified Approach. Academic Press, New York, 1971.
[40] F. Riesz and B. Sz.-Nagy. Functional Analysis. Dover, New York, 1990. [41] W. Rudin. Principles of Mathematical Analysis. McGraw-Hill, New York, third edition, 1976. [42] E. Sharon and D. B. Mumford. Kalman filtering with intermittent observations. International
Journal of Computer Vision, 70(1):55­75, Oct. 2006. [43] A. Trouv´e. Infinite Dimensional Group Action and Pattern Recognition. Technical report, DMI,
E´cole Nationale Sup´erieure, Paris, France, May 1995. [44] F.-X. Vialard. Landmarks, geodesics and curvature in a simple case. Technical report, E´cole
Nationale Sup´erieure de Cachan, France, Aug. 2007. [45] G. Wahba. Spline Models for Observational Data, volume 59 of CBMS-NSF Regional Conference
Series in Applied Mathematics. SIAM, Philadelphia, Pennsylvania, 1990. [46] L. Wang, F. Beg, T. Ratnanather, C. Ceritoglu, L. Younes, J. C. Morris, J. G. Csernansky,
and M. I. Miller. Large deformation diffeomorphism and momentum based hippocampal shape
163

discrimination in dementia of the Alzheimer type. IEEE Transactions on Medical Imaging, 26(4):462­470, Apr. 2007. [47] L. Younes. Deformation Analysis for Shape and Image Processing. Lecture notes, Johns Hopkins University, 2007. [48] L. Younes, P. W. Michor, J. Shah, and D. B. Mumford. A metric on shape space with explicit geodesics. Rendiconti Lincei ­ Matematica e Applicazioni, 9:25­57, 2008.
164

