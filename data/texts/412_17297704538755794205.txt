From: ISMB-99 Proceedings. Copyright © 1999, AAAI (www.aaai.org). All rights reserved.

Using the Fisher kernel method to detect remote protein homologies
Tommi Jaakkola*, Mark Diekhans, David Haussler Department of ComputerScience University of California Santa Cruz, CA95064
tommi:~ai.nlit.edu, markd(~cse.ucsc.edu, haussler~cse.uesc.edu

Abstract
A newmethod, called the Fisher kernel method, for detecting remote protein homologiesis introduced and shownto perform well in classifying protein domains by SCOPsuperfamily. The method is a variant of support vector ma(:hines using a newkernel function. The kernel function is derived from a hidden Markov model. Tile general approachof combininggenerative models like HMMwsith discriminative methods such as support vector machinesmayhave applications in other areas of biosequenceanalysis as well.
Introduction
Man.:statistica], seque,~c~:-t.asedtool': ha~ebeer..teve.!.-. oped for detecting protein homolo,,.;ies. These include BLAST(Altshul et al. 1990; Altschul et al. 1997), Fasta (Pearson & Lipman 1988), PROBE(Neuwald et al. 1997), templates (Taylor 1986), profiles (Gribskov, McLachlan, &Eisenberg 1987), position-specific weight matrices (Henikoff & Henikoff 1994), and Hidden Markov Models (HMMs)(Krogh et al. 1994). Recent experiments (Brenner 1996: Park et al. 1998) have used the SCOPclassification of protein structures (Hubbard et al. 1997) to test manyof these methods to see how well they detect remote protein homologies that exist between protein domains that are in the same structural superfamily, but not necessarily in the same family. This work has shown that methods such as PSI-BLAST and HMMs,which build a statistical model from multiple sequences, perform better than simple pairwise comparison methods, but all sequence-based methods nliss manyimportant remote holnologies.
Wepresent and evaluate a new methc)dc)logy for detecting remote protein homologies. In this approach
*Current address: MIT AI Lab, 545 Technology Square, Cambridge MA02139.
Copyright @1999,Aineriean Association for Artificial Intelligence (www.aaai.org). All rights reserved.

we use generative statistical models built from nmltiple sequences, in this case HMMsa, s a way of extracting features from protein sequences. This maps all protein sequences to points in a Euclidean feature space of fixed dimension. (See (Liniai et al. 1997) for a different method of mapping protein sequences into Euclidean space). Wethen use a general discriminative statistical method to classify the points representing protein sequences by domain superfamily. This is quite distinct from methods that train the parmneters of the HMMitself to give a more discrlrninative model (Eddy, Mitchison, & Durbin 1995; :~._'amiteuka199£). Otherdisc.rimina'ive~.,nethois,. ils.ing :)eural nets, are de,,cP,t)ed in (l)ubchakal. 1995;. D,lbc.hak, _Muchnik& KJm1997). U~ing our me.:hod, we obtain a subst,'mtial improvementin identit}'ing remote homologies over what is achieved by HMMs alone, as they are currently employed. This new method also compares favorably to what haw~, been called family pairwise search homology methods: in which the scores from all pairwise comparisons between a query protein and the membersof a knownprotein family are combined to improve performance (Grundy 19981).
Methods
The statistical modeling approach to protein sequence analysis involves constructing a generative probability model, such as an HMMf,or a protein family or superfamily (Durbin et al. 1998). Sequences knownto be membersof the protein family are used as (positive) training examples. The parameters of a statistical model representing the family are estimated using these training examples, in conjunction with general a priori information about properties of proteins. The model assigns a probability to any given protein sequence. If it is a good model for the family it is trained on, then sequences from that family, including sequences that were not used as training examples, yield a higher probability score than those out-
ISMB'99 149

side the family. Tile probability score can thus be interpreted as a measure of the extent to which a new protein sequence is homologousto the protein faintly of interest. Considerable recent work has been done in refining HMMfsor the purpose of identiL;ing weak protein homologies in this way (Krogh et aL 1994; Baldi et al. 199,1; Eddy 1995; Hughey& Krogh 1996; Karplus st al. 1997).
Let X = [xt .... ,.r,~] denote a protein sequence, where each xi is an amino acid residue. Suppose that weare interested in a particular protein family such as ilnmunoglobulins and have estinlated an HMYI, H1for this family (for details of the estimatkm process see. e.g., (Durbin et al. 1998)). Weuse P(XIH1) to denote the probability of X under the HMMa,nd P(X{H,) to denote the probability of X under the null model. The score used in database search is the likelihood ratio

~:(.\-) = P(XIH,)P(H1)

= log

pPP(((XXXlH[IHHaI,,)))P+(Hloo)g

P(Hcd P(Ht)

(1)

A positive wdueof the likelihood ratio f_.(X) is taken as art indication that the new sequence _\" is indeed a member of the fanfily. The constant factor logP(Ht)/P(tlo), the log prior odds, providc's an a priori meansfor biasing the decision and does not affect the ranking of sequences being scored.

Discriminative

approaches

The parameters of a generative model are estimated in such a way ,as to make the positive training exampies, proteins in the fanfily being modeled, very likely under the probability model. In contrast.: the parameters of a discriminative modelare estimated using both positive training examples and negative training examples, which are i)roteins that are not membersof the family being modeled. The goal in est.imating the parameters of a discriminative modelis to find pa.rame-
ters such that the score derived from the model can be used to discrinfinate membersof the family from nonmembers,e.g. such that membersof the family receive a high score and non-mernbers receive a low score.
Although the likelihood ratio above is optimal wh(,n the HMMand the mill model are perfectly ac(:urate models of the data. it can perform poorly when these models are not accurate. This can easily happen with limited training sets (Barrett, Iiugtmy, & Karplus
1997; Park et al. 1998). Discrinfinativ(' methods can be used to directly optimize the decision rule using both negative and positive examples, and often perform better.

150 JAAKKOLA

Kernel methods
Suppc)se we have a training set of examt)les (protein sequences) {Xi}.i = 1 ..... o fc)r which we knowthe correct hypothesis (:lass, HI or H0. In other words, we have a set of t)rotein sequences that are knownto h(, either homologousto the fantily of interest or not. We model the discriminant flnlction £(X) directly via the following expansion in terlns of the training examples:

= log P(H, IX) - log P(H,,IX)

= ,\,I;(x, av)-

i:X,C IIl

i:X,¢..tIo

(2)

Tit(' sign of tit(' dis('riminant flnlction d('termines assignment of tim sequences into hyt)otl,esis ('lasses. The contribution, either positive or negative, of each trainiug exantple (sequence) to the (lecisi~m rule consists of two parts: 1) the overall importance (.,f the example Xi as summarized with the non-negative coettMent Ai and 2) a nleasure ()f l)airwise "'similarity"
betweenthe training (,xample .\'j and the new('x;mq)[e X, expressed in terlns of a ke~'nel function K(Xi. X). The |lser supplies the kernel function al)l)ropriate for the application area. This is the most('riti('al ('t)lllpon(nt. Tit(' fre(, parameters in the :d)ove decistere rule are the c,)effM,nts .)~i: these car be e.~timat('d bv it.er ~t.ively t;mximizir, g a quadraticob.v'c:ix'( fnncti(,n d,scrlbed in (Jaakkola, Dickhan.%);: Haussler 1.9981¢).

The Fisher kernel
Finding an appropriate kernel fllnct ion for a particular application area can be difficult and remains largely an unresolved issue. Wehave, however, developed a gen-
eral [ornmlismfor deriving kernel functions fromgenerative probability models (3aakkola & Haussh'r 1998). This formalism carries several advantages, including the ability to handle complexobjects such as variable length protein sequences within the kernel function. gurthernlore, the formalism facilitates the encoding of -prior knowledgeabout protein sequen('es, via. the l)tt)l) ability' too(Ms, into the kernel function.
Our al)proach here is to derive the kernel function from IIMMscorresponding to the protein family of int('rest. Weare thus able to build on the work of
others towards a(lapting HM.Mfsor protein h()ntology deteetion(Krogh et al. 1994; Hughey& Krogh 1!)!)6; Karplus et al. 1997). Our use of pr()tc.in models the kernel function, however, deviates front tim stan(lard use of such modelsin biosequenceanalysis it, that the kernel time(ion spe.cifies at sinfilarity score for any pair of sequences, whereasthe likelihood s('ore front an HMMonly metusures the closeness of the sequence to
the modelitself.

Weextract and entertain a richer representation for each sequence in the form of what arc knownas suffi-
cient statistics. In the context of HMMthsese statistics are computed with each application of the standard forward-backward algorithm (Rabiner & Juang 1986). Thefixed length vector of sufficient statistics contains a value for each parameter in the HMMand these values are the posterior frequencies of having taken a partic-
ular transition or having generated one of the residues of the query sequence X from a particular state. The vector of sufficient statistics thus reflects the process of generating the query sequence from the HMM.More generally, they provide a complete summaryof the sequence in the parameter space of the model.
Theidea of using sufficient statistics as an intermedi-
ate representation of the query sequence can he generalized considerably(Jaakkola & Haussler 1998). Ill the nmre general treatment: one works not with the vector
of sufficient statistics directly but with an analogous quantity knownas the Fisher score.

Ux = V0 log P(XIH,, O)

(3)

Each component of Ux is a derivative of the loglikelihood score for the query sequence X with resp'cct to a pazticular parameter. The magnitude, of c,l~e componentsspecify tim extem: ;o which each part:x:eter contributes tc generating the (!uery sequence. Tim computation of these gradients in the context of H.MMaslong with their relation to sufficient statistics
is described in more detail in (Jaakkola, Diekhans, Haussler 1998b).
Finding an appropriate kernel function in this new gradient representation is easier than in the original space of variable length protein sequences.V~Te only need to quantify the similarity between t.wo fixed length gradient vectors Ux and Ux, corresponding to two sequences X and X', respectively. Tile kernel flmction used in our experinlents is given by

as derived in (Jaakkola, Diekhans, & Haussler 1998b). The scaling parameter cr appearing in this kernel was set equal to the median Euclidean distance bet.ween the gradient vectors corresponding t.o tile training sequences in the protein family of interest and tile closest gradient vector from a protein behmgingto another protein fold.
To summarize, we begin with an HMMtrained from positive examples to modela given protein fanfily. We use this HMMto mapeach new protein sequen('e X we want to classify int,() a fixed hmgthvector, its Fisher score, and compute the kernel flmction on the basis

of the Euclidean distance between the score vector for X and the score vectors for knownpositive and negative examples Xi of the protein family. The resulting discriminant function is given by

i:XiEH1

i:XIEHo

(5)

where K is the kernel function defined above and tile

Ai are estimated from the positive and negative training examples Xi. We refer to this as the SVM-Fisher

method.

Combination of scores
In many cases we can construct more titan one HMM nmdel for the family or superfamily of interest. It is advantageous in such cases to combinethe scores from the multiple modelsrather than selecting just one. Let. gi(X) denote the score for the query sequence X based on the i th model. This might be the score derived from the SVM-Fisher method. Equation (5), or the log likelihood ratio for the generative HMMmodel.
log _Pp((X~lH0)' or even a negative log E-value derived
fronl a BLASTcomparison, as described in he methods section. Wewould like to combine the SVM-Fisher scores for X from all the models of the giv(,n .%rally, and siv'ilarly with H313...I :rod BLASTscores Sii,ce t, here is no clearly optimal wayto :emoine these scores in practice, weexplore t..ere oily two simple he.uristic means. These are average ,score.

£,..~ and maximum,score

1 (X) = ~ Z/2,(X)
i

(:6:)

£.... (X) = max£i(X), i

(7)

wherein each case the index i ranges over all modelsfor

a single fanfily of interest. These comhinat, ion methods have also been explored in other protein homologyex-

periments (Grundy 1998). The average score method

works best if the scores for the individual models are fairly (:onsistent, and the maximums('or(' method

more appropriate whenwe expect larger values of some

in(lividual modelscores to be morereliable indicators.

We have found that the mmxinmmscore method works better in our experiments with generative tIMMmod-

els and BLASTscores, so this approach is used there.

However. the average score lnethod works bett(,r for combiningscores from our discrinfinative models, so it

is used in these experiments.

Experimental Methods
We designed a set of experiments to determine tim ability of SVM-Fisherkernel discriminative models to

ISMB'99 151

recognize renlote protein homologs. The SVM-Fisher kernel methods were compared to BLAST (Altshul et al. 1990; Gish & States 1993) and the generative HMMsbuilt usil,g the SA,iI-T98 methodology (Park et al. 1998: Karphls, Barrett, &Hughey1998; Hughey & Krogh 1995; 1996). The exlmriments measured the recognition rate for melnbers of superfamilies of the SCOPprotein structure cla.ssifieation (Hubbard et al. 1997). Wesimulate the remote homologydetection prol)lem by withholding all members of a SCOP family from the training set and training with tile remaining members of the SCOPsuperfamily. Wethen test sequencesfi'om tht, withheld faintly to see if they are recogIfized by the model built from the training sequences. Since the withheld sequences are known renlote homohtgs, we are abh' to demonstrate tile relatiw, effectiw,ness of the techniques in classifying new sequences as remote melnbers of a superfalnily. In a sense, we are asking, "Could the method discover a newfaintly of a knownsuperfamily'?"
Overview of experiments
The SCOPv('rsion 1.37 PDB90domain database, consisting of protein domains, no two of which have 90%
or moreresidue identiD', w;t~used as the, sere'c(" ()f both training and (,,st. se(luCnc,.~; PDP,90eliminates a large i~umberof ess,,ntially red::,Ma:lt se(tu,ul:'('s fi'Ottt the SCOPdatabase. ['ho u:~e of the domain databa.m ailows for a('('ura.te ([et('rmination ()f a sequence's (qiminating the ambiguity ass()('iated with searching whole-chain protein databases.
Th(, ,generative modelswere ol)l.ained froln a.n oxisling library of SAM-T98 HMMs.The SAM-T98 algorithm, (lescribed more flflly in (Karphts, Barrett, & Hughey 1998), buihls an HMMfor a SCOPclom;dn sequence by searching tit(, non-redundant protein database NRP for a set of potential homoh)gsof the sequ(,n('e and then it.eratively seh,eting positive training sequ(,nces front amongth(,se pote, i~tial homoh)gs refining a model. Theresultiz,g ,uodel is st.or(,d as an alignm(,nt of the domainse(tu('m'(' and final (,fhomohtgs.
All SC()Pfamilies l.ha.t contain at least 5 PDB9(}se(lUences and have at least. 10 PDB90sequences in the other famili(,s in their superfamily wereseh'(:ted for our test, resulting in aa test families fl'om 16 superfumilies (.Iaakk,)la, Di,,khans, & Hmlss](,r 1998})). When ing the recognition of one those families: the training and lest sets were ('onstru('t(,d as folhtws. The t)ositire training exanlples were selected front the remaining families in the superfamily contaii,ing the family in question and the negative training examt)les fl'om outside of the fold that tim family belongs to. The positive

test examplesconsisted of all the PDB90sequen('es in the family. The negative test examples were chosen from outside of the foht containing (.he family and in such a waythat the negative examples in the training set andthose in the test set never camefi'om tile same tiM. Figure 1 shows an exampleof the division.
For each of the 33 test families, all the test exampies. both positive and negative, were score.d, hase.d on a discriminant function obtained from the training examples for that family. Weused various nlethods, described in the following section, to measure howwell the discriminant fimction performed by assessing to what extent it gave hetter scores to the positive test examl)h's than it gave to the negative, test examples. Using this setup, the perforlnance of the SVM-kernel method was compared to the performance of the generative HMMalone, and to BLASTscoring methods.
Multiple models used
After selecting a test family, wemustconstruct a. ale(tel for its superfalnily using available sequences flom the other families in that superfanfily. The SAM-T98 me(lied starts with a. single s(Nuen(:e (the guide (tuence for the domain) and builds a model, ht general, there are too manysequ(mces in the other fanlilies of the superfamily to consider building a mod,..i ,wouud (,a,'n one ,)f thenl. So w~useda subset of PDBg,0, (per-. familys(.(lUet..,::es pres,',m,in a dive( se library of cx,st}ng HMM:,."lt).= SVBl-gisi:cr method wa.q subsequently trained using each of these models in turn. The scores for the test sequences, given each HMMmo(h,l, were comput(,d fi'om Equation (5), and the scores ot)tain(,d based on multiph' models were combined according to Equation (6).
Details on the training and test sets
In each ext)eriment, all PDB90sequences outside the fold of the test family were use(t as either negative training or negative test exantpies. All experiments werer(,ltea.ted with the test/training allo('atiou of negative exanttth~s reversed. This resulted in approximately 2-1(10 negative test sequ(ulces for most test families. The split of negative examples into test and training was done on a foht-by-fold t)a_~is, in su('h a way. that folds wmen,,ver split between test and train. This insured that a negativ(, training example was never sinli]ar tt) a negatiw~ test example, which might give a significant advantage to dis(u'iminative methods. In actual apl)lications, this requirement could b(, relaxed, aim fm'ther improvements might be realized by using discriminative methods.
For positiw' training examples, in a(hlilion t() PDB90sequences in the superfamily of the test family (lint not in the test fantily itself), weused all of the

152 JAAKKOLA

homologs found by each individual SAM-T98 model built for the training PDB90sequences.
BLAST methods
TwoBLASTmethodologies were used for comparison, each using WU-BLASTversion 2.0a16 (WU-BLAST Althschul K." Gish 1996). These are family pairwise search homology methods, as explored in (Grundy 1998). In both methods, the PDB90 database was queried with each positive training sequence, and Evalues were recorded. One method, referred to as BLAST:SCOP-onliyn the results section, used positive training examples as defined by (1) above. Tile other, which we call BLAST.'SCOP+SAM-TP8-homoloys, inchuted tile SAM-T98domain homologs as posMve examples, as in (2) above. In t)oth cases, the scores were combined by the nmximummethod, so the final score of a test. sequence in the PDB90database was taken to be the maximum- log E-value for any of the positive training example query sequences. This score measures the BLAST-detectable similarity of the test sequence to the closest sequence in the set of positive training sequences. In (Grundy 1998), a related combination rule, which instead used the average of the BLAST bit scores: was suggested. \Ve tried a similar average method, taking the average of the - log E-values, which should in theory be nlo,"e accurate th;m averaging the bit ,~ccces. Ho~ev..?r, the maximummethod performed bes:, so we zeport results for that combination methodonly.
Generative HMMscores
Finally, we also report results using the SAM-T98 method as a purely generative model. The null model used here is the reverse sequence model from (Park st el. 1998; Karplus, Barrett. &: Hughey1998). Weused the same data and the same set of models as ill the SVM-Fisher score experiments; we just replaced the SVY.I-Fisher score with the SAM-T98score. However. the scores were combined with the maximmnmethod, since that. performedslightly better in this ease.
In these experiments we also tried two different types of positive training examples. In the first set of experiments: we used only the domain homologs found by the SAM-T98method itself as a training set for each HMM.Thus, we simply used the SAM-T98 models as they were given in the existing library of models. In the second experiment, we retrained each of these models using all of the data in (2) above. That is, using all the SCOPsequences in the superfamily being modeled (but not in the family itself), and all of the domain homologs found by the given SAM-T98 model and by the models built from other guide sequences from this superfimfily (but not in tile family itself). Thusill this

I"
: SCOP~

Fold
SuperFamily
Fami~

¯ .....

,,,~!

" '~'*" "~/ l \'~-) \ Negative

!
~.,~
Negative

Positive Training

x Positive
Test

Figure 1: Separation of the SCOPPDB90database into training and test sequences, shownfor the G p~vteins test family.

latter case, each HMMwas trained on same set of positive training examples used by the SVM-Fisher and BLAST:SCOP+SAMT98-homologs methods. Performancewas somewhatbetter in the latter case at higher rates of false positives (RFP, see below), but was worse at, lower RFP, m,~king the method of less pract.ical value. Tber~ffore, ~'e r(port the rcsult~ of tea. first expcrim,mt here.
Results
Here we provide a comparisonof the results of the best performing approaches for each of the methods. Since the numeric scores produced by each method are not directly comparable, we use the rate of false positives (RIP) achieved h)r ea('h positiw', test sequence as metric for comparing methods (Park et el. 1998). The RFPfor a positive test sequence is defined as the fraction of negative test se(tuences that score as goodor better than the positive sequence.
G-proteins
ttere, as all example, we look at the results for the G proteins family of the nucleotide tviphosphate hydrolases SCOPsuperfamily.
The IIMMsused in the recognition of membersof the G proteins family were taken from two other families in the superfimlily: nucleotide a.nd nucleoside kinases, and nitrogentzse iron protein-like. The positive training examples were the SCOPPDB90sequences fl'om the other families in the superfamily, along with the HMMdomain homologs for the models for the guide sequences.
This experiment tested the ability of tile methods

ISMB'99 153

Sequence
5p21 lguaA let, u lhurA left(3) ldar(2) ltadA(2) lgia(2)

BLAST
0.043 0.179 0.307 0.378 0.431 0.565 0.797 0.867

B-Horn I S-T98 I SVM-F
0.010 0.001 0.000 0.031 0.000 0.000 0.404 0.428 0.038
0.007 0.007 0.000 0.568 0.041 0.051 0.391 0.289 0.019 0.330 0.004 0. O0O 0.421 0.017 0.000

Table 1: Rate of false positives for G proteins family. BLAST = BLAST:SCOP-only, B-Horn = BLAST:SCOP+SAMT-98-homologs. S-T98 = SAMT98, and SVM-F= SVM-Fisher method.

to distinguish the 8 PDB90G proteins from 2439 sequences in other SCOPfokls. The results are given in ta.ble 1. It is seen that the SVM-Fish.erm(:thod scores 5 of the 8 G proteins better than all 2439negative test sequences, and gets a lower rate of false positives than the other inethods on the other 3 sequences, with the exceptkmof left-3.
Wesuminarize the perfornlance of the four methods in recognizing this family by looking at twooverall figUl'OS .If me:it."I'll(, .firs.. is theIII$U:ilIIllI.'.I RFPfin aliy sequenceii the /amily. l.;iJ-[ei t.h.;s n..easure .Jr perfornl:,.nce, we get 0.367 re,." BLAST:SCOP-of1fy1,.568 for BLAST:SC, OP+SAMT98-homologs, 0.i28 fl)r SAMT98, aim I).051 for SVM-Fisherfor the G-proteins fainily.
Since the maxinmm RFP can be dominated by a few outliers, which for some reason may be particularly hard for a method to recogifize, we also consider the median RFPfor the sequences in the fa.mily. To cMculate the median R.FP, we require only that at least half of t.he sequences in the family be recognized, and calculate the maximmntlFP for these sequences only. Of course, for each method, different sequences mayhe inchlded in this "easiest. half' of the family. Under this measure of performance: we get 0.378 for BLAST:SCOP-only(I,.331) for BLAST:SCOP+SAMT98-homologs, 0.007 for SAMT98, and 0.0 for SVM-Fisherfor the G-proteins family.
Overall results
In Table 2 we give the performance of all four mothods on each of the 33 protein families we tested, as measured by the maximuin and median RFP. We also computedthese statistics for the first, amt third quartile. and the relative performance of the four methods was similar (data not shown).
Agraphical comparisonof the overall results for the
154 JAAKKOLA

..... .---~'-............ /
~'~..J'J".-.-...

~.1

~<*
,/
~'-~

-0~''~I~'

i 0 02

/--....................
--2- .....................

BLASTSCOP+BSLAAMST-T'SgC8-OhoPm-Cogl-oll~g-ys¯

SVSMA-MF-isTh9-e-8rN.-. i i .~_.__

0 04

0.96

M ~d~aRnFP

o,3.a

{31

I:igure 2: tlere we compare the ov('rall perforimmce for the fern" methods onthe 33 test fimdlies. For each family we computedthe median RFPfor that t'alnil.v, as shown in Ta.Mo 2. Values for the mrdian RFP are showll t)ll the X-axis. Ol| |he Y-~u,ds weplot the IlUllIblW of SCOPfamilies, out of the 33 families [}lilt wotosto(1. for which the given method achieves t.h~lt median RFP prrformance or better.

33 lest. ti-,.t,'..;ie:; ;n figu..., '2

i].x:u"in L (;:1 Lowmt.dl.|n !If.:; ) i:. %iaon

Further experiments
\¥e did further ext)eriments I.o verify that the SVMFish.er method was not relying too heavily on length and ('ompositional hi,ks in discriminating oneprotein (tomain family frolIl another, as suggested by a.ref(u'ee of this l)apor. Stlch informationwouldnot b('(h,rivable
from the test sequence in the case that the domainto be classified is contained in a larger test proteii~ 5(,-
quen('e. To simulat.v this situation, we aplwxMedrand(,mly generated aminoacids ontothe {'m.ls (,f all the sequei,ces in PDB90,creating a set of padd(,d PDB9() sequences that all hail length 1200(the 1 n'g~st domain in PDB90has length 905). The distribution of these randonl amino acids was deternlined from tim ovrral| alI|[n() acid frequencies in PDB90T. he fla('tion uf padding that occnred at the begimling of t.he s~,qm,nve versllS/it the end of th0 s(,que~lce WHdSetermilwduniformly at randomas well.
Wereran the experinients reI)()rt(,d .above uit},
padded PDB90data set. In cases where homoh~gswere us(,d, thes(' wereraiMomlty)a.(hhxl a.~ w(Jl. Apartfl'OItt a slight reduction iu the atllottnt of inq)rovelnent over t.he other methods shown by SVM-Fisher, tim results wereonaveragequalitiatively siinilatr to those obl.aill.ed without padding. Details can 1)o found in (Jaakkola,

# I Family
1 Phycocyanins 2 Long-chain cytokines 3 Short-chain cytokines 4 Interferons/interleukin-10 5 Parvalbumin 6 Calmodulin-like 7 Inmmnoglobulin V dora 8 Immunoglobulin C1 dora 9 Immunoglobulin C2 dora 10 Immunoglobulin I dom 11 Immunoglobulin E dom 12 Plastocyanin/azurin-like 13 Multidomain cupredoxins 14 Plant virus proteins 15 Animal virus proteins 16 Legumelectins i7' Pr,;karyo~.ic plote-~¢ s t..., -~ , Evkaryotic pr(.tea,c,-'
R etr'wiral p:-otea.,e Retinol binding
21 alpha-Amylases, N-term 22 beta-glycanases 23 type II chitinase 24 Alcohol/glucose dehydro 25 Rossmann-fold C-term 26 Glyceraldehyde-3-phosphat 27 Formate/glycerate 28 Lactate&malat.e dehydro 29 G proteins 3O Thioltransferase
31 Glutathione S-transfer 32 Fungal lipases 33 Transferrin

Maximum RFP

Median RFP

BLT I BLH I ST98 I SVM BLTI BLH I ST98 I SVM

0.882 0.743 0.950 0.619 0.391 0.342 0.450 0.364

0.847 0.526 0.994 0.123 0.721 0.397 0.446 0.035

0.686 0.658 0.513 0.023 0.407 0.114 0.109 0.002

0.613 0.799 0.765 0.119 0.324 0.440 0.289 0.004

0.098 0.000 0.000 0.000 0.000 0.000 0.000 0.000

0.433 0.002 0.000 0.000 0.023 0.000 0.000 0.000

0.720 0.115 0.974 0.016 0.135 0.000 0.000 0.000

0.624 0.000 0.000 0.063 0.033 0.000 0.000 0.000

0.263 0.124 0.136 0.019 0.119 0.006 0.000 0.000

0.157 0.190 0.251 0.495 0.007 0.004 0.000 0.000 0.792 0.797 0.899 0.683 0.168 0.329 0.178 0.073

0.869 0.895 0.730 0.772 0.016 0.049 0.039 0.013

0.775 0.853 0.233 0.360 0.342 0.116 0.003 0.002

0.975 0.940 0.782 0.410 0.641 0.391 0.088 0.133

~L_0.962 0 997 0.941 .513 0.750 0.630 0.20.1 0.066

0.895
ii -gNT0~;'?5. -ggv4U 0.009

0.643 .55.2_0._278 0q.(.'030,m_o.00CA0 ,C0,'))..0)8000

0.298 0.278 0.083 9.6 )2 (~,I,(10 0 t;00
0.030~7oi,:67':.69o

--0.5-0~ 0.195 - 0 lb3 C.18i' o.2~8 0.108 0.('.i 2 0.0¯t,,,,3

0.827 0.843, 0.940 ~i.~Z!- 0.475 0.293 0.165 0.05:

0.935 0.953 0.737 0.037 0.630 0.851 0.007 0.000

0.974 0.939 0.370 0.079 0.517 0.338 0.009 0.008

0.724 0.905 0.945 0.263 0.350 0.426 0.110 0.031

0.610 0.203 0.050 0.025 0.041 0.004 0.019 0.008

0.713 0.883 0.593 0.107 0.121 0.299 0.015 0.005

e 0.791 0.537 0.062 0.004 0.315 0.102 0.009 0.002

0.702 0.295 0.302 0.074 0.022 0.049 0.001 0.002

0.947 0.851 0.132 0.297 0.530 0.330 0.024 0.002

0.867 0.568 0.428 0.051 0.378 0.330 0.007 0.000

0.205 0.072 0.986 0.029 0.000 0.000 0.000 0.000

0.566 0.597 0.825 0.590 0.311 0.201 0.273 0.238 0.957 0.591 0.089 0.007 0.044 0.053 0.000 0.00(}

0.940 0.859 0.035 0.072 0.875 0.433 0.007 0.026

Table 2: Rate of false positives h)r all 33 families. BLT BLAST:SCOP-only, BLH = BLAST:~COP+SAMT-98holnologs, ST98 = SAMT-98: and SVM= SVM-Fisher method.

ISMB '99 155

Diekhans,&: Haussler1998b).Thedatasetsfor allthe experinmnts are available from our web site (Jaakkola, Diekhans, & Haussler 1998a).

Discussion

We have developed a new approach to the recognition

of remote protein homologies that uses a discriminative

method built on top of a generative model such as an

HMM.Our experiments show that this method: which

we call the SVM-Fisher method, sigrtificantly improves on previous nletho(ts for th(, classificatiou of protein

domains based on remote homologies.

All the methods considered in this paper combine

nmltiple scores for each (tuery seqIlell(:('. The multi-

pie scores arise ritht,r fl'om several models that are

available for a particular superfamily (IIMM and SVM-

Fisher) or because each known sequence can t-m scored

against the query soqll(!ilCt,

with BLAST(Grundy

1998). The simph, (:olnbination rules emph.?yed in this

paper for each method are not necessarily optimal and

further w,~rk needs to be done in this :'egard. it. should

be noted that while OUl' methods for cornbining BLAST

and [I.M.M scores are rssentially the same as those ex-

pit)red iu {Grundy 1998). the :'olative performance

the simple general iv(, It.MM qmt}lod ve!su~' the faln-
ily !m.irwigo sea~('h htnm~!ogy metl~ods u.'si:ig BLAST
:¯S t,wO:'~,.,(l¯ Jr. our,,2"|)(,.'ilrle~.~.s: t:el'O t.hr, ~I l..l,'.. 1x_,,)I,.:.-
ft;l'll.S [wtt.u'. This is :,,,t..~lll[)liSJllg, sirwc t.::r L-.s consisted. <;f finding vrry r,.,IiK)t.:. ~ homologies. (o" tile

iilost part, whereas the tests in (Grundy 1998) were for

finding sequelWOS that were mostly in tim same family

as the training sequences. Furtherntore, the families

in (Grmldy 1998} werr llOt defined by structure using

S('OP, but I'ather by se(lllell(:(! similarity itself. There ~w.e,'e also diffc:ences in the construction of the HMMs

Our 0xperimental :esults show, however, that it may be wise t.() build more powerfl:l, discriminativcly trained

protei:I classification methods on top of HMMmeth-

ods, rather than replace HMMnlethods with combina-

tions of BLASTseo:'es.

The discriminative SV.M-Fish(,r method relies on the

I.n'esenc~' of multit)h' training examples fl'om the superfamily of interest., and works best when these train-

illg seqtlent'es are not th(' satlle as those used to (,s-

t.imate the tmrameters ()f the mld(,rlying HMM.This

t)resvnts us with an allocation tnobh,m, i.e., which se-

(luencrs should be used fl..,r (,stinmting the parameters of the H_M.Mand which ones left for the discriminative

1 ()ur tests used the SA 3I- T98 met hod for constructing
HMMsw, hereas tile tests in (Grundy 1998) used an earlier version of the H.MMEIs1ysten, (Eddy ; 1997), with tile default parameters, which does not perform ~m well (Karchin & Hughey1998); more recent and carefully tuned versions of HMMEI1w. ould likely have performed better.

156 JAAKKOLA

method. This issue becomes especially important in cases where there are relatively few kuown sequences and homologs in the superfamily of interest. A possible solution to this problem and one that we have already suceessflflly experimented with, concerns the use of generic protein models rather than those tuned
to the particular family of interest. By generic models we mean HMMcsonstructed ell the ba~sis of statistical properties of short amino acid sequences that map on
to structm'ally conserved regions in proteins (Bystroff & Baker 1997). Since the role of the HMMin ore' discriminative fi)rmalisln is 1;o provide featu,'es ,'elevant
for identifying structural ,elationships. the use of such generic models seems quite natural.
A generic model could also be trained as a single multi-way p,'otein domai,1 classifier, replacing the set of two-way classifiers we built for the experinlents reported in this paper. It re,nains to be seen if this will be an effe(:t.ive way to construct a multi-way protein domain classifier, as compared to using some combination of the existing two-way classifiers. The lower ,'ates of false positives achieved by our currem two-way classifie,'s make us hopefltl that an effective muhi-way classifier ('at: be 1)uilt using :~(m:e version of the SVM-
Fisher method. hi the fl)ture, it. will also L,.. iraporta,,t i.,, ,'x~,,,':d
, h(' In~}.t,od ,.o id( nl.lt~ r, mlti!:.lc d(,m,~,ins:,it !filn'ug,. prol.(qns,.,qt'cn,"es. ~'~:._,!ce,o~Jl"c'v[)elin:ollts \,,}d~ ac;ifi-.
, ially paddr..d.~,(luence:, ,.ve:e ~;l.'o,ss;.,tl. we.,tr,. ('onli-. dent tha.t these methods ('an t)(, adapted to l.h~ identifi('ation of multiple de, mains. However this work remains to be done. Finally, while this discrintinative framework is specifically devel()ped for identifying protein homoh,gios, it naturally extends to other problems in biosequence analysis, such as the identification and classification of promoters, split(' sites, and other features in genomic DNA.

Acknowledgments

T()mmi Jaakkola acknowledges support from

l)OE/Sloan Foundat, iotl postdoct()ral grant 97-2-6-

CMB. David Haussler and Mark Diekhans acknowledge tile support of DOEgrant DE-FG03-95EI162112

and NSF grant IRI-9123692.

We thank ~ichard

Hughey and Kevin Karl)his for suggestions and for

making their software ax;dlable.

References
Althschul, S., and Gish. W. 1996. Local alignment stalistics. Methods EnzymoL 266:460. 480.
Altschul, S.; .Madden. T.; Sehaffer, A.: Zhang, J.; Zhai:g. Z.; Miller. W.: and Lipman, D. 1997. Gapped

BLASTand PSI-BLAST:A new generatioll of protein datal)ase sem'ch programs. NAR25:3899--3402.
Altshul, S. F.; Gish: W.; Miller. W.; W., M. E.; and J., L. D. 1990. Basic local alignment search tool. JMB 215:403-410.
Baldi, P.; Chanvin, Y.; Hunhapillar: T.; and McClm'e, M. 1994. Hidden Markovmodels of biological primary sequence information. PNAS 91:1059-1063.
Barrett, C.; Hughey, R.; and Karplus, K. 1997. Scoring hidden Markov inodels. CA BIOS 13(2):191 199.
Brenner, S. E. 1996. Molecular propinquity: evolution, ary andstructural relationships of proteins. Ph.D. Dissertation. University of Cambridge. Cambridge. England.
Bystroff, C., and Baker, D. I997. Blind predi('tioils of local protein structure in casp2 targets using the i-sites library. Proteins: Stru.cture, Function and Genetic.s'. Suppl. 1:167 171.
Dubchak, I.: Muchnik, I.; Holbrook, S.; and Kim, S. 1995. Prediction of protein folding class using global description of amino acid sequence, pnas 92:8700-8704.
Dub('hak,1" Mu,hnlk!... andl'2int. ,c-.-l-I.. 1997.Pr:)t(,ir fol(:ing,:~ass l)rc, dic:.~)~for stop: .~pgro:~,('nbast (,n global d.(.scritJtors, h, t'roc;:edings, 5th I'atern,,tional Conference on lnteiligen't Systems/or Molecular Biology, 104 108.
Durbin, R.; Eddy, S.; Krogh, A.; and .\Iitchison. G. 1998. Biological Sequ.ence Analysis: Probabilistie Models o/Proteins and Nucleic Acids. Cambridge University Press.
Eddy. S. HMMERWWWsite. http ://hmmer. wustl, edu/.
Eddy, S.; Mitchison. G.; and Durbin, R. 1995. Maximum discrimiimtion hidden Markov models of scquen('e consensus. J. Comput. Biol. 2:9-23.
Eddy, S. 1995. Multiple aligmnent using tfidden Markovmodels. In Railings, C., et al., eds., ISMB-95, 114-120. Menlo Park, CA: AAAI/MITPress.
Eddy, S. 1997. tlidden markov models and large-scale genomeanalysis. Transactions of the Ame.rican Crystallographic Association. From a talk on HMMEaRnd Pfam given at the 1997 ACAannual meeting in St. Louis.
Gish, W., and States, D. J. 1993. Identification of protein coding regions by database similarity search. Natu.re Genetics 3.

Gribskov, M.; McLachlan, A. D.; and Eisenberg, D. 1987. Profile analysis: Detection of distantly related proteins. PNAS84:4355-4358.
Grundy, W. N. 1998. Family-based homology detection via pairwise sequence comparison. In Int. Conf. Computational Molecular Biology (RECOMB98). New York: ACMPress.
Henikoff. S., and Henikoff, J. G. 1994. Position-based sequence weights. JMB243(4):574-578.
Hubbard, T.; Murzin, A.; Brenner, S.; and Chothia, C. 1997. scoP: a structural classification of proteins database. NAR25(1):236-9.
Hughey, R., and Krogh, A. 1995. SAM:Sequence alignment and modeling software system. Technical Report UCSC-CRL-95-7U. niversity of California, Santa Cruz, Computer Engineering, UCSanta Cruz, CA 95064.
Hughey, R., anti Krogh, A. 1996. Hidden Markov models for sequence analysis: Extension and anal)'sis of the basic method. CABIOS 12(2):95 107. Information on obtaining SAMis available at http://www. cse.ucsc.edu/research/compbio/ sam.html.
..Jaakkola. 1".. a.nd Havssb~rE, '. 1998.Exp!,,);'_int~, gen. erative .t~odehii: .'iis,'ri~ninztive: .'.las:,ifie:s. !n 4dv.inc.;s in i,.~eural lnfoTmatior,.ProcessinSgy~ter.s i :' San Mateo, CA: Morgan Kauffmann Publishers. to appear.
.laakkola, T.; Diekhans, M.; and Haussler, D. 1998a. Data set for a discriminative frameworkfor" detecting remote protein homologies. http ://www. cse. ucsc. edu/research/compb±o/ discriminaitve/fisher-scop-dattaa,r.gz.
.Iaakkola, T.: Diekhans, M.; and Haussler, D. 1998b. A discriminative framework for detecting remote protein hoinologics. Unpublished, availablefrom http://www.cse.ucsc,edu/research/ compbio/researchht,ml.
Karchin, R.. and Hughey, R. 1998. Weighting hidden Markov models for maxinmmdiscrimination. Bioinformatics to appear.
Karplus, K.; Barrett, C.; and Hughey, R. 1998. Hidden markov models for detecting remote protein homologies. Bioin/ormatics 14(10):846-856.
Karplus, K.; KimmenSjSlander; Barrett, C.; Cline, M.; Haussler. D.; Hughey, R.; Holm, L.; and Sander, C. 1997. Predicting protein structure using hidden Markov models. Prvteins: Structure, Function, and Genetics Suppl. 1:134-139.
ISMB'99 157

Krogh,A.; Brown,M.; Y, lian, I. S.; Sjblander, K.; and Haussler, D. 1994. Hidden Markov models in computational biology: Applications to protein nlodeling. .IMB 235:1501 1531. Linial, M.; Linial. N.; Tishby, N.: and Yona, G. 1997. Global self-organization of 'all knownprotein sequences reveals inherent biological signatures, jmb 268(2):539 556. .Mamitsu'ka, H. 1996. A learning method of hidden markov models for sequence discrimination..lou~'rud of Computational Biology 3(3):361-373. Neuwahl, A.; Liu, J.; Lipman. D.: and Lawrence, C.E. 1997. Extracting protein alignment models from the sequence database. N4R25:1665-1677. Park, .I.; Karl)his, K.; Barrett, C.; Hughey, R.; Haussler, D.: Hubbard, T.; and Chothia, C. 1998. Sequence comparisons using multiph, sequellCCS dete(t twice as many remote homologues as pairwise methods. JMB 284(4):1201 1210. Paper available at http://www.mrc-lmb, cam.ac.uk/genomes/ j ong/asses s_paper/asses s_paperNov, html. Pearson, W., and Lil)man. D. 1988. hnprov,,d tools for biolc,g;cal sequ(~nce('()Inl)arison. PNAS85:244-t 241~.. .r~abm(,~L. ,.']., and.luan,.;;, B. II. 1986.k:l il.trod,u. tlon to }~l(l'.l(',i Mark,)vm,,d~Is. [EE.F,4SSI~ ,'ltagar-~le' 3(1):.1--16. Taylor, W. 1986. ldentificat.ion of protvin se(tuen('e homologyby consensus temt)lat(, aligninent. JMB 188:233-258. WU-BLAST WWWarchives. http ://blast. wust 1. edu/.
158 JAAKKOLA

